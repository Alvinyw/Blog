(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b9b9aa9a"],{"1a76":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.ifShowDialog,width:"560px",top:"5vh","custom-class":"roleManage_resourceEditDialog"},on:{"update:visible":function(t){e.ifShowDialog=t}}},[a("div",{staticStyle:{"text-align":"center","font-size":"20px"},attrs:{slot:"title"},slot:"title"},[a("strong",[e._v(e._s(e.currentOperatorInfo.name))]),e._v("\n    "+e._s(e.$t("m.accountCenter.权限配置"))+"\n  ")]),a("div",{attrs:{slot:"default",id:"roleResourceTree"},slot:"default"},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.ifLoadingRoleData,expression:"ifLoadingRoleData"}],ref:"resourceTree",attrs:{data:e.treeData,"check-on-click-node":"","node-key":"id",props:e.defaultProps,"highlight-current":"","show-checkbox":"","check-strictly":"",accordion:"","default-expand-all":!1},on:{"update:data":function(t){e.treeData=t},check:e.handleCheck},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(e.$t("m.resource."+i.uri)))])])}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.ifShowDialog=!1}}},[e._v(e._s(e.$t("m.取消")))]),a("el-button",{on:{click:e.resetForm}},[e._v(e._s(e.$t("m.重置")))]),a("el-button",{attrs:{loading:e.ifUpdating,type:"primary",disabled:e.isSubmitDisable},on:{click:e.editRoleResource}},[e._v(e._s(e.$t("m.更新")))])],1)])},s=[],r=(a("ac6a"),a("4360")),o=a("0003"),n={name:"PermissionModal",props:{showPermissionConfigDialog:{type:Boolean,default:!1},currentOperatorInfo:{type:Object,default:function(){return{}}}},data:function(){return{ifLoadingRoleData:!1,isSubmitDisable:!0,ifUpdating:!1,defaultProps:{children:"children",label:"name"},defaultAllResourceData:[],defaultCheckedKeys:[],currentCheckedKeys:[],allResourceData:[],treeData:[]}},computed:{ifShowDialog:{get:function(){return this.showPermissionConfigDialog},set:function(e){this.$emit("update:showPermissionConfigDialog",e)}}},watch:{ifShowDialog:function(e,t){var a=this;e?(this.ifLoadingRoleData=!0,this.currentCheckedKeys=[],this.$api.resource.getAllOpenResource(this.currentOperatorInfo.id).then(function(e){a.defaultAllResourceData=e.data,a.allResourceData=JSON.parse(JSON.stringify(a.defaultAllResourceData)),a.treeData=Object(o["b"])(a.allResourceData),a.ifLoadingRoleData=!1})):(this.defaultCheckedKeys=[],this.currentCheckedKeys=[],this.allResourceData=[],this.treeData=[])},allResourceData:{handler:function(e,t){var a=this;this.currentCheckedKeys=[],e.forEach(function(e){e.isSelected&&a.currentCheckedKeys.push(e.id)}),0===t.length&&(this.defaultCheckedKeys=this.currentCheckedKeys),this.$refs.resourceTree.setCheckedKeys(this.currentCheckedKeys),this.isSubmitDisable=this.$lib.isObjEqual(e,this.defaultAllResourceData)},deep:!0}},methods:{handleCheck:function(e,t){var a=this;this.allResourceData.forEach(function(t){t.id===e.id&&(t.isSelected=!t.isSelected,t.isSelected&&a.reInitParents(t),a.reInitChilds(t))})},reInitParents:function(e){var t=this;this.allResourceData.forEach(function(a){a.id===e.parentId&&(a.isSelected=!0,t.reInitParents(a))})},reInitChilds:function(e){var t=this;this.allResourceData.forEach(function(a){a.parentId===e.id&&(a.isSelected=e.isSelected,t.reInitChilds(a))})},editRoleResource:function(){var e=this;this.ifUpdating=!0,this.$api.user.editUserResource({userId:this.currentOperatorInfo.id,resourceIds:this.currentCheckedKeys,createById:r["a"].getters.userId}).then(function(t){e.ifUpdating=!1,e.ifShowDialog=!1}).catch(function(t){return e.ifShowDialog=!1,e.$message.error(t.message),!1})},resetForm:function(){this.allResourceData=JSON.parse(JSON.stringify(this.defaultAllResourceData))}}},c=n,l=(a("38e6"),a("2877")),u=Object(l["a"])(c,i,s,!1,null,null,null);t["default"]=u.exports},"38e6":function(e,t,a){"use strict";var i=a("b045"),s=a.n(i);s.a},b045:function(e,t,a){}}]);