(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47cac35c"],{4747:function(e,t,a){"use strict";var r=a("515e"),o=a.n(r);o.a},"515e":function(e,t,a){},"597b":function(e,t,a){"use strict";var r=a("e668"),o=a.n(r);o.a},bbf2:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"m"},[a("el-form",{ref:"queryCondition",staticClass:"queryCondition section",attrs:{model:e.queryCondition,rules:e.orderQueryRules,"label-width":"100px"}},[a("el-row",[a("ProductTypeCodeSelect",{attrs:{type:e.queryCondition.productType,code:e.queryCondition.productCode},on:{"update:type":function(t){return e.$set(e.queryCondition,"productType",t)},"update:code":function(t){return e.$set(e.queryCondition,"productCode",t)}}}),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"所属商户",prop:"merchantId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.queryCondition.merchantId,callback:function(t){e.$set(e.queryCondition,"merchantId",t)},expression:"queryCondition.merchantId"}},e._l(e.merchantList,function(e){return a("el-option",{key:e.id,attrs:{label:e.shortName,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"订单类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.orderType,callback:function(t){e.orderType=t},expression:"orderType"}},[a("el-option",{attrs:{label:"申请订单",value:"1"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"订单状态",prop:"state"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.queryCondition.state,callback:function(t){e.$set(e.queryCondition,"state",t)},expression:"queryCondition.state"}},[a("el-option",{attrs:{label:"已提交",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"初审通过",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"初审拒绝",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"复审通过",value:"4"}}),e._v(" "),a("el-option",{attrs:{label:"复审拒绝",value:"5"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户姓名",prop:"customerName"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:"",maxlength:"20","show-word-limit":""},model:{value:e.queryCondition.customerName,callback:function(t){e.$set(e.queryCondition,"customerName",t)},expression:"queryCondition.customerName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户身份证号",prop:"idNumber"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:"",maxlength:"20","show-word-limit":""},model:{value:e.queryCondition.idNumber,callback:function(t){e.$set(e.queryCondition,"idNumber",t)},expression:"queryCondition.idNumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户手机号",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:"",maxlength:"11","show-word-limit":""},model:{value:e.queryCondition.phone,callback:function(t){e.$set(e.queryCondition,"phone",t)},expression:"queryCondition.phone"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"申请时间",prop:"beginTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"~","value-format":"yyyy-MM-dd","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.orderCreatedTime,callback:function(t){e.orderCreatedTime=t},expression:"orderCreatedTime"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"queryBtn",staticStyle:{"text-align":"right"},attrs:{size:"large"}},[a("el-button",{on:{click:function(t){return e.resetForm("queryCondition")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{loading:e.isQuering,type:"primary"},on:{click:function(t){return e.searchOrderInfo("queryCondition")}}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"orderInfoTable section mb0"},[e.$api.buttonAuth("order/export")?a("div",{staticStyle:{"text-align":"right",margin:"-15px 0 15px"}},[a("el-button",{staticClass:"export-button",attrs:{loading:e.exportLoading,disabled:e.exportLoading||e.orderInfo.length<1},on:{click:e.onExport}},[e._v("导出")])],1):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingOrderInfo,expression:"loadingOrderInfo"}],staticStyle:{width:"100%"},attrs:{data:e.orderInfo,"header-cell-style":{background:"#f5f5f5",color:"#333"},border:""}},[a("el-table-column",{attrs:{prop:"type",label:"订单类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("申请订单"))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"注册手机号","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"companyName",label:"企业名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.companyName}},[e._v(e._s(t.row.companyName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"companyCode",label:"统一社会信用代码","min-width":"145px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.companyCode}},[e._v(e._s(t.row.companyCode))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"企业所在地"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.address}},[e._v(e._s(t.row.address))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"legalName",label:"法人名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.legalName}},[e._v(e._s(t.row.legalName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"legalMobile",label:"法人手机号","min-width":"100px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"legalIdNumber",label:"法人身份证号码","min-width":"145px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.legalIdNumber}},[e._v(e._s(t.row.legalIdNumber))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"productName",label:"所属产品"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.productName}},[e._v(e._s(t.row.productName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"childProductName",label:"所属子产品"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.childProductName}},[e._v(e._s(t.row.childProductName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:"订单状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{innerHTML:e._s(e.getOrderState(t.row.state))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"applyDatetime",label:"申请时间",width:"120px"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.$api.buttonAuth("order/firstAudit")&&1===t.row.state,expression:"$api.buttonAuth('order/firstAudit') && scope.row.state === 1"}],attrs:{type:"text"},on:{click:function(a){return e.handleOrderAudit(t.row)}}},[e._v("审核")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.$api.buttonAuth("order/lastAudit")&&(2===t.row.state||3===t.row.state),expression:"$api.buttonAuth('order/lastAudit') && (scope.row.state === 2 || scope.row.state === 3)"}],attrs:{type:"text"},on:{click:function(a){return e.handleOrderAudit(t.row)}}},[e._v("复审")])]}}])})],1),e._v(" "),a("DataPagination",{attrs:{"pagination-data":e.paginationData},on:{"update:paginationData":function(t){e.paginationData=t},"update:pagination-data":function(t){e.paginationData=t},resetData:e.getOrderList}})],1),e._v(" "),a("el-dialog",{attrs:{title:"审核结果",visible:e.ifShowAuditDialog,width:"30%","custom-class":"auditDialog"},on:{"update:visible":function(t){e.ifShowAuditDialog=t},closed:e.handleCloseAuditDialog}},[a("el-form",{ref:"passForm",attrs:{model:e.auditForm,rules:e.auditFormRules,"label-width":"85px"}},[a("el-form-item",{attrs:{prop:"state",label:e.isFirstAudit?"初审状态":"复审状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.auditForm.state,callback:function(t){e.$set(e.auditForm,"state",t)},expression:"auditForm.state"}},[a("el-option",{directives:[{name:"show",rawName:"v-show",value:e.isFirstAudit,expression:"isFirstAudit"}],attrs:{label:"初审通过",value:"2"}}),e._v(" "),a("el-option",{directives:[{name:"show",rawName:"v-show",value:e.isFirstAudit,expression:"isFirstAudit"}],attrs:{label:"初审拒绝",value:"3"}}),e._v(" "),a("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.isFirstAudit,expression:"!isFirstAudit"}],attrs:{label:"复审通过",value:"4"}}),e._v(" "),a("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.isFirstAudit,expression:"!isFirstAudit"}],attrs:{label:"复审拒绝",value:"5"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"mb0",attrs:{prop:"approveRemark",label:"备注"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入"},model:{value:e.auditForm.approveRemark,callback:function(t){e.$set(e.auditForm,"approveRemark",t)},expression:"auditForm.approveRemark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCloseAuditDialog}},[e._v("重 置")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.isSubmitDisable,loading:e.isAuditting},on:{click:e.handleAuditSubmit}},[e._v("提 交")])],1)],1)],1)},o=[],n=(a("ac6a"),a("96cf"),a("3b8d")),i=(a("c5f6"),a("db72")),s=a("2f62"),l={name:"OrderIndex",data:function(){return{paginationData:{pageIndex:1,pageSize:10,dataCount:0},loadingOrderInfo:!1,orderType:"",queryCondition:{customerName:"",idNumber:"",phone:"",state:"",beginTime:"",endTime:"",merchantId:"",productType:"",productCode:""},orderQueryRules:{},isQuering:!1,isAuditting:!1,merchantList:[],orderInfo:[],currentOrderData:{},ifShowAuditDialog:!1,isFirstAudit:!0,auditForm:{state:"",approveRemark:""},auditFormRules:{state:[{required:!0,message:"请选择审核状态"}]},exportLoading:!1}},computed:Object(i["a"])({},Object(s["b"])(["userId"]),{isSubmitDisable:function(){return""===this.auditForm.state},orderCreatedTime:{get:function(){return[this.queryCondition.beginTime,this.queryCondition.endTime]},set:function(e){this.queryCondition.beginTime=e?e[0]:"",this.queryCondition.endTime=e?e[1]:""}}}),mounted:function(){var e=this.$session.getQueryConditions();e&&(this.queryCondition=e),this.getMerchantList(),this.getOrderList()},methods:{getOrderStateName:function(e){var t;switch(Number(e)){case 1:t="已提交";break;case 2:t="初审通过";break;case 3:t="初审拒绝";break;case 4:t="复审通过";break;case 5:t="复审拒绝";break;default:break}return t},getOrderState:function(e){var t;switch(Number(e)){case 1:t="<span class='tag tag_1'></span>";break;case 2:t="<span class='tag tag_3'></span>";break;case 3:t="<span class='tag tag_4'></span>";break;case 4:t="<span class='tag tag_3'></span>";break;case 5:t="<span class='tag tag_4'></span>";break;default:break}return t+this.getOrderStateName(e)},getMerchantList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$api.merchant.getAllMerchant();case 3:t=e.sent,200===Number(t["code"])?this.merchantList=t["data"]||[]:this.$message.error(t["message"]),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.$message.error(e.t0["message"]);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));function t(){return e.apply(this,arguments)}return t}(),setOrderInfo:function(e){this.orderInfo=e.data?e.data:[],this.paginationData.dataCount=e.count,this.loadingOrderInfo=!1},getOrderList:function(){var e=this;return this.loadingOrderInfo=!0,this.$api.buttonAuth("order/cleartext")?this.$api.order.getCleartextOrderPageList(Object(i["a"])({},this.paginationData,{conditions:this.queryCondition})).then(function(t){e.setOrderInfo(t)}):this.$api.order.getOrderPageList(Object(i["a"])({},this.paginationData,{conditions:this.queryCondition})).then(function(t){e.setOrderInfo(t)})},searchOrderInfo:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=8;break}return t.isQuering=!0,e.next=4,t.getOrderList();case 4:t.isQuering=!1,t.$session.setQueryConditions(t.queryCondition),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields(),this.$refs[e].clearValidate(),this.queryCondition.productType="",this.queryCondition.productCode=""},handleOrderAudit:function(e){this.ifShowAuditDialog=!0,this.currentOrderData=e,this.isFirstAudit=1===Number(e.state)},handleCloseAuditDialog:function(){this.$refs["passForm"].resetFields()},handleAuditSubmit:function(){var e=this;this.$refs["passForm"].validate(function(t){if(!t)return!1;e.isAuditting=!0,e.$api.order.orderAudit(Object(i["a"])({id:e.currentOrderData.id,approveId:e.userId},e.auditForm)).then(function(t){e.ifShowAuditDialog=!1,e.isAuditting=!1,e.getOrderList()}).catch(function(t){e.$message.error(t.message),e.isAuditting=!1})})},onExport:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.exportLoading=!0,t=["注册手机号","所属商户","所属子商户","企业名称","统一社会信用代码","企业所在地","法人姓名","法人手机号","法人身份证","银行产品","订单状态","备注","申请时间"],r=["phone","merchantName","childMerchantName","companyName","companyCode","address","legalName","legalMobile","legalIdNumber","childProductName","state","approveRemark","applyDatetime"],this.$api.order.getOrderList(this.queryCondition).then(function(e){var n=JSON.parse(JSON.stringify(e["data"]?e["data"]:[]));n.forEach(function(e){e.state=o.getOrderStateName(e.state)}),Promise.all([a.e("chunk-016e524e"),a.e("chunk-58293907")]).then(a.bind(null,"4bf8d")).then(function(e){e.export_json_to_excel({header:t,data:o.formatJson(r,n),filename:"exportExcel",autoWidth:!0,bookType:"xlsx"}),o.exportLoading=!1})}).catch(function(e){o.exportLoading=!1,o.$message.error(e.message)});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})}}},u=l,d=(a("4747"),a("597b"),a("2877")),c=Object(d["a"])(u,r,o,!1,null,"28535e13",null);t["default"]=c.exports},e668:function(e,t,a){}}]);