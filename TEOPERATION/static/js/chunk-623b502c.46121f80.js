(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-623b502c","chunk-3b476a49","chunk-3b476a49","chunk-a9ae809c","chunk-3b476a49","chunk-3b476a49"],{"02a7":function(t,e,r){"use strict";var n=r("f833"),a=r.n(n);a.a},"0390":function(t,e,r){"use strict";var n=r("02f4")(!0);t.exports=function(t,e,r){return e+(r?n(t,e).length:1)}},"10d5":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"m"},[r("el-form",{ref:"queryCondition",staticClass:"queryCondition section",attrs:{model:t.queryCondition,rules:t.queryRules,"label-width":"100px"}},[r("el-row",[r("ProductTypeCodeSelect",{attrs:{type:t.queryCondition.productType,code:t.queryCondition.productCode,"type-label-width":"72px"},on:{"update:type":function(e){return t.$set(t.queryCondition,"productType",e)},"update:code":function(e){return t.$set(t.queryCondition,"productCode",e)}}})],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:4}},[r("el-form-item",{staticClass:"queryBtn",attrs:{size:"large","label-width":"0"}},[t.$api.buttonAuth("ad/add")?r("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]):t._e()],1)],1),t._v(" "),r("el-col",{attrs:{span:20}},[r("el-form-item",{staticClass:"queryBtn",staticStyle:{"text-align":"right"},attrs:{size:"large"}},[r("el-button",{on:{click:function(e){return t.resetForm("queryCondition")}}},[t._v("重置")]),t._v(" "),r("el-button",{attrs:{loading:t.isSearching,type:"primary"},on:{click:function(e){return t.searchProductInfo("queryCondition")}}},[t._v("查询")])],1)],1)],1)],1),t._v(" "),r("div",{staticClass:"dataListTable section"},[t.$api.buttonAuth("ad/enable")||t.$api.buttonAuth("ad/disable")?r("EnableBtnGrp",{attrs:{"show-enable-btn":t.$api.buttonAuth("ad/enable"),"show-disable-btn":t.$api.buttonAuth("ad/disable"),count:t.multipleSelection.length},on:{onEnable:function(e){return t.handleBatch(1)},onDisable:function(e){return t.handleBatch(0)}}}):t._e(),t._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingDataList,expression:"loadingDataList"}],staticStyle:{width:"100%"},attrs:{data:t.dataList,"header-cell-style":{background:"#f5f5f5",color:"#333"},"cell-style":{padding:"10px 0"}},on:{"selection-change":t.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection","class-name":"selectionCol",width:"40"}}),t._v(" "),r("el-table-column",{attrs:{label:"产品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{attrs:{title:e.row.productName}},[t._v(t._s(e.row.productName))])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"广告名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{attrs:{title:e.row.name}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"sequence",label:"排序"}}),t._v(" "),r("el-table-column",{attrs:{prop:"enabled",label:"使用状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{domProps:{innerHTML:t._s(t.$app.getEnabledState(e.row.enabled))}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"createDatetime",label:"创建时间"}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.$api.buttonAuth("ad/edit")?r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleEdit(e.row)}}},[t._v("编辑")]):t._e()]}}])})],1),t._v(" "),r("DataPagination",{attrs:{"pagination-data":t.paginationData},on:{"update:paginationData":function(e){t.paginationData=e},"update:pagination-data":function(e){t.paginationData=e},resetData:t.getDataList}}),t._v(" "),r("AddOrEdit",{attrs:{"if-show-model":t.ifShowModel,"is-add":t.isAdd,"current-form-data":t.currentAdData},on:{"update:ifShowModel":function(e){t.ifShowModel=e},"update:if-show-model":function(e){t.ifShowModel=e},refreshData:t.getDataList}})],1)],1)},a=[],i=(r("ac6a"),r("db72")),o=r("2f62"),s=r("c527"),u={name:"PublicAdIndex",components:{AddOrEdit:s["default"]},data:function(){return{paginationData:{pageIndex:1,pageSize:10,dataCount:0},loadingDataList:!1,queryCondition:{productType:"",productCode:""},queryRules:{},currentAdData:{},ifShowModel:!1,isAdd:!0,dataList:[],isSearching:!1,multipleSelection:[]}},computed:Object(i["a"])({},Object(o["b"])(["userId"])),mounted:function(){var t=this.$session.getQueryConditions();t&&(this.queryCondition=t),this.getDataList()},methods:{getDataList:function(){var t=this;return this.loadingDataList=!0,this.$api.product.getBannerPageList(Object(i["a"])({},this.paginationData,{conditions:this.queryCondition})).then(function(e){t.dataList=e.data,t.paginationData.dataCount=e.count,t.loadingDataList=!1,t.isSearching=!1}).catch(function(e){t.loadingDataList=!1,t.isSearching=!1,t.$message.error(e.message)})},searchProductInfo:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.isSearching=!0,e.getDataList(),e.$session.setQueryConditions(e.queryCondition)})},resetForm:function(t){this.$refs[t].resetFields(),this.$refs[t].clearValidate(),this.queryCondition.productType="",this.queryCondition.productCode=""},handleSelectionChange:function(t){var e=[];t.forEach(function(t){e.push(t.id)}),this.multipleSelection=e},handleBatch:function(t){var e=this;this.$api.product.bannerBatch({updateById:this.userId,idList:this.multipleSelection,enabled:1===t}).then(function(t){e.getDataList()}).catch(function(t){e.$message.error(t.message)})},handleAdd:function(){this.ifShowModel=!0,this.isAdd=!0,this.currentAdData={id:"",createById:this.userId,updateById:this.userId,productType:"",productCode:"",name:"",url:"",sequence:"",backgroundImageUrl:"",imageUrl:""}},handleEdit:function(t){this.ifShowModel=!0,this.isAdd=!1,this.currentAdData=t}}},l=u,c=(r("02a7"),r("ef51"),r("2877")),d=Object(c["a"])(l,n,a,!1,null,"5f2d16d8",null);e["default"]=d.exports},"28a5":function(t,e,r){"use strict";var n=r("aae3"),a=r("cb7c"),i=r("ebd6"),o=r("0390"),s=r("9def"),u=r("5f1b"),l=r("520a"),c=r("79e5"),d=Math.min,p=[].push,f="split",m="length",h="lastIndex",g=4294967295,b=!c(function(){RegExp(g,"y")});r("214f")("split",2,function(t,e,r,c){var v;return v="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[m]||2!="ab"[f](/(?:ab)*/)[m]||4!="."[f](/(.?)(.?)/)[m]||"."[f](/()()/)[m]>1||""[f](/.?/)[m]?function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!n(t))return r.call(a,t,e);var i,o,s,u=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,f=void 0===e?g:e>>>0,b=new RegExp(t.source,c+"g");while(i=l.call(b,a)){if(o=b[h],o>d&&(u.push(a.slice(d,i.index)),i[m]>1&&i.index<a[m]&&p.apply(u,i.slice(1)),s=i[0][m],d=o,u[m]>=f))break;b[h]===i.index&&b[h]++}return d===a[m]?!s&&b.test("")||u.push(""):u.push(a.slice(d)),u[m]>f?u.slice(0,f):u}:"0"[f](void 0,0)[m]?function(t,e){return void 0===t&&0===e?[]:r.call(this,t,e)}:r,[function(r,n){var a=t(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,a,n):v.call(String(a),r,n)},function(t,e){var n=c(v,t,this,e,v!==r);if(n.done)return n.value;var l=a(t),p=String(this),f=i(l,RegExp),m=l.unicode,h=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(b?"y":"g"),y=new f(b?l:"^(?:"+l.source+")",h),w=void 0===e?g:e>>>0;if(0===w)return[];if(0===p.length)return null===u(y,p)?[p]:[];var x=0,_=0,C=[];while(_<p.length){y.lastIndex=b?_:0;var S,k=u(y,b?p:p.slice(_));if(null===k||(S=d(s(y.lastIndex+(b?0:_)),p.length))===x)_=o(p,_,m);else{if(C.push(p.slice(x,_)),C.length===w)return C;for(var $=1;$<=k.length-1;$++)if(C.push(k[$]),C.length===w)return C;_=x=S}}return C.push(p.slice(x)),C}]})},"4a4b":function(t,e,r){},c527:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{visible:t.visible,width:"30%",top:"5vh","custom-class":"ad-modal"},on:{"update:visible":function(e){t.visible=e}}},[r("div",{staticStyle:{"font-size":"18px",color:"#333"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.isAdd?"新增广告":"编辑广告"))]),t._v(" "),r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"产品类型",prop:"productType"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择",disabled:!t.isAdd},on:{change:t.onChangeProductType},model:{value:t.form.productType,callback:function(e){t.$set(t.form,"productType",e)},expression:"form.productType"}},t._l(t.$settings.product.types,function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),r("el-form-item",{attrs:{label:"产品名称",prop:"productCode"}},[r("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.productAryLoading,expression:"productAryLoading"}],attrs:{clearable:"",placeholder:"请先选择产品类型",disabled:!t.isAdd},model:{value:t.form.productCode,callback:function(e){t.$set(t.form,"productCode",e)},expression:"form.productCode"}},t._l(t.productAry,function(t){return r("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1)],1),t._v(" "),r("el-form-item",{attrs:{label:"广告名称",prop:"name",error:t.nameErrorMsg}},[r("el-input",{attrs:{maxlength:"20","show-word-limit":"",clearable:"",placeholder:"请输入"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"跳转链接",prop:"url"}},[r("el-input",{attrs:{maxlength:"100","show-word-limit":"",clearable:"",placeholder:"请输入"},model:{value:t.form.url,callback:function(e){t.$set(t.form,"url",e)},expression:"form.url"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"排序",prop:"sequence",error:t.sequenceErrorMsg}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,max:99,placeholder:"请输入"},on:{focus:function(){t.sequenceErrorMsg=""}},model:{value:t.form.sequence,callback:function(e){t.$set(t.form,"sequence",e)},expression:"form.sequence"}})],1),t._v(" "),r("el-form-item",{staticClass:"item_backgroundImageUrl",attrs:{label:"背景图",prop:"backgroundImageUrl"}},[r("ImageUpload",{attrs:{"image-url":t.form.backgroundImageUrl,text1:"上传背景图",text2:"请上传PNG/JPG格式，尺寸1920*640，小于1M的图片"},on:{"update:imageUrl":function(e){return t.$set(t.form,"backgroundImageUrl",e)},"update:image-url":function(e){return t.$set(t.form,"backgroundImageUrl",e)}}})],1),t._v(" "),r("el-form-item",{staticClass:"mb0",attrs:{label:"文案图",prop:"imageUrl"}},[r("ImageUpload",{attrs:{"image-url":t.form.imageUrl,type:["image/png"],text1:"上传文案图",text2:"请上传PNG格式，尺寸1920*640，小于500k的图片"},on:{"update:imageUrl":function(e){return t.$set(t.form,"imageUrl",e)},"update:image-url":function(e){return t.$set(t.form,"imageUrl",e)}}})],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.onReset}},[t._v("重 置")]),t._v(" "),r("el-button",{attrs:{type:"primary",disabled:t.isSubmitDisable,loading:t.isSubmitting},on:{click:t.onSubmit}},[t._v("提 交")])],1)],1)},a=[],i=(r("28a5"),r("96cf"),r("3b8d")),o={name:"AddOrEdit",props:{ifShowModel:{type:Boolean,default:!1},isAdd:{type:Boolean,default:!0},currentFormData:{type:Object,default:function(){return{id:"",createById:"",updateById:"",productType:"",productCode:"",name:"",url:"",sequence:"",backgroundImageUrl:"",imageUrl:""}}}},data:function(){var t=function(t,e,r){e&&!/^(https?:)/.test(e)?r(new Error("输入的URL必须带协议头http/https")):r()};return{productAry:[],productAryLoading:!1,form:{},rules:{productType:[{required:!0,message:"请选择产品类型"}],productCode:[{required:!0,message:"请选择产品名称"}],name:[{required:!0,message:"请输入广告名称"}],url:[{validator:t,trigger:"blur"}],sequence:[{required:!0,message:"请输入排序"}],imageUrl:[{required:!0,message:"请上传文案图"}]},nameErrorMsg:"",sequenceErrorMsg:"",defaultFormData:{},isSubmitting:!1,isSubmitDisable:!0}},computed:{visible:{get:function(){return this.ifShowModel},set:function(t){this.$emit("update:ifShowModel",t)}}},watch:{visible:function(){this.$refs["form"]&&this.onReset()},currentFormData:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e,r){var n,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object.assign({},e),!n.id){t.next=4;break}return t.next=4,this.$api.product.getProductTypeByBannerId(n.id).then(function(t){n.productType=t.data?t.data[0].productType:""}).catch(function(t){a.$message.error(t.message)});case 4:if(!n.productType){t.next=7;break}return t.next=7,this.onChangeProductType(n.productType);case 7:this.form=n,this.defaultFormData=JSON.parse(JSON.stringify(this.form));case 9:case"end":return t.stop()}},t,this)}));function e(e,r){return t.apply(this,arguments)}return e}(),form:{handler:function(t,e){this.isSubmitDisable=this.$lib.isObjEqual(t,this.defaultFormData)},deep:!0},"form.name":function(){this.nameErrorMsg=""},"form.sequence":function(){this.sequenceErrorMsg=""},"form.imageUrl":function(t){t&&this.$refs["form"]&&this.$refs["form"].clearValidate("imageUrl")}},methods:{onChangeProductType:function(t){var e=this;this.productAry=[],this.form.productCode="",this.productAryLoading=!0,this.$api.product.getProductByType({type:t}).then(function(t){e.productAry=t.data,e.productAryLoading=!1})},onReset:function(){this.$refs["form"].resetFields(),this.form=JSON.parse(JSON.stringify(this.defaultFormData))},onSubmit:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.nameErrorMsg&&!this.sequenceErrorMsg){t.next=2;break}return t.abrupt("return",!1);case 2:this.$refs["form"].validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}if(e.isSubmitting=!0,!e.isAdd){t.next=7;break}return t.next=5,e.$api.product.bannerAdd(e.form).then(function(){e.visible=!1,e.$emit("refreshData")}).catch(function(t){e.formateErrorMsg(t)});case 5:t.next=9;break;case 7:return t.next=9,e.$api.product.bannerEdit(e.form).then(function(){e.visible=!1,e.$emit("refreshData")}).catch(function(t){e.formateErrorMsg(t)});case 9:e.isSubmitting=!1,t.next=13;break;case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),formateErrorMsg:function(t){var e=t.message.split(",");e.length>1?(this.nameErrorMsg="null"!==e[0]?e[0]:"",this.sequenceErrorMsg="null"!==e[1]?e[1]:""):this.$message.error(t.message)}}},s=o,u=(r("e808"),r("2877")),l=Object(u["a"])(s,n,a,!1,null,null,null);e["default"]=l.exports},e808:function(t,e,r){"use strict";var n=r("4a4b"),a=r.n(n);a.a},ef51:function(t,e,r){"use strict";var n=r("f282"),a=r.n(n);a.a},f282:function(t,e,r){},f833:function(t,e,r){}}]);