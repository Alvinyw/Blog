!function(z){z.fn.AddCanvasTurntable=function(t){var i,e,a,n,r,o=z.extend({sectorText:"",colors:"",rotateTime:"",alertText:"",resultTitle:"",fontSize:"",defaultSpacing:""},t),s=this,l=0,f=0,d=o.rotateTime?o.rotateTime:6,c=o.resultTitle?o.resultTitle:"当前已选中的结果如下：",h=o.alertText?o.alertText:"转盘里的内容已全部被选中！",p=o.fontSize?o.fontSize:16,m=o.defaultSpacing?o.defaultSpacing:35,g=o.colors?o.colors:["#e9536a","#fbd7a1","#df6679","#000","#fff","#666"],u=o.sectorText?o.sectorText:["扇形一","扇形二","扇形三","扇形四","扇形五","扇形六","扇形七","扇形八","扇形九","扇形十","扇形十一","扇形十二","扇形十三","扇形十四"],v=u.length,x=new Array,b=s.width(),P=s.attr("id"),T=Date.parse(new Date)/1e3,S=P+"canvasWrapper-"+T,y=P+"canvas1-"+T,w=P+"canvas2-"+T,k=P+"clickBtn-"+T,M=P+"result-"+T;function I(t,e){for(var a=0;a<t.length;a++)if(t[a]==e)return!0;return!1}!function(){var t=z("<div id='"+S+"'>");t.css({height:s.width(),width:s.width(),position:"relative"});var e=z("<canvas id='"+y+"' class='canvas1' width='"+b+"px' height='"+b+"px'>");e.css({"border-radius":"100%",transition:"transform "+d+"s","-o-transition":"transform "+d+"s","-ms-transition":"transform "+d+"s","-moz-transition":"transform "+d+"s","-webkit-transition":"transform "+d+"s","transform-origin":"50% 50%","-o-transform-origin":"50% 50%","-ms-transform-origin":"50% 50%","-moz-transform-origin":"50% 50%","-webkit-transform-origin":"50% 50%"}),t.append(e);var a=z("<canvas id='"+w+"' class='canvas2' width='"+b+"px' height='"+b+"px'>");a.css({position:"absolute",top:"0",left:"0","z-index":"30"}),t.append(a);var r=z("<button id='"+k+"' class='startBtn'>");r.css({position:"absolute",top:"50%",left:"50%",width:b/5,height:b/5,"margin-top":-b/10,"margin-left":-b/10,"border-radius":"100%",cursor:"pointer",border:"none",background:"transparent",outline:"none","z-index":"40"}),t.append(r);var n=z("<div id='"+M+"' class='result' width='"+b+"px'>"),i=z("<h3>"+c+"</h3>");n.append(i),s.append(t),s.append(n)}(),e=document.getElementById(y),a=document.getElementById(w),n=e.getContext("2d"),r=a.getContext("2d"),function(){for(var t=0,e=0,a=0;a<v;a++)t=a*Math.PI*2/v-Math.PI/2+2*Math.PI/v/2,e=t+2*Math.PI*(1/v),n.save(),n.beginPath(),n.arc(b/2,b/2,b/2,t,e,!1),n.lineWidth=b,n.strokeStyle=a%2==0?g[0]:g[1],a==v-1&&v%2!=0&&(n.strokeStyle=g[2]),n.stroke(),n.restore();n.beginPath(),n.arc(b/2,b/2,b/10,0,2*Math.PI,!1),n.fillStyle=g[4],n.fill(),n.closePath()}(),function(){n.textAlign="start",n.textBaseline="middle",n.fillStyle=g[3];for(var t=2*Math.PI/v,e=0;e<v;e++){n.save(),n.beginPath(),n.translate(b/2,b/2),n.rotate(e*t),n.font="Bold "+p+"px Microsoft YaHei",n.fillStyle=g[3];for(var a=u[e].split(""),r=0;r<a.length;r++)"("==a[r]||"（"==a[r]?a[r]="︵":")"!=a[r]&&"）"!=a[r]||(a[r]="︶"),n.fillText(a[r],-8,20*p/16*r-(b/2-m),30);n.closePath(),n.restore()}}(),r.beginPath(),r.strokeStyle=g[5],r.arc(b/2,b/2,b/2-2,0,2*Math.PI,!1),r.lineWidth=3,r.stroke(),r.closePath(),r.beginPath(),r.moveTo(b/2,.3*b),r.lineTo(b/2-9,b/2),r.lineTo(b/2+9,b/2),r.lineTo(b/2,.3*b),r.fillStyle=g[5],r.fill(),r.closePath(),r.beginPath(),r.arc(b/2,b/2,b/10-3,0,2*Math.PI,!1),r.fillStyle=g[5],r.fill(),r.closePath(),r.font="Bold 18px Microsoft YaHei",r.textAlign="start",r.textBaseline="middle",r.fillStyle=g[4],r.beginPath(),r.fillText("开始",b/2-16,b/2-1,40),r.fill(),r.closePath(),z("body").on("click","#"+k,function(){if(x.length<u.length){for(var t=0;-1<t;t++)if(r=0,n=u.length-1,f=Math.floor(Math.random()*(n-r+1)+r),!I(x,u[f])){i=2160*(l+1)-f*(360/v),u[f];break}e="rotate("+i+"deg)",(a=z("#"+y)).css("-o-transform",e),a.css("-ms-transform",e),a.css("-moz-transform",e),a.css("-webkit-transform",e),a.css("transform",e),z("#"+k).attr("disabled",!0),l+=1,setTimeout(function(){var t=z("<span>");t.html(u[f]),x.length,x.push(u[f]),z("#"+M).append(t),z("#"+k).removeAttr("disabled",!0)},1e3*d)}else alert(h);var e,a,r,n})}}(jQuery);