(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["recharge"],{"0ce8":function(t,n,e){},1070:function(t,n,e){"use strict";var o=e("ac54"),r=e.n(o);r.a},1840:function(t,n,e){"use strict";var o=e("0ce8"),r=e.n(o);r.a},"1d2d":function(t,n,e){"use strict";e.r(n);var o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("RechargeForm",{attrs:{inputTitle:"充值金额（元）",inputPlaceholder:"充值金额",submitButtonText:"立即充值",inputTips:"交易0手续费，预计实时到账，实际到账以银行为准",cardInfo:t.info["cardInfo"],bankLogo:t.info["bankLogo"],isPwdLoading:t.isPwdLoading,isSuccessLoading:t.isRechargeLoading},on:{onSubmit:t.onSubmit}})},r=[],s=(e("99af"),e("0d03"),e("b0c0"),e("a9e3"),e("96cf"),e("89ba")),i=e("9148"),a={name:"Recharge",components:{RechargeForm:i["a"]},data:function(){return{isPwdLoading:!1,isRechargeLoading:!1,pwdErrorCount:0,info:{cardInfo:"",bankLogo:""}}},computed:{maxPwdErrorCount:function(){return this.$store.state.app.maxPwdErrorCount}},methods:{notifyError:function(t){this.$notify({type:"danger",message:t})},transferAmount:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var e,o,r,s,i,a,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.amount,o=n.pwd,t.prev=1,this.isPwdLoading=!0,r=this.$session.getCustomerAccountId(),s=this.$session.getCustomerInfo(),i=s.customerId,t.next=7,this.$api.abc.transferAmount({amount:e,accountId:r,customerId:i,payPassword:o,transferFlag:1});case 7:if(a=t.sent,this.isPwdLoading=!1,u=Number(a["code"]),200!==u){t.next=14;break}return t.abrupt("return",!0);case 14:if(504!==u){t.next=22;break}return this.notifyError(a["message"]),this.pwdErrorCount++,this.$session.setPaymentPwdLimit(this.pwdErrorCount),this.pwdErrorCount===this.maxPwdErrorCount&&this.$session.setPaymentPwdTime((new Date).getTime()),t.abrupt("return",!1);case 22:return this.notifyError(a["message"]),t.abrupt("return",!1);case 24:t.next=31;break;case 26:return t.prev=26,t.t0=t["catch"](1),this.isPwdLoading=!1,this.notifyError(t.t0["message"]),t.abrupt("return",!1);case 31:case"end":return t.stop()}}),t,this,[[1,26]])})));function n(n){return t.apply(this,arguments)}return n}(),getCardInfo:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var n,e,o,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.isPwdLoading=!0,t.next=4,this.$api.abc.getTransferInfo({customerAccountId:this.$session.getCustomerAccountId()});case 4:n=t.sent,this.isPwdLoading=!1,(n||n["data"]&&n["data"][0])&&(e=n["data"][0],o=e.number,r=e.bankName,s=this.$app.getBankBasicInfo(r),this.info["bankLogo"]=s["icon"],this.info["cardInfo"]="".concat(s["shortName"]," ").concat(o)),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),this.isPwdLoading=!1,this.notifyError(t.t0["message"]);case 13:case"end":return t.stop()}}),t,this,[[0,9]])})));function n(){return t.apply(this,arguments)}return n}(),successLoading:function(){this.isRechargeLoading=!0;var t=this,n=t.$route.query.name;setTimeout((function(){t.isRechargeLoading=!1,t.$router.push({name:"successIndex",query:{name:n,result:"".concat(n,"成功")}})}),3e3)},onSubmit:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var e,o,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.amount,o=n.pwd,t.next=3,this.transferAmount({amount:e,pwd:o});case 3:r=t.sent,r&&(s=this.$route.query.name,this.$router.push({name:"successIndex",query:{name:s,result:"".concat(s,"成功")}}));case 5:case"end":return t.stop()}}),t,this)})));function n(n){return t.apply(this,arguments)}return n}()},mounted:function(){this.getCardInfo(),this.pwdErrorCount=this.$session.getPaymentPwdLimit()?Number(this.$session.getPaymentPwdLimit()):0}},u=a,c=e("2877"),d=Object(c["a"])(u,o,r,!1,null,null,null);n["default"]=d.exports},9148:function(t,n,e){"use strict";var o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"RechargeWithdrawForm"},[e("van-nav-bar",{attrs:{title:t.$route.query.name,"left-arrow":""},on:{"click-left":function(n){return t.$router.push({name:"homeIndex"})}}}),e("form",{staticClass:"recharge-form",on:{submit:function(n){return n.preventDefault(),t.onSubmitForm(n)}}},[e("div",{staticClass:"recharge-main"},[e("div",{staticClass:"recharge-form-top"},[e("van-row",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.inputTitle))]),e("van-row",{staticClass:"recharge-description",style:{"border-color":t.isFocus?"#222222":"#ccc"},attrs:{type:"flex",align:"center"}},[e("i",{staticClass:"description-currency"}),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.amount,expression:"amount",modifiers:{trim:!0}}],staticClass:"description-input",class:[t.amount?"":"default-input"],attrs:{readonly:"",placeholder:t.inputPlaceholder},domProps:{value:t.amount},on:{click:function(n){t.isFocus=!0},input:function(n){n.target.composing||(t.amount=n.target.value.trim())},blur:function(n){return t.$forceUpdate()}}}),t.totalAmount?e("span",{staticClass:"all-button",on:{click:t.onAll}},[t._v("全部")]):t._e()]),e("van-row",{staticClass:"description-tips"},[t._v(t._s(t.inputTips))])],1),e("van-row",{staticClass:"recharge-bank",attrs:{type:"flex",align:"center",justify:"center"}},[e("van-col",{attrs:{span:8}},[t._v(t._s(t.totalAmount?"收款账户":"付款账户"))]),e("van-col",{staticClass:"logo-wrap",attrs:{span:14,offset:2}},[e("i",{class:["bank-logo",t.bankLogo]}),e("span",{staticClass:"bank-info"},[t._v(t._s(t.cardInfo))])])],1)],1),e("van-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"recharge-button",attrs:{type:"primary",disabled:0===Number(this.amount)},on:{click:t.onSubmitForm}},[t._v(t._s(t.submitButtonText))])],1),e("van-number-keyboard",{attrs:{show:t.isFocus,"extra-key":"."},on:{blur:function(n){t.isFocus=!1},input:t.onInput,delete:t.onDelete}}),e("PaymentPwdPopup",{attrs:{isShowPwdKeybord:t.isShowPwdKeybord},on:{onClose:t.closePopup,onSubmit:t.onSubmitPwd}}),e("VanLoading",{attrs:{effectType:0,"if-show-loading":t.isPwdLoading},on:{"update:ifShowLoading":function(n){t.isPwdLoading=n},"update:if-show-loading":function(n){t.isPwdLoading=n}}})],1)},r=[],s=(e("fb6a"),e("0d03"),e("a9e3"),e("ac1f"),e("1276"),e("d77f")),i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("van-popup",{staticClass:"paymentPwdPopup",attrs:{position:"bottom"},model:{value:t.show,callback:function(n){t.show=n},expression:"show"}},[e("div",{staticClass:"paymentPwd-main"},[e("h3",{staticClass:"title"},[t._v("输入支付密码")]),e("van-password-input",{attrs:{length:6,focused:!0,value:t.pwdValue}}),e("router-link",{staticClass:"forget-link",attrs:{to:{name:"paymentPswForgetIndex"}}},[t._v("忘记密码")])],1),e("van-number-keyboard",{attrs:{show:!0},model:{value:t.pwdValue,callback:function(n){t.pwdValue=n},expression:"pwdValue"}})],1)},a=[],u={name:"PaymentPwdPopup",props:{isShowPwdKeybord:Boolean},data:function(){return{pwdValue:""}},computed:{show:{get:function(){return this.isShowPwdKeybord},set:function(t){this.$emit("onClose",t),t||(this.pwdValue="")}}},watch:{pwdValue:function(t){6===t.length&&this.$emit("onSubmit",this.pwdValue)}}},c=u,d=(e("1840"),e("2877")),m=Object(d["a"])(c,i,a,!1,null,"262a1386",null),h=m.exports,l={name:"RechargeWithdrawForm",components:{VanLoading:s["a"],PaymentPwdPopup:h},props:{inputTitle:String,inputPlaceholder:String,inputTips:String,cardInfo:String,submitButtonText:String,totalAmount:String,isPwdLoading:Boolean,isSuccessLoading:Boolean,bankLogo:String},data:function(){return{amount:"",isFocus:!1,isShowPwdKeybord:!1}},methods:{notifyError:function(t){this.$notify({type:"danger",message:t})},checkIsExpire:function(){var t=(new Date).getTime(),n=this.$session.getPaymentPwdTime(),e=(t-n)/1e3/60>=15;return n&&e},onAll:function(){this.amount=this.totalAmount},closePopup:function(t){this.isShowPwdKeybord=t},onInput:function(t){var n=this.amount+t,e=n.split(".");n.length>1&&0===Number(n[0])&&0===Number(n[1])?this.notifyError("请输入合法数值"):"."===n||e.length>2?this.notifyError("请输入合法数值"):e[1]&&e[1].length>2?this.notifyError("最多可输入两位小数"):this.amount+=t},onDelete:function(){this.amount=this.amount.slice(0,this.amount.length-1)},onSubmitForm:function(){if(!/^(([1-9]{1}\d*)|(0{1}))(\.\d{0,2})?$/.test(this.amount))return this.notifyError("表单验证失败，请填入合法内容！"),!1;if(this.totalAmount&&Number(this.amount)>Number(this.totalAmount))return this.notifyError("提现金额不得大于账户金额"),!1;if(!this.totalAmount&&Number(this.amount)>1e4)return this.notifyError("充值金额不得大于10000"),!1;var t=this.checkIsExpire(),n=Number(this.$session.getPaymentPwdLimit())||0,e=n>=this.$store.state.app.maxPwdErrorCount;if(e&&!t)return this.notifyError("支付密码错误次数到达上限，请在15分钟之后重试"),!1;t&&(this.$session.removePaymentPwdTime(),this.$session.removePaymentPwdLimit()),this.isShowPwdKeybord=!0},onSubmitPwd:function(t){this.isShowPwdKeybord=!1,this.$emit("onSubmit",{amount:this.amount,pwd:t})}}},p=l,f=(e("1070"),Object(d["a"])(p,o,r,!1,null,"fa3bb428",null));n["a"]=f.exports},ac54:function(t,n,e){}}]);