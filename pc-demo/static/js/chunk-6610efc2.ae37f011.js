(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6610efc2"],{3450:function(e,t,i){"use strict";(function(e,r){i("5fe5"),i("7c11");var n,o=i("1157"),a=i("1157"),s=s||{},l=navigator.userAgent.toLowerCase(),d=navigator.platform.toLowerCase(),h="win32"==d||"win64"==d||"windows"==d,u=l.indexOf("msie"),c=l.indexOf("trident"),g=l.indexOf("rv:"),m=l.indexOf("edge"),p=l.match(/version\/([\d.]+).*safari/),f=!!p,v=(p&&p[1],l.indexOf("firefox")),w=-1!=v,y=h&&!w&&-1!=m,b=l.indexOf("chrome"),C=!y&&-1!=b,_=h&&!w&&!y&&!C&&(-1!=u||-1!=c||-1!=g),I="",S=0,x="ipad"==l.match(/ipad/i),P="iphone os"==l.match(/iphone os/i),T="midp"==l.match(/midp/i),E="rv:1.2.3.4"==l.match(/rv:1.2.3.4/i),F="ucweb"==l.match(/ucweb/i),A="android"==l.match(/android/i),k="windows ce"==l.match(/windows ce/i),W="windows mobile"==l.match(/windows mobile/i);n=x||P||T||E||F||A||k||W?"phone":"pc",y?(p=l.slice(m+5),p=p.slice(0,p.indexOf(" ")),I=p):C?(p=l.slice(b+7),p=p.slice(0,p.indexOf(" ")),I=p):w?(p=l.slice(v+8),p=p.slice(0,p.indexOf(" ")),I=p):_?-1!=u?(p=l.slice(u+4),p=p.slice(0,p.indexOf(";")),I=p):-1!=g?(p=l.slice(g+3),p=p.slice(0,p.indexOf(";")),p=p.slice(0,p.indexOf(")")),I=p):-1!=c&&(p=l.slice(c+7),p=p.slice(0,p.indexOf(";")),I=p):f&&p&&(I=p[1]),I.indexOf(".")>-1&&(S=1*I.slice(0,I.indexOf("."))),function(){var t=!1,r=self,n=function(e){return e instanceof n?e:this instanceof n?void(this.EXIFwrapped=e):new n(e)};"undefined"!==typeof exports?(e.exports&&(exports=e.exports=n),exports.EXIF=n):r.EXIF=n;var o=n.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},a=n.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},s=n.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},l=n.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},d=n.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function h(e){return!!e.exifdata}function u(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var i=atob(e),r=i.length,n=new ArrayBuffer(r),o=new Uint8Array(n),a=0;a<r;a++)o[a]=i.charCodeAt(a);return n}function c(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(e){200!=this.status&&0!==this.status||t(this.response)},i.send()}function g(e,i){function r(t){var r=m(t),n=p(t),o=S(t);e.exifdata=r||{},e.iptcdata=n||{},e.xmpdata=o||{},i&&i.call(e)}if(e.src)if(/^data\:/i.test(e.src)){var n=u(e.src);r(n)}else if(/^blob\:/i.test(e.src)){var o=new FileReader;o.onload=function(e){r(e.target.result)},c(e.src,function(e){o.readAsArrayBuffer(e)})}else{var a=new XMLHttpRequest;a.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";r(a.response),a=null},a.open("GET",e.src,!0),a.responseType="arraybuffer",a.send(null)}else if(self.FileReader&&(e instanceof self.Blob||e instanceof self.File)){o=new FileReader;o.onload=function(e){t&&console.log("Got file of length "+e.target.result.byteLength),r(e.target.result)},o.readAsArrayBuffer(e)}}function m(e){var i=new DataView(e);if(t&&console.log("Got file of length "+e.byteLength),255!=i.getUint8(0)||216!=i.getUint8(1))return t&&console.log("Not a valid JPEG"),!1;var r,n=2,o=e.byteLength;while(n<o){if(255!=i.getUint8(n))return t&&console.log("Not a valid marker at offset "+n+", found: "+i.getUint8(n)),!1;if(r=i.getUint8(n+1),t&&console.log(r),225==r)return t&&console.log("Found 0xFFE1 marker"),I(i,n+4,i.getUint16(n+2)-2);n+=2+i.getUint16(n+2)}}function p(e){var i=new DataView(e);if(t&&console.log("Got file of length "+e.byteLength),255!=i.getUint8(0)||216!=i.getUint8(1))return t&&console.log("Not a valid JPEG"),!1;var r=2,n=e.byteLength,o=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};while(r<n){if(o(i,r)){var a=i.getUint8(r+7);a%2!==0&&(a+=1),0===a&&(a=4);var s=r+8+a,l=i.getUint16(r+6+a);return v(e,s,l)}r++}}var f={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function v(e,t,i){var r,n,o,a,s=new DataView(e),l={},d=t;while(d<t+i)28===s.getUint8(d)&&2===s.getUint8(d+1)&&(a=s.getUint8(d+2),a in f&&(o=s.getInt16(d+3),o+5,n=f[a],r=_(s,d+5,o),l.hasOwnProperty(n)?l[n]instanceof Array?l[n].push(r):l[n]=[l[n],r]:l[n]=r)),d++;return l}function w(e,i,r,n,o){var a,s,l,d=e.getUint16(r,!o),h={};for(l=0;l<d;l++)a=r+12*l+2,s=n[e.getUint16(a,!o)],!s&&t&&console.log("Unknown tag: "+e.getUint16(a,!o)),h[s]=y(e,a,i,r,o);return h}function y(e,t,i,r,n){var o,a,s,l,d,h,u=e.getUint16(t+2,!n),c=e.getUint32(t+4,!n),g=e.getUint32(t+8,!n)+i;switch(u){case 1:case 7:if(1==c)return e.getUint8(t+8,!n);for(o=c>4?g:t+8,a=[],l=0;l<c;l++)a[l]=e.getUint8(o+l);return a;case 2:return o=c>4?g:t+8,_(e,o,c-1);case 3:if(1==c)return e.getUint16(t+8,!n);for(o=c>2?g:t+8,a=[],l=0;l<c;l++)a[l]=e.getUint16(o+2*l,!n);return a;case 4:if(1==c)return e.getUint32(t+8,!n);for(a=[],l=0;l<c;l++)a[l]=e.getUint32(g+4*l,!n);return a;case 5:if(1==c)return d=e.getUint32(g,!n),h=e.getUint32(g+4,!n),s=new Number(d/h),s.numerator=d,s.denominator=h,s;for(a=[],l=0;l<c;l++)d=e.getUint32(g+8*l,!n),h=e.getUint32(g+4+8*l,!n),a[l]=new Number(d/h),a[l].numerator=d,a[l].denominator=h;return a;case 9:if(1==c)return e.getInt32(t+8,!n);for(a=[],l=0;l<c;l++)a[l]=e.getInt32(g+4*l,!n);return a;case 10:if(1==c)return e.getInt32(g,!n)/e.getInt32(g+4,!n);for(a=[],l=0;l<c;l++)a[l]=e.getInt32(g+8*l,!n)/e.getInt32(g+4+8*l,!n);return a}}function b(e,t,i){var r=e.getUint16(t,!i);return e.getUint32(t+2+12*r,!i)}function C(e,t,i,r){var n=b(e,t+i,r);if(!n)return{};if(n>e.byteLength)return{};var o=w(e,t,t+n,l,r);if(o["Compression"])switch(o["Compression"]){case 6:if(o.JpegIFOffset&&o.JpegIFByteCount){var a=t+o.JpegIFOffset,s=o.JpegIFByteCount;o["blob"]=new Blob([new Uint8Array(e.buffer,a,s)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",o["Compression"])}else 2==o["PhotometricInterpretation"]&&console.log("Thumbnail image format is RGB, which is not implemented.");return o}function _(e,t,i){for(var r="",n=t;n<t+i;n++)r+=String.fromCharCode(e.getUint8(n));return r}function I(e,i){if("Exif"!=_(e,i,4))return t&&console.log("Not valid EXIF data! "+_(e,i,4)),!1;var r,n,l,h,u,c=i+6;if(18761==e.getUint16(c))r=!1;else{if(19789!=e.getUint16(c))return t&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;r=!0}if(42!=e.getUint16(c+2,!r))return t&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var g=e.getUint32(c+4,!r);if(g<8)return t&&console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(c+4,!r)),!1;if(n=w(e,c,c+g,a,r),n.ExifIFDPointer)for(l in h=w(e,c,c+n.ExifIFDPointer,o,r),h){switch(l){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":h[l]=d[l][h[l]];break;case"ExifVersion":case"FlashpixVersion":h[l]=String.fromCharCode(h[l][0],h[l][1],h[l][2],h[l][3]);break;case"ComponentsConfiguration":h[l]=d.Components[h[l][0]]+d.Components[h[l][1]]+d.Components[h[l][2]]+d.Components[h[l][3]];break}n[l]=h[l]}if(n.GPSInfoIFDPointer)for(l in u=w(e,c,c+n.GPSInfoIFDPointer,s,r),u){switch(l){case"GPSVersionID":u[l]=u[l][0]+"."+u[l][1]+"."+u[l][2]+"."+u[l][3];break}n[l]=u[l]}return n["thumbnail"]=C(e,c,g,r),n}function S(e){if("DOMParser"in self){var i=new DataView(e);if(t&&console.log("Got file of length "+e.byteLength),255!=i.getUint8(0)||216!=i.getUint8(1))return t&&console.log("Not a valid JPEG"),!1;var r=2,n=e.byteLength,o=new DOMParser;while(r<n-4){if("http"==_(i,r,4)){var a=r-1,s=i.getUint16(r-2)-1,l=_(i,a,s),d=l.indexOf("xmpmeta>")+8;l=l.substring(l.indexOf("<x:xmpmeta"),d);var h=l.indexOf("x:xmpmeta")+10;l=l.slice(0,h)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+l.slice(h);var u=o.parseFromString(l,"text/xml");return x(u)}r++}}}function x(e){try{var t={};if(e.children.length>0)for(var i=0;i<e.children.length;i++){var r=e.children.item(i),n=r.attributes;for(var o in n){var a=n[o],s=a.nodeName,l=a.nodeValue;void 0!==s&&(t[s]=l)}var d=r.nodeName;if("undefined"==typeof t[d])t[d]=xml2json(r);else{if("undefined"==typeof t[d].push){var h=t[d];t[d]=[],t[d].push(h)}t[d].push(xml2json(r))}}else t=e.textContent;return t}catch(u){console.log(u.message)}}n.getData=function(e,t){return!((self.Image&&e instanceof self.Image||self.HTMLImageElement&&e instanceof self.HTMLImageElement)&&!e.complete)&&(h(e)?t&&t.call(e):g(e,t),!0)},n.getTag=function(e,t){if(h(e))return e.exifdata[t]},n.getIptcTag=function(e,t){if(h(e))return e.iptcdata[t]},n.getAllTags=function(e){if(!h(e))return{};var t,i=e.exifdata,r={};for(t in i)i.hasOwnProperty(t)&&(r[t]=i[t]);return r},n.getAllIptcTags=function(e){if(!h(e))return{};var t,i=e.iptcdata,r={};for(t in i)i.hasOwnProperty(t)&&(r[t]=i[t]);return r},n.pretty=function(e){if(!h(e))return"";var t,i=e.exifdata,r="";for(t in i)i.hasOwnProperty(t)&&("object"==typeof i[t]?i[t]instanceof Number?r+=t+" : "+i[t]+" ["+i[t].numerator+"/"+i[t].denominator+"]\r\n":r+=t+" : ["+i[t].length+" values]\r\n":r+=t+" : "+i[t]+"\r\n");return r},n.readFromBinaryFile=function(e){return m(e)},"function"===typeof define&&i("3c35")&&define("exif-js",[],function(){return n})}.call(void 0),function(e){e.MBC||(e.MBC={});var t=e.MBC.Lib={};t.getElDimensions=function(e){var t,i;return!!e&&(t=e.style.display,e.style.display="",i={clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=t,i)},t.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.addClass=function(e,t){this.hasClass(e,t)||(e.className+=t)},t.removeClass=function(e,t){if(this.hasClass(e,t)){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ")}},t.toggleClass=function(e,t){this.hasClass(e,t)?this.removeClass(e,t):this.addClass(e,t)},t.isNumber=function(e){return""!==e&&null!=e&&!isNaN(e)},t.each=function(e,i,r){if(e){var n,o,a,s=0,l=e.length,d=t.isUndefined(l)||t.isFunction(e);if(r=r||null,d){for(a=t.keys(e);s<a.length;s++)if(n=a[s],!1===i.call(r,e[n],n,e))break}else for(o=e[0];s<l;o=e[++s])if(!1===i.call(r,o,s,e))break}return e},t.isUndefined=function(e){return"undefined"==typeof e},t.isFunction=function(e){return e&&"function"===typeof e};var i=!{toString:1}.propertyIsEnumerable("toString"),r=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"];function n(e,t){return{}.hasOwnProperty.call(e,t)}t.keys=Object.keys||function(e){var t,o,a=[];for(t in e)n(e,t)&&a.push(t);if(i)for(o=r.length-1;o>=0;o--)t=r[o],n(e,t)&&a.push(t);return a},t.doCallbackNoBreak=function(e,t){if(e)try{e.apply(window,t||[])}catch(i){setTimeout(function(){throw i},0)}},t.convertBase64ToBlob=function(e,t){for(var i=window.atob(e),r=new Array(i.length),n=0;n<i.length;++n)r[n]=i.charCodeAt(n);var o=new Uint8Array(r);return new Blob([o],{type:t})},t.convertURLToBlob=function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onloadend=function(){t(this.response)},i.send()},t.canvasToBlob=function(e,i,r,n){if(e.toBlob)e.toBlob(i,r,n);else{var o=e.toDataURL(r,n),a=t.convertBase64ToBlob(o.substring(o.indexOf(",")+1),r);i(a)}},t.getBlobFromAnyImgData=function(e,i){if(e instanceof Blob)i(e);else if(e instanceof HTMLCanvasElement)t.canvasToBlob(e,function(e){i(e)});else if("string"==typeof e||e instanceof String){var r=e;if("data:"==r.substring(0,5)){var n="";"image/"==r.substring(5,11)&&(n=r.substring(5,r.indexOf(";",11)));var o=t.convertBase64ToBlob(r.substring(r.indexOf("base64,")+7),n);i(o)}else t.convertURLToBlob(r,function(e){i(e)})}else if(e instanceof HTMLImageElement){var a;try{a=e.src}catch(g){return setTimeout(function(){throw g},0),void i(null,"")}var s=document.createElement("canvas");s.width=e.naturalWidth,s.height=e.naturalHeight;var l=s.getContext("2d");l.drawImage(e,0,0);var d,h="",u=a.lastIndexOf("?"),c=-1;-1!=u?(c=a.lastIndexOf(".",u),-1!=c&&u-c<=5&&(h=a.substring(c+1,u))):(c=a.lastIndexOf("."),-1!=c&&(h=a.length-c<=5?a.substring(c+1):a.substring(c+1,c+5))),d=-1!=h.indexOf("webp")?"image/webp":-1!=h.indexOf("png")||-1!=h.indexOf("gif")||-1!=h.indexOf("svg")?"image/png":"image/jpeg",t.canvasToBlob(s,function(e){i(e)},d)}else i(null)},t.addEvent=function(e,t,i){var r=t.split(" ");if(e.length)for(var n=0;n<e.length;n++)for(o=0;o<r.length;o++)e[n].addEventListener?e[n].addEventListener(r[o],i,!1):e[n].attachEvent("on"+r[o],i);else for(var o=0;o<r.length;o++)e.addEventListener?e.addEventListener(r[o],i,!1):e.attachEvent("on"+r[o],i)},t.removeEvent=function(e,t,i){var r=t.split(" ");if(e.length)for(var n=0;n<e.length;n++)for(o=0;o<r.length;o++)e[n].removeEventListener?e[n].removeEventListener(r[o],i,!1):e[n].detachEvent("on"+r[o],i);else for(var o=0;o<r.length;o++)e.removeEventListener?e.removeEventListener(r[o],i,!1):e.detachEvent("on"+r[o],i)},t.stopDefault=function(e){e&&e.preventDefault?e.preventDefault():window.event.returnValue=!1},t._querySelectorAll=function(e,t){var i=1e4;if(e.querySelectorAll)return e.querySelectorAll(t);var r=""===e.id;r&&(++i,e.id="__qsa"+i);try{return document.querySelectorAll("#"+e.id+" "+t)}finally{r&&(e.id="")}},t.fireEvent=function(e,t){var i;document.createEvent?(i=document.createEvent("HTMLEvents"),i.initEvent(e,!0,!0),t.dispatchEvent&&t.dispatchEvent(i)):document.createEventObject?(i=document.createEventObject(),i.bubbles=!0,i.cancelable=!0,t.fireEvent(e,i)):(i=new Event(e),t.dispatchEvent&&t.dispatchEvent(i))},Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=this,i=0;i<t.length;i++)if(t[i]==e)return i;return-1}),document.querySelectorAll||(document.querySelectorAll=function(e){var t,i=document.createElement("style"),r=[];document.documentElement.firstChild.appendChild(i),document._qsa=[],i.styleSheet.cssText=e+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),i.parentNode.removeChild(i);while(document._qsa.length)t=document._qsa.shift(),t.style.removeAttribute("x-qsa"),r.push(t);return document._qsa=null,r}),document.querySelector||(document.querySelector=function(e){var t=document.querySelectorAll(e);return t.length?t[0]:null}),t.mix=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},t.Errors={Sucess:function(e){e._errorCode=0,e._errorString="Successful."},IndexOutOfRange:function(e){e._errorCode=-1e3,e._errorString="The index is out of range."},FucNotValidInThisMode:function(e,t,i){e._errorCode=-1001,e._errorString=t+"(): This function is not valid in "+i+" mode."},InvalidValue:function(e){e._errorCode=-1002,e._errorString="Invalid value."},InvalidParameterType:function(e){e._errorCode=-1003,e._errorString="Parameter type is not supported."},__last:!1},t.DEF=function(e,t,i){Object.defineProperty(e,t,i)},t.attachProperty=function(e){var i=e,r=t.DEF;r(i,"ErrorCode",{get:function(){return i._errorCode}}),r(i,"ErrorString",{get:function(){return 0!=i._errorCode?i._errorString:"Successful."}}),r(i,"HowManyImagesInBuffer",{get:function(){return i.GetCount()}}),r(i,"CurrentImageIndexInBuffer",{get:function(){return i.GetCurentIndex()},set:function(e){var t=1*e;return t>=0&&t<i.GetCount()&&i.ShowImage(t),!0}})}}(s),function(e){var t=e["Promise"],r=t&&"resolve"in t&&"reject"in t&&"all"in t&&"race"in t&&function(){var e;return new t(function(t){e=t}),"function"===typeof e}();"undefined"!==typeof exports&&exports?(exports.Promise=r?t:S,exports.Polyfill=S):"function"==typeof define&&i("3c35")?define(function(){return r?t:S}):r||(e["Promise"]=S);var n="pending",o="sealed",a="fulfilled",s="rejected",l=function(){};function d(e){return"[object Array]"===Object.prototype.toString.call(e)}var h,u="undefined"!==typeof setImmediate?setImmediate:setTimeout,c=[];function g(){for(var e=0;e<c.length;e++)c[e][0](c[e][1]);c=[],h=!1}function m(e,t){c.push([e,t]),h||(h=!0,u(g,0))}function p(e,t){function i(e){w(t,e)}function r(e){b(t,e)}try{e(i,r)}catch(n){r(n)}}function f(e){var t=e.owner,i=t.state_,r=t.data_,n=e[i],o=e.then;if("function"===typeof n){i=a;try{r=n(r)}catch(l){b(o,l)}}v(o,r)||(i===a&&w(o,r),i===s&&b(o,r))}function v(e,t){var i;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"===typeof t||"object"===typeof t)){var r=t.then;if("function"===typeof r)return r.call(t,function(r){i||(i=!0,t!==r?w(e,r):y(e,r))},function(t){i||(i=!0,b(e,t))}),!0}}catch(n){return i||b(e,n),!0}return!1}function w(e,t){e!==t&&v(e,t)||y(e,t)}function y(e,t){e.state_===n&&(e.state_=o,e.data_=t,m(_,e))}function b(e,t){e.state_===n&&(e.state_=o,e.data_=t,m(I,e))}function C(e){var t=e.then_;e.then_=void 0;for(var i=0;i<t.length;i++)f(t[i])}function _(e){e.state_=a,C(e)}function I(e){e.state_=s,C(e)}function S(e){if("function"!==typeof e)throw new TypeError("Promise constructor takes a function argument");if(this instanceof S===!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],p(e,this)}S.prototype={constructor:S,state_:n,then_:null,data_:void 0,then:function(e,t){var i={owner:this,then:new this.constructor(l),fulfilled:e,rejected:t};return this.state_===a||this.state_===s?m(f,i):this.then_.push(i),i.then},catch:function(e){return this.then(null,e)}},S.all=function(e){var t=this;if(!d(e))throw new TypeError("You must pass an array to Promise.all().");return new t(function(t,i){var r=[],n=0;function o(e){return n++,function(i){r[e]=i,--n||t(r)}}for(var a,s=0;s<e.length;s++)a=e[s],a&&"function"===typeof a.then?a.then(o(s),i):r[s]=a;n||t(r)})},S.race=function(e){var t=this;if(!d(e))throw new TypeError("You must pass an array to Promise.race().");return new t(function(t,i){for(var r,n=0;n<e.length;n++)r=e[n],r&&"function"===typeof r.then?r.then(t,i):t(r)})},S.resolve=function(e){var t=this;return e&&"object"===typeof e&&e.constructor===t?e:new t(function(t){t(e)})},S.reject=function(e){var t=this;return new t(function(t,i){i(e)})}}("undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:void 0);var H=H||{};function M(e){var t=new s.MBC.ImageViewer(e);return t}Math.sign||(Math.sign=function(e){return e>0?1:0==e?1/e<0?-0:0:e<0?-1:NaN}),H.Matrix=function(e,t,i,r,n,o){this.a=e,this.b=t,this.c=i,this.d=r,this.e=n,this.f=o},H.Matrix.dot=function(e,t){var i=e,r=t;return new H.Matrix(i.a*r.a+i.c*r.b,i.b*r.a+i.d*r.b,i.a*r.c+i.c*r.d,i.b*r.c+i.d*r.d,i.a*r.e+i.c*r.f+i.e,i.b*r.e+i.d*r.f+i.f)},H.Matrix.prototype.dot=function(e){return H.Matrix.dot(this,e)},H.Matrix.equals=function(e,t){var i=e,r=t;return i.a==r.a&&i.b==r.b&&i.c==r.c&&i.d==r.d&&i.e==r.e&&i.f==r.f},H.Matrix.prototype.equals=function(e){return H.Matrix.equals(this,e)},H.Matrix.prototype.inversion=function(){var e=this.a,t=this.b,i=this.c,r=this.d,n=this.e,o=this.f,a=e*r-t*i;return new H.Matrix(r/a,-t/a,-i/a,e/a,(i*o-r*n)/a,(t*n-e*o)/a)},H.convertURLToBlob=function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onloadend=function(){t(this.response)},i.send()},H.convertBase64ToBlob=function(e,t){for(var i=atob(e),r=new Array(i.length),n=0;n<i.length;++n)r[n]=i.charCodeAt(n);var o=new Uint8Array(r);return new Blob([o],{type:t})},Date.prototype.kUtilFormat=function(e){var t={"M+":this.getUTCMonth()+1,"d+":this.getUTCDate(),"h+":this.getUTCHours(),"m+":this.getUTCMinutes(),"s+":this.getUTCSeconds(),"q+":Math.floor((this.getUTCMonth()+3)/3),S:this.getUTCMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},H.copyToClipBoard=function(e){if(navigator.clipboard)navigator.clipboard.writeText(e)["catch"](function(e){alert("copy failed, info: "+(e.message||e))});else{var t=document.createElement("textarea");t.style.width="4px",t.style.height="4px",t.style.position="fixed",t.style.left="0",t.style.top="0",a(document.body).append(t),t.value=e;var i=navigator.userAgent.match(/ipad|iphone/i);if(i){var r=document.createRange();r.selectNodeContents(t);var n=window.getSelection();n.removeAllRanges(),n.addRange(r),t.setSelectionRange(0,999999)}else t.focus(),t.select();try{var o=document.execCommand("copy");o||i||alert("copy failed")}catch(s){alert("copy failed, info: "+(s.message||s))}a(t).remove()}},function(e){e.fn.borderWidth=function(){var e=null;e=window.getComputedStyle?getComputedStyle(this[0]):this[0].currentStyle;var t={};return t.left=parseFloat(e.getPropertyValue?e.getPropertyValue("border-left-width"):e.getAttribute("border-left-width"))||0,t.top=parseFloat(e.getPropertyValue?e.getPropertyValue("border-top-width"):e.getAttribute("border-top-width"))||0,t.right=parseFloat(e.getPropertyValue?e.getPropertyValue("border-right-width"):e.getAttribute("border-right-width"))||0,t.bottom=parseFloat(e.getPropertyValue?e.getPropertyValue("border-bottom-width"):e.getAttribute("border-bottom-width"))||0,t},e.fn.padding=function(){var e=null;e=window.getComputedStyle?getComputedStyle(this[0]):this[0].currentStyle;var t={};return t.left=parseFloat(e.getPropertyValue?e.getPropertyValue("padding-left"):e.getAttribute("padding-left"))||0,t.top=parseFloat(e.getPropertyValue?e.getPropertyValue("padding-top"):e.getAttribute("padding-top"))||0,t.right=parseFloat(e.getPropertyValue?e.getPropertyValue("padding-right"):e.getAttribute("padding-right"))||0,t.bottom=parseFloat(e.getPropertyValue?e.getPropertyValue("padding-bottom"):e.getAttribute("padding-bottom"))||0,t},e.fn.borderBoxRect=function(){var e=null;window.getComputedStyle&&(e=getComputedStyle(this[0]));var t=this.offset(),i={};return i.pageX0=t.left,i.pageY0=t.top,i.width=e?parseFloat(e.width):this.outerWidth(),i.height=e?parseFloat(e.height):this.outerHeight(),i.pageX1=i.pageX0+i.width,i.pageY1=i.pageY0+i.height,i},e.fn.paddingBoxRect=function(){var e=this.borderBoxRect(),t=this.borderWidth(),i={};return i.pageX0=e.pageX0+t.left,i.pageY0=e.pageY0+t.top,i.width=window.getComputedStyle?e.width-(t.left+t.right):this.innerWidth(),i.height=window.getComputedStyle?e.height-(t.top+t.bottom):this.innerHeight(),i.pageX1=e.pageX1-t.right,i.pageY1=e.pageY1-t.bottom,i},e.fn.contentBoxRect=function(){var e=this.paddingBoxRect(),t=this.padding(),i={};return i.pageX0=e.pageX0+t.left,i.pageY0=e.pageY0+t.top,i.width=window.getComputedStyle?e.width-(t.left+t.right):this.width(),i.height=window.getComputedStyle?e.height-(t.top+t.bottom):this.height(),i.pageX1=e.pageX1-t.right,i.pageY1=e.pageY1-t.bottom,i},e.fn.getTransform=function(){var e=this.css("transform");"none"!=e&&""!=e||(e=this[0].style.transform);var t="matrix(",i=e.indexOf(t);if(-1!=i){i+=t.length;for(var r=e.substring(i,e.indexOf(")",i)).split(","),n=0;n<r.length;++n)r[n]=parseFloat(r[n]);return new H.Matrix(r[0],r[1],r[2],r[3],r[4],r[5])}t="scale(";var o=e.indexOf(t);if(-1!=o){o+=t.length;var a=parseFloat(e.substring(o));return new H.Matrix(a,0,0,a,0,0)}return new H.Matrix(1,0,0,1,0,0)},e.fn.setTransform=function(e){var t=e,i="matrix("+[t.a,t.b,t.c,t.d,t.e,t.f].join(",")+")";this.css("transform",i)}}(a),function(e,t){var i=e;function r(e){var t=this;t.videoHtmlElement=['<div class="kPainterVideoMdl">','<video class="kPainterVideo" webkit-playsinline="true"></video>','<select class="kPainterCameraSelect">',"</select>",'<select class="kPainterResolutionSelect">','<option class="kPainterGotResolutionOpt" value="got" selected></option>','<option data-width="3840" data-height="2160">ask 3840 x 2160</option>','<option data-width="1920" data-height="1080">ask 1920 x 1080</option>','<option data-width="1600" data-height="1200">ask 1600 x 1200</option>','<option data-width="1280" data-height="720">ask 1280 x 720</option>','<option data-width="800" data-height="600">ask 800 x 600</option>','<option data-width="640" data-height="480">ask 640 x 480</option>','<option data-width="640" data-height="360">ask 640 x 360</option>',"</select>",'<button class="kPainterBtnGrabVideo"><svg width="48" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1024 672q119 0 203.5 84.5t84.5 203.5-84.5 203.5-203.5 84.5-203.5-84.5-84.5-203.5 84.5-203.5 203.5-84.5zm704-416q106 0 181 75t75 181v896q0 106-75 181t-181 75h-1408q-106 0-181-75t-75-181v-896q0-106 75-181t181-75h224l51-136q19-49 69.5-84.5t103.5-35.5h512q53 0 103.5 35.5t69.5 84.5l51 136h224zm-704 1152q185 0 316.5-131.5t131.5-316.5-131.5-316.5-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5z"/></svg></button>','<button class="kPainterBtnCloseVideo"><svg width="48" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z"/></svg></button>',"</div>"].join(""),t.videoSettings=e.videoSettings,t.viewer=e.viewer,t.beforeAddImgFromGrabVideoBtn=null,t.afterAddImgFromGrabVideoBtn=null,t.videoClosed=!0}r.prototype.__Init=function(){var e=this;function t(){e.playVideo(e.cameraSel.value).then(function(){e.videoClosed||e.stopVideo()}).catch(function(e){alert("Play video failed: "+(e.message||e))})}function r(){return e.playVideo().then(function(){e.videoClosed||e.stopVideo()}).catch(function(e){alert("Play video failed: "+(e.message||e))}),!0}function n(){return e.grabVideo(!0),e.hideVideo(),!0}function o(){e.stopVideo(),e.videoClosed=!0,e.optGotRsl.removeAttribute("data-width"),e.cameraSel&&i.removeEvent(e.cameraSel,"change",t),e.resolutionSel&&i.removeEvent(e.resolutionSel,"change",r),e.btnGrab&&i.removeEvent(e.btnGrab,"click",n),e.btnClose&&i.removeEvent(e.btnClose,"click",o),document.body.removeChild(e.videoWrapper)}e.videoWrapper=document.getElementById("videoWrapper"),e.video=i._querySelectorAll(e.videoWrapper,".kPainterVideo")[0],e.cameraSel=i._querySelectorAll(e.videoWrapper,".kPainterCameraSelect")[0],e.resolutionSel=i._querySelectorAll(e.videoWrapper,".kPainterResolutionSelect")[0],e.optGotRsl=i._querySelectorAll(e.videoWrapper,".kPainterGotResolutionOpt")[0],e.btnGrab=i._querySelectorAll(e.videoWrapper,".kPainterBtnGrabVideo")[0],e.btnClose=i._querySelectorAll(e.videoWrapper,".kPainterBtnCloseVideo")[0],e.cameraSel&&i.addEvent(e.cameraSel,"change",t),e.resolutionSel&&i.addEvent(e.resolutionSel,"change",r),e.btnGrab&&i.addEvent(e.btnGrab,"click",n),e.hideVideo=o,e.btnClose&&i.addEvent(e.btnClose,"click",o)},r.prototype.updateDevice=function(){var e=this;return e.cameraSel?navigator.mediaDevices.enumerateDevices().then(t=>{var i=e.cameraSel.value;e.cameraSel.innerHTML="";var r=void 0;window.console.log(t,"deviceInfos");for(var n=0;n<t.length;++n){var o=t[n];if("videoinput"==o.kind){var a=document.createElement("option");a.value=o.deviceId,a.innerText=o.label||"camera "+n,e.cameraSel.appendChild(a),i==o.deviceId&&(r=a)}}var s=e.cameraSel.childNodes;if(!r&&s.length)try{e.video.srcObject.getTracks().forEach(e=>{if("video"==e.kind)for(var t=0;t<s.length;++t){var i=s[t];if(e.label==i.innerText)throw r=i,"found the using source"}})}catch(l){console.log(l)}r&&(e.cameraSel.value=r.value)}):Promise.reject("no camera select")},r.prototype.stopVideo=function(){var e=this;return e.video.srcObject&&e.video.srcObject.getTracks().forEach(function(e){e.stop()}),!0},r.prototype.playVideo=function(e){var t=this;return new Promise((i,r)=>{t.stopVideo();var n=t.videoSettings?t.videoSettings:t.viewer.videoSettings,o=t.resolutionSel?t.resolutionSel.children[t.resolutionSel.selectedIndex]:null;if(o&&o.hasAttribute("data-width")){var a=o.getAttribute("data-width"),s=o.getAttribute("data-height");t.optGotRsl.setAttribute("data-width",a),t.optGotRsl.setAttribute("data-height",s);var l=/Safari/.test(navigator.userAgent)&&/iPhone/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);if(l?a>=1280?n.video.width=1280:a>=640?n.video.width=640:a>=320&&(n.video.width=320):(n.video.width={ideal:a},n.video.height={ideal:s}),!e){var d=t.cameraSel.children[t.cameraSel.selectedIndex];d&&(e=d.value)}e&&(n.video.facingMode=void 0,n.video.deviceId={exact:e})}var h=!1,u=()=>{navigator.mediaDevices.getUserMedia(n).then(e=>{return new Promise((i,r)=>{t.video.srcObject=e,t.video.onloadedmetadata=()=>{t.video.play().then(()=>{var e=t.video.videoWidth+"x"+t.video.videoHeight;t.optGotRsl&&(t.optGotRsl.innerText=e),t.resolutionSel&&(t.resolutionSel.value="got"),i()},e=>{r(e)})},t.video.onerror=()=>{r()}})}).then(()=>{i()}).catch(e=>{h?r(e):(h=!0,n.video.width=void 0,n.video.height=void 0,u())})};u()})},r.prototype.grabVideo=function(e){var t=this;if(!t.videoClosed){var i=document.createElement("canvas");i.width=t.video.videoWidth,i.height=t.video.videoHeight;var r=i.getContext("2d");return r.drawImage(t.video,0,0),e?t.viewer.LoadImageEx(i):i}},r.prototype.showVideo=function(){var e=this;if(e.videoClosed){e.videoClosed=!1;var t=document.createElement("div");return t.setAttribute("id","videoWrapper"),t.innerHTML=e.videoHtmlElement,document.body.appendChild(t),e.__Init(),e.playVideo().then(function(){return e.videoClosed?(e.stopVideo(),Promise.reject("Video window has closed.")):(e.updateDevice().catch(function(e){console.log(e)}),Promise.resolve())})}},t.VideoViewer=r}(s.MBC.Lib,s.MBC),function(e,t){var i=e;function r(e){var t=this,r=['<div class="kPainterCroper" style="display:none;">','<div class="kPainterCells">',"<div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>","</div",'><div class="kPainterBigMover" data-orient="0,0" style="display:none"></div','><div class="kPainterEdges">','<div data-orient="1"></div','><div data-orient="2"></div','><div data-orient="3"></div','><div data-orient="4"></div>',"</div",'><div class="kPainterCorners">','<div data-orient="5"><i></i></div','><div data-orient="6"><i></i></div','><div data-orient="7"><i></i></div','><div data-orient="8"><i></i></div>',"</div>","</div",'><div class="kPainterPerspect" style="display:none;">','<canvas class="kPainterPerspectCvs"></canvas','><div class="kPainterPerspectCorner" data-index="0">lt</div','><div class="kPainterPerspectCorner" data-index="1">rt</div','><div class="kPainterPerspectCorner" data-index="2">rb</div','><div class="kPainterPerspectCorner" data-index="3">lb</div>',"</div",'><div class="kPainterGesturePanel"></div>'].join("");t.viewer=e.viewer,t.container=e.container,t.container.insertAdjacentHTML("beforeEnd",r),t.kPainterCroper=i._querySelectorAll(t.container,"div.kPainterCroper")[0],t.kPainterCells=i._querySelectorAll(t.container,"div.kPainterCells > div"),t.kPainterCorners=i._querySelectorAll(t.container,"div.kPainterCorners > div"),t.kPainterEdges=i._querySelectorAll(t.container,"div.kPainterEdges > div"),t.bVisible=!1,t.isAutoShowCropUI=!0,t.isCropRectShowing=!1,t.dragging=!1,t.maxWidth=0,t.maxHeight=0,t.minWidth=50,t.minHeight=50,t.minTop=0,t.minLeft=0,t.top=0,t.left=0,t.borderColor="red",t.backgroundColor="rgba(255,0,0,0.2)",t._startPos={targetNode:-1,startX:0,startY:0,width:0,height:0,left:0,top:0},t.drawArea={x:0,y:0,width:0,height:0},t.cropArea=null,t.__Init()}r.prototype.__Init=function(){for(var e=this,t=0;t<4;t++)i.addEvent([e.kPainterCorners[t],e.kPainterEdges[t]],"mousedown touchstart",r);function r(t){var r=t||window.event;i.stopDefault(r),e.dragging=!0,i.addEvent(e.container,"mousemove touchmove",n),i.addEvent(e.container,"mouseleave mouseup touchend",o);var a,s,l=r.changedTouches;if(l){if(1!=l.length)return!1;a=l[0].pageX,s=l[0].pageY}else a=r.clientX,s=r.clientY;e._startPos={targetNode:parseInt(this.getAttribute("data-orient")),startX:a,startY:s,width:e.drawArea.width,height:e.drawArea.height,left:e.drawArea.x,top:e.drawArea.y}}function n(t){var r=t||window.event;if(i.stopDefault(r),e.dragging){var n,o,a,s,l=r.changedTouches,d=e._startPos;if(l)var h=l[0].pageX-d.startX,u=l[0].pageY-d.startY;else h=r.clientX-d.startX,u=r.clientY-d.startY;switch(d.targetNode){case 1:n=d.width-h>d.left+d.width?d.left+d.width:d.width-h<e.minWidth?e.minWidth:d.width-h,o=d.height,a=d.left+d.width-n,s=d.top;break;case 2:n=d.width,o=d.height-u>d.top+d.height?d.top+d.height:d.height-u<e.minHeight?e.minHeight:d.height-u,a=d.left,s=d.top+d.height-o;break;case 3:n=d.width+h>e.maxWidth-d.left?e.maxWidth-d.left:d.width+h<e.minWidth?e.minWidth:d.width+h,o=d.height,a=d.left,s=d.top;break;case 4:n=d.width,o=d.height+u>e.maxHeight-d.top?e.maxHeight-d.top:d.height+u<e.minHeight?e.minHeight:d.height+u,a=d.left,s=d.top;break;case 5:n=d.width-h>d.left+d.width?d.left+d.width:d.width-h<e.minWidth?e.minWidth:d.width-h,o=d.height-u>d.top+d.height?d.top+d.height:d.height-u<e.minHeight?e.minHeight:d.height-u,a=d.left+d.width-n,s=d.top+d.height-o;break;case 6:n=d.width+h>e.maxWidth-d.left?e.maxWidth-d.left:d.width+h<e.minWidth?e.minWidth:d.width+h,o=d.height-u>d.top+d.height?d.top+d.height:d.height-u<e.minHeight?e.minHeight:d.height-u,a=d.left,s=d.top+d.height-o;break;case 7:n=d.width+h>e.maxWidth-d.left?e.maxWidth-d.left:d.width+h<e.minWidth?e.minWidth:d.width+h,o=d.height+u>e.maxHeight-d.top?e.maxHeight-d.top:d.height+u<e.minHeight?e.minHeight:d.height+u,a=d.left,s=d.top;break;case 8:n=d.width-h>d.left+d.width?d.left+d.width:d.width-h<e.minWidth?e.minWidth:d.width-h,o=d.height+u>e.maxHeight-d.top?e.maxHeight-d.top:d.height+u<e.minHeight?e.minHeight:d.height+u,a=d.left+d.width-n,s=d.top;break;default:return}e.__updateDrawArea(n,o,a,s)}}function o(t){var r=t||window.event;i.stopDefault(r),e.dragging&&(e.dragging=!1,i.removeEvent(e.container,"mousemove touchmove",n),i.removeEvent(e.container,"mouseleave mouseup touchend",o))}},r.prototype.SetVisible=function(e){var t=this;return e?(t.bVisible=!0,t.kPainterCroper.style.display=""):(t.bVisible=!1,t.kPainterCroper.style.display="none"),!0},r.prototype.ShowCropRect=function(){var e=this;if("edit"==e.viewer.mode)return e.isCropRectShowing=!0,e.SetVisible(!0),e.viewer.isSwitchedWH?(e.maxWidth=e.viewer._canvasArea.height,e.maxHeight=e.viewer._canvasArea.width):(e.maxWidth=e.viewer._canvasArea.width,e.maxHeight=e.viewer._canvasArea.height),e.minLeft=(e.viewer._imgContainerW-e.maxWidth)/2,e.minTop=(e.viewer._imgContainerH-e.maxHeight)/2,e.__updateDrawArea(e.maxWidth,e.maxHeight,0,0),!0},r.prototype.HideCropRect=function(){var e=this;return e.isCropRectShowing=!1,e.SetVisible(!1),!0},r.prototype.__updateDrawArea=function(e,t,i,r){var n=this;n.drawArea.width=e,n.drawArea.height=t,n.drawArea.x=i,n.drawArea.y=r,n.__updatePosition(e,t,i+n.minLeft,r+n.minTop)},r.prototype.__updatePosition=function(e,t,i,r){var n=this;return n.left=i,n.top=r,n.kPainterCroper.style.width=e+"px",n.kPainterCroper.style.height=t+"px",n.kPainterCroper.style.left=n.left+"px",n.kPainterCroper.style.top=n.top+"px",!0},r.prototype.__getCropArea=function(){var e,t=this,i=t.drawArea.x/t.maxWidth,r=t.drawArea.y/t.maxHeight,n=t.drawArea.width/t.maxWidth,o=t.drawArea.height/t.maxHeight;return e={x:i,y:r,width:n,height:o},t.cropArea=e,e},t.ImageAreaSelector=r}(s.MBC.Lib,s.MBC),function(e,t){var i=e;function r(e){var t=this;t.containerWidth=0,t.containerHeight=0,t.controlWidth=0,t.controlHeight=0,t._origImageWidth=-1,t._origImageHeight=-1,t._width=0,t._height=0,t.Left=0,t.Top=0,t.objImage=!1,t.imageUrl=null,t.cIndex=-1,t.bVisible=!0,t.viewer=null,t.__init(e)}r.prototype.__init=function(e){var t=this;t.viewer=e.viewer,t.controlWidth=t.containerWidth=e.imgContainerW,t.controlHeight=t.containerHeight=e.imgContainerH,t.imageUrl=e.imageUrl,t.cIndex=e.index,t.divOut=document.createElement("div"),t.divOut.style.display="inline-block",t.divOut.style.position="absolute",t.divOut.style.top=t.Top+"px",t.divOut.style.left=t.Left+"px",t.divOut.style.width=t.controlWidth+"px",t.divOut.style.height=t.controlHeight+"px",t.__getImageByUrl()},r.prototype.SetVisible=function(e){var t=this;if(-1!=t.cIndex)return t.bVisible=e,t.bVisible?t.divOut.style.display="":t.divOut.style.display="none",!0},r.prototype.ChangeControlSize=function(e,t){var i=this;return i.containerWidth=i.viewer._imgsDivW,i.containerHeight=i.viewer._imgsDivH,i.controlWidth=e,i.controlHeight=t,i.divOut.style.width=i.controlWidth+"px",i.divOut.style.height=i.controlHeight+"px",i.Left=(i.containerWidth-i.controlWidth)/2,i.Top=(i.containerHeight-i.controlHeight)/2,i.cIndex==i.viewer.GetCurentIndex()&&i.SetLocation(i.Left,i.Top),i.Show(),!0},r.prototype.SetLocation=function(e,t){var i=this;return 0==arguments.length&&(i.Left=(i.containerWidth-i.controlWidth)/2,i.Top=(i.containerHeight-i.controlHeight)/2),1==arguments.length&&(i.Left=e),arguments.length>1&&(i.Left=e,i.Top=t),i.divOut&&(i.divOut.parentNode&&(i.divOut.parentNode.style.position="relative"),i.divOut.style.position="absolute",i.divOut.style.left=i.Left+"px",i.divOut.style.top=i.Top+"px"),!0},r.prototype.GetEL=function(){return this.divOut},r.prototype.GetIndex=function(){return this.cIndex},r.prototype.SetIndex=function(e){var t=this;return i.isNumber(e)&&e>=0?t.cIndex=e:t.cIndex=-1,!0},r.prototype.ClearImage=function(){var e=this;return e.objImage=!1,e._origImageWidth=-1,e._origImageHeight=-1,!0},r.prototype.Show=function(){var e=this;if(-1!=e.cIndex)return e.__fitImage(),!0},r.prototype.Destroy=function(){var e=this;return e.ClearImage(),!0},r.prototype.Refresh=function(){var e=this;return e.__getImageByUrl(),!0},r.prototype.__fitImage=function(){var e=this;if(e.objImage){var t,i,r=e.controlWidth/e.controlHeight,n=e._origImageWidth/e._origImageHeight;r>n?(e._height=e.controlHeight,e._width=n*e.controlHeight,t=Math.floor((e.controlWidth-e._width)/2),i=0):(e._width=e.controlWidth,e._height=e.controlWidth/n,t=0,i=Math.floor((e.controlHeight-e._height)/2)),e.objImage.style.position="absolute",e.objImage.style.left=t+"px",e.objImage.style.top=i+"px",e.objImage.style.width=e._width+"px",e.objImage.style.height=e._height+"px"}},r.prototype.__getImageByUrl=function(){var e=this,t=new Image;return t.className="aryImages-item",t.setAttribute("alt","image"),t.src=e.imageUrl,t.onload=function(){e.objImage=t,e._origImageWidth=t.width,e._origImageHeight=t.height,e.divOut.innerHTML="",e.divOut.appendChild(e.objImage),e.Show(),e.SetVisible(!0)},t.onerror=function(e){},!0},t.ImageControl=r}(s.MBC.Lib,s.MBC),function(e,t){var i=e;function r(e){var t=this;t._width=0,t._height=0,t.Left=0,t.Top=0,t._origImageWidth=0,t._origImageHeight=0,t.canvasWidth=0,t.canvasHeight=0,t.borderWidth=1,t.borderColor="#DDDDDD",t.selectionBorderColor="#7DA2CE",t.backgroundColor="#FFFFFF",t.bSelect=!1,t.cIndex=-1,t.drawArea={width:t.canvasWidth,height:t.canvasHeight,x:0,y:0},t.canvasBackgroundGradientColorPairs={NotSelectedHovering:["rgb(250,252,253)","rgb(239,246,253)"],Selected:["rgb(221,234,252)","rgb(199,222,252)"]},t.bVisible=!0,t.thumbOut=!1,t.thumbCanvas=!1,t.viewer=null,t.thumbnailImagesPerRow=3,t.attachImage=!1,t.__init(e)}r.prototype.__init=function(e){var t=this,r=window.document;t.viewer=e.viewer,t.Top=t.viewer.ThumbnailImageMargin,t.Left=t.viewer.ThumbnailImageMargin,t.thumbnailImagesPerRow=t.viewer.thumbnailImagesPerRow>2?t.viewer.thumbnailImagesPerRow:3,t._width=t.viewer.ThumbnailControlW,t._height=t.viewer.ThumbnailControlH,t.canvasWidth=t._width,t.canvasHeight=t._height,t.imageUrl=e.imageUrl,t.cIndex=e.index,t.thumbOut=r.createElement("div"),t.thumbOut.style.display="inline-block",t.thumbOut.style.width=t._width+2+"px",t.thumbOut.style.height=t._height+2+"px",t.thumbOut.style.position="absolute",t.thumbOut.style.top=t.Top+"px",t.thumbOut.style.left=t.Left+"px",t.thumbOut.style.border=t.borderWidth+"px solid "+t.borderColor,t.thumbOut.style.cursor="pointer",t.thumbCanvas=r.createElement("canvas"),t.thumbCanvas.style.position="relative",t.thumbCanvas.style.top="0px",t.thumbCanvas.width=t.canvasWidth,t.thumbCanvas.height=t.canvasHeight,t.thumbOut.appendChild(t.thumbCanvas),i.addEvent(t.thumbOut,"click",function(){t.viewer.ShowImage(t.cIndex)}),i.addEvent(t.thumbOut,"mouseenter",function(){t.bMouseHovering=!0,t.bSelect||t.Show()}),i.addEvent(t.thumbOut,"mouseout",function(){t.bMouseHovering=!1,t.bSelect||t.Show()}),t.__getImageByUrl()},r.prototype.SetVisible=function(e){var t=this;return t.bVisible=e,e?(t.thumbOut.style.display="",t.Show()):t.thumbOut.style.display="none",!0},r.prototype.ChangeControlSize=function(e,t){var i=this;return i._width=e,i._height=t,i.canvasWidth=e,i.canvasHeight=t,i.thumbOut.style.width=i._width+2+"px",i.thumbOut.style.height=i._height+2+"px",i.Show(),!0},r.prototype.SetBackgroundColor=function(e){var t=this;return t.backgroundColor=e,t.Show(),!0},r.prototype.SetLocation=function(e,t){var i=this;return i.Left=e,i.Top=t,i.thumbOut&&(i.thumbOut.parentNode&&(i.thumbOut.parentNode.style.position="relative"),i.thumbOut.style.left=e+"px",i.thumbOut.style.top=t+"px"),!0},r.prototype.SetSelectionImageBorderColor=function(e){var t=this;return t.selectionBorderColor=e,t.__refreshBorder(),!0},r.prototype.GetEL=function(){return this.thumbOut},r.prototype.GetControlWidth=function(){return this._width},r.prototype.GetControlHeight=function(){return this._height},r.prototype.SetIndex=function(e){var t=this;return i.isNumber(e)&&e>=0?t.cIndex=e:t.cIndex=-1,!0},r.prototype.ClearImage=function(){var e=this;return e.objImage=!1,e._origImageWidth=-1,e._origImageHeight=-1,!0},r.prototype.Show=function(e){var t,i=this;if(i.bVisible){if(i.thumbOut.style.display="inline-block",t=i.thumbCanvas.getContext("2d"),i.__restoreCanvas(t,i.canvasWidth,i.canvasHeight),t.clearRect(0,0,i.canvasWidth,i.canvasHeight),!i.objImage||"data:,"==i.objImage.src||0==i.objImage.width||0==i.objImage.height||""==i.objImage.src)return t.fillStyle=i.backgroundColor,t.fillRect(0,0,t.canvas.width,t.canvas.height),i._width>53&&(t.font="12px Times New Roman",t.textAlign="center",t.strokeText("Loading...",.5*t.canvas.width,.5*t.canvas.height)),!1;if(-1!=i.cIndex){if(i.__fitImage(),i.drawArea.width<i.canvasWidth||i.drawArea.height<i.canvasHeight){var r=t.createLinearGradient(0,0,i.canvasWidth,i.canvasHeight);i.bSelect?(r.addColorStop(0,i.canvasBackgroundGradientColorPairs.Selected[0]),r.addColorStop(1,i.canvasBackgroundGradientColorPairs.Selected[1]),t.fillStyle=r):i.bMouseHovering?(r.addColorStop(0,i.canvasBackgroundGradientColorPairs.NotSelectedHovering[0]),r.addColorStop(1,i.canvasBackgroundGradientColorPairs.NotSelectedHovering[1]),t.fillStyle=r):t.fillStyle=i.backgroundColor,t.fillRect(0,0,i.canvasWidth,i.canvasHeight)}return i.objImage&&(i.attachImage?(i.thumbOut.style.position="relative",i.objImage.style.position="absolute",i.objImage.style.top=Math.floor(i.drawArea.y)+"px",i.objImage.style.left=Math.floor(i.drawArea.x)+"px",i.thumbOut.appendChild(i.objImage)):t.drawImage(i.objImage,Math.floor(i.drawArea.x),Math.floor(i.drawArea.y),i.drawArea.width,i.drawArea.height)),!0}}else i.thumbOut.style.display="none"},r.prototype.SetSelect=function(e){var t=this;return t.bSelect=e,t.__refreshBorder(),t.Show(),!0},r.prototype.Destroy=function(){var e=this;if(e.thumbCanvas){var t=e.thumbCanvas.getContext("2d");e.canvasWidth>0&&e.canvasHeight>0&&t.clearRect(0,0,e.canvasWidth,e.canvasHeight)}return e.ClearImage(),!0},r.prototype.Refresh=function(){var e=this;return e.__getImageByUrl(),!0},r.prototype.ClearControl=function(){var e=this;return e.ClearImage(),e.Show(),!0},r.prototype.__fitImage=function(){var e=this,t=e.canvasWidth/e.canvasHeight,i=e._origImageWidth/e._origImageHeight;t>i?(e.drawArea.height=e.canvasHeight,e.drawArea.width=i*e.canvasHeight,e.drawArea.x=Math.floor((e.canvasWidth-e.drawArea.width)/2),e.drawArea.y=0):(e.drawArea.width=e.canvasWidth,e.drawArea.height=e.drawArea.width/i,e.drawArea.x=0,e.drawArea.y=Math.floor((e.canvasHeight-e.drawArea.height)/2))},r.prototype.__getImageByUrl=function(){var e=this,t=new Image;return t.className="aryThumbnailControls-item",t.setAttribute("alt","image"),t.src=e.imageUrl,t.onload=function(){e.objImage=t,e._origImageWidth=t.width,e._origImageHeight=t.height,e.Show()},t.onerror=function(e){},!0},r.prototype.__restoreCanvas=function(e,t,i){return e.canvas.width=t,e.canvas.height=i,!0},r.prototype.__refreshBorder=function(){var e=this;return e.bSelect?(e.thumbOut.style.border=e.borderWidth+"px solid "+e.selectionBorderColor,e.thumbOut.style.cursor="default"):(e.thumbOut.style.border=e.borderWidth+"px solid "+e.borderColor,e.thumbOut.style.cursor="pointer"),!0},t.ThumbnailControl=r}(s.MBC.Lib,s.MBC),function(e,t){var i=e;function r(e){var r=this,n=['<div class="imageContainer">','<div class="kPainterImgsDiv">','<canvas class="kPainterCanvas" style="display:none;position:absolute;"></canvas>',"</div>","</div>",'<div class="thumbnailContainer"></div>'].join("");function o(e){var t=e||window.event;if("view"==r.mode){i.stopDefault(t),i.addEvent(r._imgContainer,"mousemove",a),i.addEvent(r._imgContainer,"mouseleave",s);var n=t.changedTouches;if(n){if(1!=n.length)return!1;r._startPos={startX:n[0].pageX,startY:n[0].pageY}}else r._startPos={startX:t.clientX,startY:t.clientY}}}function a(e){var t=e||window.event;if("view"==r.mode){if(i.stopDefault(t),r.GetCount()<2)return!1;var n=t.changedTouches;if(n){var o=n[0].pageX-r._startPos.startX;n[0].pageY,r._startPos.startY}else o=t.clientX-r._startPos.startX,t.clientY,r._startPos.startY;var a=r.aryImageControls,s=r.curIndex,l=s-1<0?a.length-1:s-1,d=s+1>a.length-1?0:s+1;a[s].SetLocation((r._imgsDivW-a[s].controlWidth)/2+o),a[l].SetLocation(-(r._imgContainerW-o)),a[d].SetLocation(r._imgContainerW+o)}}function s(e){var t=e||window.event;if("view"==r.mode){if(i.stopDefault(t),r.GetCount()<1)return!1;if(i.removeEvent(r._imgContainer,"mousemove",a),i.removeEvent(r._imgContainer,"mouseleave",s),r.GetCount()<2)return!1;var n=t.changedTouches;if(n){var o=n[0].pageX-r._startPos.startX;n[0].pageY,r._startPos.startY}else o=t.clientX-r._startPos.startX,t.clientY,r._startPos.startY;o>r._imgsDivW/3?r.ChangePage("p"):o<-r._imgsDivW/3?r.ChangePage("n"):r.__reInitImageControlPosition()}}r._imageViewer=document.getElementById(e.ContainerId),r._imageViewer.innerHTML=n,r._canvas=i._querySelectorAll(r._imageViewer,"canvas.kPainterCanvas")[0],r.ctx=r._canvas.getContext("2d"),r._imgContainer=i._querySelectorAll(r._imageViewer,"div.imageContainer")[0],r._imgsDiv=i._querySelectorAll(r._imageViewer,"div.kPainterImgsDiv")[0],r._thumbnailContainer=i._querySelectorAll(r._imageViewer,"div.thumbnailContainer")[0],e.Width&&(r._imageViewerW=e.Width),e.Height&&(r._imageViewerH=e.Height),r._imageViewer.style.width=r._imageViewerW,r._imageViewer.style.height=r._imageViewerH,r._defaultFileInput=document.createElement("input"),r._defaultFileInput.setAttribute("type","file"),r._defaultFileInput.setAttribute("accept","image/bmp,image/gif,image/jpeg,image/png,image/webp"),r._defaultFileInput.setAttribute("multiple","true"),r.curIndex=-1,r.mode="view",r._errorCode=0,r._errorString="",r.aryImageControls=[],r.BackgroundColor="#FFFFFF",r.aryThumbnailControls=[],r.ThumbnailImageMargin=10,r.ThumbnailControlW=0,r.ThumbnailBackgroundColor="#FFFFFF",r.ThumbnailControlH=0,r._thumbnailsDiv=document.createElement("div"),r._thumbnailsDiv.style.width=r._thumbnailContainerW+"px",r._thumbnailContainer.appendChild(r._thumbnailsDiv),i.addEvent(r._defaultFileInput,"change",function(e){var t=e||window.event;r.beforeAddImgFromFileChooseWindow?i.doCallbackNoBreak(r.beforeAddImgFromFileChooseWindow,[t,!1]):r.LoadImageEx(t.target.files)}),i.addEvent(r._imageViewer,"dragover",function(e){var t=e||window.event;i.stopDefault(t)}),i.addEvent(r._imageViewer,"drop",function(e){var t=e||window.event;"view"==r.mode&&(i.stopDefault(t),r.LoadImageEx(t.dataTransfer.files))}),r._startPos={},i.addEvent(r._imgContainer,"touchstart mousedown",o),i.addEvent(r._imgContainer,"touchmove",a),i.addEvent(r._imgContainer,"touchend mouseup",s),r.stack=[],r.curStep=-1,r.isSwitchedWH=!1,r.replaceOriginalImage=!1,r._canvasArea={width:300,height:150,left:0,top:0},r.videoSettings={video:{facingMode:{ideal:"environment"}}};e={};e.viewer=r,e.videoSettings=r.videoSettings,e.container=r._imgContainer,r.VideoViewer=new t.VideoViewer(e),r.ImageAreaSelector=new t.ImageAreaSelector(e),i.attachProperty(r),r.__init()}r.prototype.beforeAddImgFromFileChooseWindow=null,r.prototype.afterAddImgFromFileChooseWindow=null,r.prototype.beforeAddImgFromDropFile=null,r.prototype.afterAddImgFromDropFile=null,r.prototype.__init=function(){var e=this;e._imageViewerW=i.getElDimensions(e._imageViewer).clientWidth,e._imageViewerH=i.getElDimensions(e._imageViewer).clientHeight,e._imgContainerW=i.getElDimensions(e._imgContainer).clientWidth,e._imgContainerH=i.getElDimensions(e._imgContainer).clientHeight,e._imgsDivW=i.getElDimensions(e._imgsDiv).clientWidth,e._imgsDivH=i.getElDimensions(e._imgsDiv).clientHeight,e._thumbnailContainerW=i.getElDimensions(e._thumbnailContainer).clientWidth,e._thumbnailContainerH=i.getElDimensions(e._thumbnailContainer).clientHeight,e.thumbnailImagesPerRow=Math.floor(e._thumbnailContainerH/e._thumbnailContainerW)>2?Math.floor(e._thumbnailContainerH/e._thumbnailContainerW):3,e._thumbnailsDiv.style.height=e._thumbnailContainerH+"px"},r.prototype.AdaptiveLayout=function(){var e=this;e.__init();for(var t=e.aryImageControls,i=0;i<t.length;i++){var r=t[i].controlWidth,n=t[i].controlHeight;r<e._imgsDivW&&n<e._imgsDivH?t[i].ChangeControlSize(r,n):t[i].ChangeControlSize(e._imgsDivW,e._imgsDivH)}return e.__reInitThumbnailControlPosition(),"edit"==e.mode&&e.__setCanvasStyleFit(),!0},r.prototype.LoadImageEx=function(e){var t=this;if("edit"==t.mode)return i.Errors.FucNotValidInThisMode(t,"LoadImageEx","edit"),!1;if(0!=arguments.length){if(!(e instanceof Blob||e instanceof HTMLCanvasElement||"string"==typeof e||e instanceof String||e instanceof HTMLImageElement)){if(e instanceof Array||e instanceof FileList){for(var r=0;r<e.length;++r)t.LoadImageEx(e[r]);return}return i.Errors.InvalidParameterType(t),!1}i.getBlobFromAnyImgData(e,function(e){t.LoadImageInner(e)})}else t.ShowFileChooseWindow()},r.prototype.LoadImageInner=function(e){var r=this,n={};n.viewer=r,n.imageViewerW=r._imageViewerW,n.imageViewerH=r._imageViewerH,n.imgContainerW=r._imgsDivW,n.imgContainerH=r._imgsDivH,n.index=r.curIndex=r.aryImageControls.length,e instanceof Blob?n.imageUrl=URL.createObjectURL(e):n.imageUrl=e;var o=new t.ImageControl(n);r.aryImageControls.push(o),r.__addImgToContainer(o.GetEL());var a=new t.ThumbnailControl(n);return r.aryThumbnailControls.push(a),r.__addImgToThumbnail(a.GetEL()),r.__resetSelection(),r._updateNumUI(),i.Errors.Sucess(r),!0},r.prototype.ShowVideo=function(){return this.VideoViewer.showVideo(),!0},r.prototype.ShowImage=function(e){var t=this;return e<0||e>t.aryImageControls.length-1?(i.Errors.InvalidValue(t),!1):(t.curIndex=e,t.__reInitImageControlPosition(),t.__resetSelection(),t._updateNumUI(),i.Errors.Sucess(t),!0)},r.prototype.ChangePage=function(e){var t,i=this;switch(e){case"f":t=0;break;case"p":t=i.curIndex-1;break;case"n":t=i.curIndex+1;break;case"l":t=i.aryImageControls.length-1;break;default:if(arguments.length<1||isNaN(e))return!1;t=Math.round(e)}return t<0?t=i.aryImageControls.length-1:t>i.aryImageControls.length-1&&(t=0),i.ShowImage(t),!0},r.prototype.GetCurentIndex=function(){return this.curIndex},r.prototype.GetCount=function(){return this.aryImageControls.length},r.prototype.GetImage=function(e,t){var i=e||this.curIndex;return t?this.aryImageControls[i]:this.aryImageControls[i].cloneNode(!0)},i.each(["SaveAsBMP","SaveAsJPEG","SaveAsTIFF","SaveAsPNG","SaveAsPDF"],function(e){r.prototype[e]=function(t,r){var n=this;if("edit"==n.mode)return i.Errors.FucNotValidInThisMode(n,e,"edit"),!1;if(arguments.length<2&&(r=n.curIndex),!i.isNumber(r))return!1;if(r=Math.round(r),r<0||r>=n.aryImageControls.length)return!1;var o=document.createElement("a");o.target="_blank";var a=n.aryImageControls[r].objImage,s=a.src;t||(t=(new Date).getTime()+".png"),o.download=t;var l=s;o.href=l;var d=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});return o.dispatchEvent(d),setTimeout(function(){URL.revokeObjectURL(l)},1e4),t}}),r.prototype.ShowFileChooseWindow=function(){var e=this;return"edit"==e.mode?(i.Errors.FucNotValidInThisMode(e,"ShowFileChooseWindow","edit"),!1):(e._defaultFileInput.click(),!0)},r.prototype.GetBackgroundColor=function(e){return this.BackgroundColor},r.prototype.SetBackgroundColor=function(e){var t=this;return t.BackgroundColor=e,t._imgContainer&&(t._imgContainer.style.backgroundColor=e),i.Errors.Sucess(t),!0},r.prototype.SetCropBackgroundColor=function(e){var t=this,r=t.ImageAreaSelector.kPainterCells;t.ImageAreaSelector.backgroundColor=e;for(var n=0;n<r.length;n++)r[n].style.backgroundColor=e;return i.Errors.Sucess(t),!0},r.prototype.SetCropBorderColor=function(e){var t=this,r=t.ImageAreaSelector.kPainterCells,n=t.ImageAreaSelector.kPainterCorners;t.ImageAreaSelector.borderColor=e;for(var o=0;o<r.length;o++)r[o].style.borderColor=e;for(o=0;o<n.length;o++)n[o].style.borderColor=e;return i.Errors.Sucess(t),!0},r.prototype.GetThumbnaiBackgroundColor=function(e){return this.ThumbnailBackgroundColor},r.prototype.SetThumbnailBackgroundColor=function(e){var t=this;t.ThumbnailBackgroundColor=e,t._thumbnailContainer&&(t._thumbnailContainer.style.backgroundColor=e);for(var r=0;r<t.aryThumbnailControls.length;r++)t.aryThumbnailControls[r].SetBackgroundColor(t.ThumbnailBackgroundColor);return i.Errors.Sucess(t),!0},r.prototype.GetThumbnailImageMargin=function(){var e=this;return e.ThumbnailImageMargin},r.prototype.SetThumbnailImageMargin=function(e){var t=this;return e<=0||e>t._thumbnailContainerH/t.thumbnailImagesPerRow||e>t._thumbnailContainerW?(i.Errors.InvalidValue(t),!1):(t.ThumbnailImageMargin=parseInt(e),t.__reInitThumbnailControlPosition(),i.Errors.Sucess(t),!0)},r.prototype.ShowImageEditor=function(){var e=this;if("edit"==e.mode)return i.Errors.FucNotValidInThisMode(e,"ShowImageEditor","edit"),!1;if(e.curIndex<0)return i.Errors.IndexOutOfRange(e),!1;e.mode="edit";var t=e.aryImageControls[e.curIndex];t.SetVisible(!1),e.__setCanvasVisible(!0),e.ctx.clearRect(0,0,e._canvasArea.width,e._canvasArea.height),e._canvasArea={width:300,height:150,left:0,top:0};var r=new H.Matrix(1,0,0,1,0,0);o(e._canvas).setTransform(r);var n={fun:"ShowImageEditor",crop:{x:0,y:0,width:1,height:1},draw:{x:0,y:0,width:t._origImageWidth,height:t._origImageHeight},transform:new H.Matrix(1,0,0,1,0,0),srcBlob:t.imageUrl};return e.stack.push(n),e.curStep++,e.__updateCanvasInner(!1),i.Errors.Sucess(e),!0},r.prototype.CloseImageEditor=function(e){var t=this;if("view"==t.mode)return i.Errors.FucNotValidInThisMode(t,"CloseImageEditor","view"),!1;t.mode="view";var r=0!=e;return t.__setCanvasVisible(!1),t.aryImageControls[t.curIndex].SetVisible(r),t.stack=[],t.curStep=-1,t.isSwitchedWH=!1,t.ImageAreaSelector.HideCropRect(),i.Errors.Sucess(t),!0},r.prototype.RotateLeft=function(){var e=this;if("edit"!=e.mode)return i.Errors.FucNotValidInThisMode(e,"RotateLeft","view"),!1;var t=o(e._canvas).getTransform(),r=H.Matrix.dot(new H.Matrix(0,-1,1,0,0,0),t);return o(e._canvas).setTransform(r),e.__pushStack("rotateLeft"),e.__setCanvasStyleFit(),i.Errors.Sucess(e),!0},r.prototype.RotateRight=function(){var e=this;if("edit"!=e.mode)return i.Errors.FucNotValidInThisMode(e,"RotateRight","view"),!1;var t=o(e._canvas).getTransform(),r=H.Matrix.dot(new H.Matrix(0,1,-1,0,0,0),t);return o(e._canvas).setTransform(r),e.__pushStack("rotateRight"),e.__setCanvasStyleFit(),i.Errors.Sucess(e),!0},r.prototype.Rotate=function(e,t){var r=this;if("edit"!=r.mode)return i.Errors.FucNotValidInThisMode(r,"Rotate","view"),!1;for(var n=parseInt(t/90),a=o(r._canvas).getTransform(),s=0;s<n;s++)a=H.Matrix.dot(new H.Matrix(0,1,-1,0,0,0),a);return o(r._canvas).setTransform(a),r.__pushStack("rotateRight"),r.__setCanvasStyleFit(),i.Errors.Sucess(r),!0},r.prototype.Mirror=function(){var e=this;if("edit"!=e.mode)return i.Errors.FucNotValidInThisMode(e,"Mirror","view"),!1;var t=o(e._canvas).getTransform(),r=H.Matrix.dot(new H.Matrix(-1,0,0,1,0,0),t);return o(e._canvas).setTransform(r),e.__pushStack("mirror"),e.__setCanvasStyleFit(),i.Errors.Sucess(e),!0},r.prototype.Flip=function(){var e=this;if("edit"!=e.mode)return i.Errors.FucNotValidInThisMode(e,"Flip","view"),!1;var t=o(e._canvas).getTransform(),r=H.Matrix.dot(new H.Matrix(1,0,0,-1,0,0),t);return o(e._canvas).setTransform(r),e.__pushStack("flip"),e.__setCanvasStyleFit(),i.Errors.Sucess(e),!0},r.prototype.Crop=function(){var e=this;if("edit"!=e.mode)return i.Errors.FucNotValidInThisMode(e,"Crop","view"),!1;var t=e.ImageAreaSelector.__getCropArea();return 0!=t.x||0!=t.y||1!=t.width||1!=t.height?(e.__pushStack("Crop"),e.__updateCanvasInner(!1),i.Errors.Sucess(e),!0):void 0},r.prototype.Save=function(){var e=this;return"edit"!=e.mode?(i.Errors.FucNotValidInThisMode(e,"Save","view"),!1):(e.__updateCanvasInner(!0),e.CloseImageEditor(!1),e.replaceOriginalImage?i.canvasToBlob(e._canvas,function(t){var i=URL.createObjectURL(t),r=e.aryImageControls[e.curIndex],n=e.aryThumbnailControls[e.curIndex];r.imageUrl=i,r.Refresh(),n.imageUrl=i,n.Refresh()}):e.LoadImageEx(e._canvas),!0)},r.prototype.Undo=function(){var e=this;if("edit"!=e.mode)return i.Errors.FucNotValidInThisMode(e,"Undo","view"),!1;if(e.curStep>0){var t=e.curStep-1;while(null==e.stack[t])--t;e.__fromToStepAsync(e.curStep,t)}},r.prototype.Redo=function(){var e=this;if("edit"!=e.mode)return i.Errors.FucNotValidInThisMode(e,"Redo","view"),!1;if(e.curStep<e.stack.length-1){var t=e.curStep+1;while(null==e.stack[t])++t;e.__fromToStepAsync(e.curStep,t)}},r.prototype.RemoveAllSelectedImages=function(){var e=this,t=e.curIndex;if("edit"==e.mode)return i.Errors.FucNotValidInThisMode(e,"RemoveAllSelectedImages","edit"),!1;e.__RemoveImageControl(t),e.__RemoveThumbnailControl(t);var r=e.curIndex>e.aryImageControls.length-1?e.aryImageControls.length-1:e.curIndex;return e.ShowImage(r),!0},r.prototype.RemoveAllImages=function(){var e,t=this;if("edit"==t.mode)return i.Errors.FucNotValidInThisMode(t,"RemoveAllImages","edit"),!1;var r=t.aryImageControls.length;for(e=r-1;e>=0;e--)t.__RemoveImageControl(e);var n=t.aryThumbnailControls.length;for(e=n-1;e>=0;e--)t.__RemoveThumbnailControl(e);return!0},r.prototype.__RemoveImageControl=function(e){var t=this;if(e<t.aryImageControls.length&&e>=0){var i=t.aryImageControls[e];i.Destroy(),t.aryImageControls.splice(e,1),t._imgsDiv.removeChild(i.GetEL())}for(var r=e;r<t.aryImageControls.length;r++){i=t.aryImageControls[r];i.SetIndex(r)}},r.prototype.__RemoveThumbnailControl=function(e){var t=this;if(e<t.aryThumbnailControls.length&&e>=0){var i=t.aryThumbnailControls[e];i.Destroy(),t.aryThumbnailControls.splice(e,1),t._thumbnailsDiv.removeChild(i.GetEL())}for(var r=e;r<t.aryThumbnailControls.length;r++){i=t.aryThumbnailControls[r];i.SetIndex(r)}t.__reInitThumbnailControlPosition()},r.prototype.__updateCanvasInner=function(e){var t=this,i=t.aryImageControls[t.curIndex].objImage,r=i.naturalWidth||i.width,n=i.naturalHeight||i.height,a=t.stack[t.curStep],s=a.crop,l=a.transform,d=t.ctx,h=t._canvas,u=h.fullQualityWidth=Math.round(r*s.width)||1,c=h.fullQualityHeight=Math.round(n*s.height)||1;if(0!=l.a*l.d&&0==l.b*l.c?(h.fullQualityWidth=u,h.fullQualityHeight=c):(h.fullQualityWidth=c,h.fullQualityHeight=u,e&&(t.isSwitchedWH=!0)),o(h).setTransform(new H.Matrix(1,0,0,1,0,0)),h.hasCompressed=!1,e){var g,m;t.isSwitchedWH?(g=c,m=u):(g=u,m=c),h.width=g,h.height=m;var p=g/2*(1-l.a-l.c),f=m/2*(1-l.b-l.d);d.setTransform(l.a,l.b,l.c,l.d,p,f)}else h.width=u,h.height=c;var v,w,y=Math.round(r*s.x),b=Math.round(n*s.y);y==r&&--y,b==n&&--b,t.isSwitchedWH&&e?(v=h.height,w=h.width):(v=h.width,w=h.height),d.clearRect(0,0,v,w),d.drawImage(i,y,b,u,c,0,0,v,w),e?o(h).setTransform(new H.Matrix(1,0,0,1,0,0)):o(h).setTransform(l),t.__setCanvasStyleFit(e)},r.prototype.__fromToStepAsync=function(e,t,i){var r=this;r.curStep=t;var n=r.stack[e].crop,a=r.stack[r.curStep].crop;n.x==a.x&&n.y==a.y&&n.width==a.width&&n.bottom==a.bottom&&r.stack[e].srcBlob==r.stack[r.curStep].srcBlob?(o(r._canvas).setTransform(r.stack[r.curStep].transform.dot(r.stack[e].transform.inversion()).dot(o(r._canvas).getTransform())),r.__setCanvasStyleFit(),i&&i()):r.__updateCanvasInner(!1)},r.prototype.__setCanvasStyleFit=function(e){var t=this,i=t._canvasArea,r=t.stack[t.curStep].transform;if(0!=r.a*r.d&&0==r.b*r.c?t.isSwitchedWH=!1:t.isSwitchedWH=!0,t.isSwitchedWH&&!e)var n=t._canvas.height/t._canvas.width;else n=t._canvas.width/t._canvas.height;var o=t._imgsDivW/t._imgsDivH;if(o>n?(i.height=t._imgsDivH,i.width=n*t._imgsDivH):(i.width=t._imgsDivW,i.height=i.width/n),t.isSwitchedWH&&!e){var a=i.width;i.width=i.height,i.height=a}i.left=Math.floor((t._imgsDivW-i.width)/2),i.top=Math.floor((t._imgsDivH-i.height)/2),t._canvas.style.left=i.left+"px",t._canvas.style.top=i.top+"px",t._canvas.style.width=i.width+"px",t._canvas.style.height=i.height+"px",t.ImageAreaSelector.ShowCropRect()},r.prototype.__addImgToContainer=function(e){var t=this;return t._imgsDiv.appendChild(e),t.__reInitImageControlPosition(),!0},r.prototype.__addImgToThumbnail=function(e){var t=this;return t._thumbnailsDiv.appendChild(e),t.__reInitThumbnailControlPosition(),!0},r.prototype.__resetSelection=function(){var e=this,t=0;for(t=0;t<e.aryThumbnailControls.length;t++){var i=e.aryThumbnailControls[t];i.bVisible&&(i.cIndex!=e.curIndex?i.SetSelect(!1):i.cIndex==e.curIndex&&i.SetSelect(!0))}},r.prototype.__reInitImageControlPosition=function(){for(var e=this,t=e.aryImageControls,i=e.curIndex,r=i-1<0?t.length-1:i-1,n=i+1>t.length-1?0:i+1,o=0;o<t.length;o++)o==i?(t[i].SetVisible(!0),t[i].SetLocation()):o==r?t[r].SetLocation(-e._imgContainerW):o==n?t[n].SetLocation(e._imgContainerW):t[o].SetLocation(e._imgContainerW);return!0},r.prototype.__reInitThumbnailControlPosition=function(){var e,t,i,r=this;for(r.__initThumbnailControlsSize(),e=r.ThumbnailImageMargin,t=r.ThumbnailImageMargin,i=0;i<r.aryThumbnailControls.length;i++){var n=r.aryThumbnailControls[i],o=n.cIndex;n._width==r.ThumbnailControlW&&n._height==r.ThumbnailControlH||n.ChangeControlSize(r.ThumbnailControlW,r.ThumbnailControlH),n.SetLocation(e,t),r._thumbnailsDiv.style.height=t+n.GetControlHeight()+"px",r._thumbnailContainer.scrollTop=r._thumbnailContainer.scrollHeight,t=n.Top+r.ThumbnailControlH+r.ThumbnailImageMargin,e=r.ThumbnailImageMargin,(o<0||o>=r.aryThumbnailControls.length)&&n.ClearControl()}},r.prototype.__initThumbnailControlsSize=function(){var e,t,i=this;e=i._thumbnailContainerW-i.ThumbnailImageMargin,t=i._thumbnailContainerH-i.ThumbnailImageMargin,i.aryThumbnailControls.length>i.thumbnailImagesPerRow?(i.ThumbnailControlW=e-i.ThumbnailImageMargin-15,i.ThumbnailControlH=t/i.thumbnailImagesPerRow-i.ThumbnailImageMargin):(i.ThumbnailControlW=e-i.ThumbnailImageMargin,i.ThumbnailControlH=t/i.thumbnailImagesPerRow-i.ThumbnailImageMargin)},r.prototype.__setCanvasVisible=function(e){var t=this;t._canvas.style.display=e?"":"none"},r.prototype.__pushStack=function(e){var t=this,i={fun:e,crop:t.__getFinalCropArea()[0],draw:t.__getFinalCropArea()[1],transform:o(t._canvas).getTransform(),srcBlob:t.aryImageControls[t.curIndex].imageUrl};return t.stack.push(i),t.curStep++,!0},r.prototype.__getFinalCropArea=function(){var e=this,t=e.aryImageControls[e.curIndex].objImage,i=t.naturalWidth||t.width,r=t.naturalHeight||t.height,n=e.stack[e.curStep],o=n.crop,a=n.transform,s=e.ImageAreaSelector.__getCropArea(),l={x:o.x,y:o.y,width:o.width,height:o.height};0!=a.a*a.d&&0==a.b*a.c?s&&(1==a.a?l.x+=s.x*o.width:l.x+=(1-s.x-s.width)*o.width,1==a.d?l.y+=s.y*o.height:l.y+=(1-s.y-s.height)*o.height,l.width*=s.width,l.height*=s.height):s&&(1==a.b?l.x+=s.y*o.width:l.x+=(1-s.y-s.height)*o.width,1==a.c?l.y+=s.x*o.height:l.y+=(1-s.x-s.width)*o.height,l.width*=s.height,l.height*=s.width);t=e.aryImageControls[e.curIndex];var d=Math.pow(10,Math.ceil(Math.max(t._origImageWidth,t._origImageHeight)).toString().length+2);l.x=Math.round(l.x*d)/d,l.y=Math.round(l.y*d)/d,l.width=Math.round(l.width*d)/d,l.height=Math.round(l.height*d)/d;var h={x:l.x*i,y:l.y*r,width:l.width*i,height:l.height*r};return[l,h]},r.prototype.onNumChange=null,r.prototype._updateNumUI=function(){i.doCallbackNoBreak(this.onNumChange,[this.curIndex,this.aryImageControls.length])},t.ImageViewer=r}(s.MBC.Lib,s.MBC),t["a"]=M}).call(this,i("dd40")(e),i("c8ba"))},"3c35":function(e,t){(function(t){e.exports=t}).call(this,{})},"5fe5":function(e,t,i){},"7c11":function(e,t,i){},dd40:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},fff7:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"main"}},[i("a",{attrs:{href:"javascript:void(0)"},on:{click:e.fuc_LoadImage}},[e._v("LoadImage")]),i("div",{attrs:{id:"imageViewer"}})])},n=[],o=i("3450"),a={name:"ImageViewer",data:function(){return{imageViewer:""}},mounted:function(){var e={ContainerId:"imageViewer",Width:"1000px",Height:"1000px"};this.imageViewer=Object(o["a"])(e)},methods:{fuc_LoadImage:function(){if(!this.imageViewer)return!1;this.imageViewer.LoadImageEx()}}},s=a,l=i("2877"),d=Object(l["a"])(s,r,n,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-6610efc2.ae37f011.js.map