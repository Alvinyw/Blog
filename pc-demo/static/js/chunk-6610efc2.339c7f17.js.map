{"version":3,"sources":["webpack:///./node_modules/alvin-imageviewer/mbc.js","webpack:///(webpack)/buildin/amd-options.js","webpack:///(webpack)/buildin/harmony-module.js","webpack:///./src/views/imageviewer/index.vue?2741","webpack:///src/views/imageviewer/index.vue","webpack:///./src/views/imageviewer/index.vue?fc86","webpack:///./src/views/imageviewer/index.vue"],"names":["_deviceType","$","jQuery","Alvin","ua","navigator","userAgent","toLowerCase","_platform","platform","_bWin","_nMSIE","indexOf","_nTrident","_nRV","_nEdge","_tmp","match","_bSafari","_nFirefox","_bFirefox","_bEdge","_indexOfChrome","_bChrome","_bIE","_strBrowserVersion","_mainVer","bIsIpad","bIsIphoneOs","bIsMidp","bIsUc7","bIsUc","bIsAndroid","bIsCE","bIsWM","slice","debug","root","self","EXIF","obj","this","EXIFwrapped","exports","module","ExifTags","Tags","TiffTags","GPSTags","0","IFD1Tags","StringValues","ExposureProgram","1","2","3","4","5","6","7","8","MeteringMode","255","LightSource","9","10","11","12","13","14","15","17","18","19","20","21","22","23","24","Flash","SensingMethod","SceneCaptureType","SceneType","CustomRendered","WhiteBalance","GainControl","Contrast","Saturation","Sharpness","SubjectDistanceRange","FileSource","Components","imageHasData","img","base64ToArrayBuffer","base64","contentType","replace","binary","atob","len","length","buffer","ArrayBuffer","view","Uint8Array","i","charCodeAt","objectURLToBlob","url","callback","http","XMLHttpRequest","open","responseType","onload","e","status","response","send","getImageData","handleBinaryFile","binFile","data","findEXIFinJPEG","iptcdata","findIPTCinJPEG","xmpdata","findXMPinJPEG","exifdata","call","src","test","arrayBuffer","fileReader","FileReader","target","result","blob","readAsArrayBuffer","Blob","File","console","log","byteLength","file","dataView","DataView","getUint8","marker","offset","readEXIFData","getUint16","isFieldSegmentStart","nameHeaderLength","startOffset","sectionLength","readIPTCData","IptcFieldMap","fieldValue","fieldName","dataSize","segmentType","segmentStartPos","getInt16","getStringFromDB","hasOwnProperty","Array","push","readTags","tiffStart","dirStart","strings","bigEnd","entryOffset","tag","entries","tags","readTagValue","vals","val","n","numerator","denominator","type","numValues","getUint32","valueOffset","Number","getInt32","getNextIFDOffset","readThumbnailImage","firstIFDOffset","IFD1OffsetPointer","thumbTags","JpegIFOffset","JpegIFByteCount","tOffset","tLength","start","outstr","String","fromCharCode","exifData","gpsData","tiffOffset","ExifIFDPointer","GPSInfoIFDPointer","dom","DOMParser","xmpString","xmpEndIndex","substring","indexOfXmp","domDocument","parseFromString","xml2Object","xml","children","item","attributes","idx","itemAtt","dataKey","nodeName","dataValue","nodeValue","undefined","xml2json","old","textContent","message","getData","Image","HTMLImageElement","complete","getTag","getIptcTag","getAllTags","a","getAllIptcTags","pretty","strPretty","readFromBinaryFile","define","MBC","lib","Lib","getElDimensions","el","displayFormat","elDimensions","style","display","clientTop","clientLeft","clientWidth","parseInt","width","clientHeight","height","hasClass","cls","className","RegExp","addClass","removeClass","reg","toggleClass","isNumber","isNaN","each","object","fn","context","key","keys","isObj","isUndefined","isFunction","exp","_fun","hasEnumBug","toString","propertyIsEnumerable","enumProperties","o","p","Object","doCallbackNoBreak","paras","apply","window","ex","setTimeout","convertBase64ToBlob","base64Str","mimeType","byteCharacters","byteNumArr","uint8Arr","convertURLToBlob","onloadend","canvasToBlob","cvs","quality","toBlob","b64str","toDataURL","getBlobFromAnyImgData","imgData","HTMLCanvasElement","tCvs","document","createElement","naturalWidth","naturalHeight","ctx","getContext","drawImage","saveFormat","suffix","questionPos","lastIndexOf","dotPos","addEvent","handle","typeAry","split","j","addEventListener","attachEvent","removeEvent","removeEventListener","detachEvent","stopDefault","preventDefault","event","returnValue","_querySelectorAll","element","selector","idAllocator","querySelectorAll","needsID","id","fireEvent","name","createEvent","initEvent","dispatchEvent","createEventObject","bubbles","cancelable","Event","prototype","value","selectors","elements","documentElement","firstChild","appendChild","_qsa","styleSheet","cssText","scrollBy","parentNode","removeChild","shift","removeAttribute","querySelector","mix","dest","source","Errors","Sucess","_errorCode","_errorString","IndexOutOfRange","FucNotValidInThisMode","fuc","mode","InvalidValue","InvalidParameterType","__last","DEF","defineProperty","attachProperty","st","_this","get","GetCount","GetCurentIndex","set","v","_v","ShowImage","global","NativePromise","nativePromiseSupported","resolve","r","Promise","Polyfill","PENDING","SEALED","FULFILLED","REJECTED","NOOP","isArray","asyncTimer","asyncSetTimer","setImmediate","asyncQueue","asyncFlush","asyncCall","arg","invokeResolver","resolver","promise","resolvePromise","rejectPromise","reason","reject","invokeCallback","subscriber","owner","settled","state_","data_","then","handleThenable","resolved","TypeError","fulfill","publishFulfillment","publishRejection","publish","callbacks","then_","constructor","onFulfillment","onRejection","fulfilled","rejected","all","promises","Class","results","remaining","index","race","kUtil","createImageViewer","cfg","imageViewer","ImageViewer","Math","sign","num","NaN","Matrix","b","c","d","f","dot","matrixA","matrixB","A","B","matrix","equals","inversion","M","Date","kUtilFormat","fmt","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","floor","getUTCMilliseconds","k","$1","getFullYear","substr","copyToClipBoard","txt","clipboard","writeText","alert","textarea","position","left","top","body","append","isIOS","range","createRange","selectNodeContents","selection","getSelection","removeAllRanges","addRange","setSelectionRange","focus","select","bSuccess","execCommand","remove","borderWidth","cs","getComputedStyle","currentStyle","info","parseFloat","getPropertyValue","getAttribute","right","bottom","padding","borderBoxRect","pageX0","pageY0","outerWidth","outerHeight","pageX1","pageY1","paddingBoxRect","innerWidth","innerHeight","contentBoxRect","getTransform","strTransform","css","transform","partStr","matrixIndex","arr","scaleIndex","zoom","setTransform","m","str","join","DL","VideoViewer","videoHtmlElement","videoSettings","viewer","beforeAddImgFromGrabVideoBtn","afterAddImgFromGrabVideoBtn","videoClosed","__Init","camSelChange","playVideo","cameraSel","stopVideo","catch","relSelChange","btnGrabClick","grabVideo","hideVideo","closeWindow","optGotRsl","resolutionSel","btnGrab","btnClose","videoWrapper","getElementById","video","updateDevice","mediaDevices","enumerateDevices","deviceInfos","oldVal","innerHTML","selOpt","kind","opt","deviceId","innerText","label","optArr","childNodes","srcObject","getTracks","forEach","track","stop","constraints","selRslOpt","selectedIndex","hasAttribute","selW","selH","setAttribute","bMobileSafari","ideal","selCamOpt","facingMode","exact","hasTryedNoWidthHeight","getAndPlayVideo","getUserMedia","stream","resolve2","reject2","onloadedmetadata","play","gotRsl","videoWidth","videoHeight","onerror","isAutoAdd","canvas","LoadImageEx","showVideo","videoWrp","ImageAreaSelector","containerDiv","container","insertAdjacentHTML","kPainterCroper","kPainterCells","kPainterCorners","kPainterEdges","bVisible","isAutoShowCropUI","isCropRectShowing","dragging","maxWidth","maxHeight","minWidth","minHeight","minTop","minLeft","borderColor","backgroundColor","_startPos","targetNode","startX","startY","drawArea","x","y","cropArea","fuc_touchstart","ev","fuc_touchmove","fuc_touchend","curX","curY","touches","changedTouches","pageX","pageY","clientX","clientY","curW","curH","curL","curT","sp","_curOffsetX","_curOffsetY","__updateDrawArea","SetVisible","ShowCropRect","isSwitchedWH","_canvasArea","_imgContainerW","_imgContainerH","HideCropRect","w","h","__updatePosition","l","t","__getCropArea","curCropRect","_x","_y","_w","_h","ImageControl","containerWidth","containerHeight","controlWidth","controlHeight","_origImageWidth","_origImageHeight","_width","_height","Left","Top","objImage","imageUrl","cIndex","__init","imgContainerW","imgContainerH","divOut","__getImageByUrl","bShow","ChangeControlSize","_imgsDivW","_imgsDivH","SetLocation","Show","arguments","GetEL","GetIndex","SetIndex","ClearImage","__fitImage","Destroy","Refresh","objImageLeft","objImageTop","containerAspectRatio","imageAspectRatio","newImage","ThumbnailControl","canvasWidth","canvasHeight","selectionBorderColor","bSelect","canvasBackgroundGradientColorPairs","NotSelectedHovering","Selected","thumbOut","thumbCanvas","thumbnailImagesPerRow","attachImage","doc","ThumbnailImageMargin","ThumbnailControlW","ThumbnailControlH","border","cursor","bMouseHovering","SetBackgroundColor","bkcolor","SetSelectionImageBorderColor","__refreshBorder","GetControlWidth","GetControlHeight","bShowFromScrollEvent","__restoreCanvas","clearRect","fillStyle","fillRect","font","textAlign","strokeText","gradient","createLinearGradient","addColorStop","SetSelect","ClearControl","canvasAspectRatio","_imgContainer","_aryImgs","aryImageControls","_curIndex","curIndex","_pIndex","_nIndex","ChangePage","__reInitImageControlPosition","_imageViewer","ContainerId","_canvas","_imgsDiv","_thumbnailContainer","Width","_imageViewerW","Height","_imageViewerH","_defaultFileInput","BackgroundColor","aryThumbnailControls","ThumbnailBackgroundColor","_thumbnailsDiv","_thumbnailContainerW","beforeAddImgFromFileChooseWindow","files","dataTransfer","stack","curStep","replaceOriginalImage","afterAddImgFromFileChooseWindow","beforeAddImgFromDropFile","afterAddImgFromDropFile","_thumbnailContainerH","AdaptiveLayout","tempW","tempH","__reInitThumbnailControlPosition","__setCanvasStyleFit","FileList","LoadImageInner","ShowFileChooseWindow","imageViewerW","imageViewerH","URL","createObjectURL","objImageControl","__addImgToContainer","objThumbnailControl","__addImgToThumbnail","__resetSelection","_updateNumUI","ShowVideo","cmd","_index","round","GetImage","isOri","cloneNode","method","filename","getTime","download","objUrl","href","MouseEvent","revokeObjectURL","click","GetBackgroundColor","SetCropBackgroundColor","cells","SetCropBorderColor","corners","GetThumbnaiBackgroundColor","SetThumbnailBackgroundColor","GetThumbnailImageMargin","SetThumbnailImageMargin","ShowImageEditor","curImg","__setCanvasVisible","transformNew","_curStack","fun","crop","draw","srcBlob","__updateCanvasInner","CloseImageEditor","bShowImg","_bShowImg","RotateLeft","transformOri","__pushStack","RotateRight","Rotate","angle","rotateRightTime","Mirror","Flip","Crop","_newCropArea","Save","curThumbImg","Undo","toStep","__fromToStepAsync","Redo","RemoveAllSelectedImages","__RemoveImageControl","__RemoveThumbnailControl","RemoveAllImages","iCount","iThumbCount","objImgControl","splice","objThumbControl","bTrueTransform","imgOW","imgOH","process","tsf","sWidth","fullQualityWidth","sHeight","fullQualityHeight","hasCompressed","cvsW","cvsH","drawE","drawF","dWidth","dHeight","sx","sy","fromStep","_crop","ca","imgsDivAspectRatio","objImg","objThumb","thumbControl","__initThumbnailControlsSize","thumbnailControl","bindIndex","scrollTop","scrollHeight","iTotalWidth","iTotalHeight","funName","__getFinalCropArea","curStack","curCrop","curTsf","newCrop","finalCrop","accuracy","pow","ceil","max","finalDraw","onNumChange","__webpack_amd_options__","originalModule","webpackPolyfill","create","enumerable","render","_vm","$createElement","_c","_self","attrs","on","fuc_LoadImage","staticRenderFns","mounted","methods","component"],"mappings":"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","file":"static/js/chunk-6610efc2.339c7f17.js","sourcesContent":["import cssResetH5 from './css/cssResetH5.css';\r\nimport mbc from './css/mbc.css';\r\n\r\nvar $ = require( \"jquery\" );\r\nvar jQuery  = require( \"jquery\" );\r\n\r\nvar uaInfo = uaInfo || {};\r\nvar Alvin = Alvin || {};\r\n\t\r\nvar ua = navigator.userAgent.toLowerCase(),\r\n    _platform = navigator.platform.toLowerCase(),\r\n\r\n    _bWin = (_platform == 'win32') || (_platform == 'win64') || (_platform == 'windows'),\r\n    \r\n    _nMSIE = ua.indexOf('msie'),\r\n    _nTrident = ua.indexOf('trident'),\r\n    _nRV = ua.indexOf('rv:'),\r\n    _nEdge = ua.indexOf('edge'),\r\n\r\n    _tmp = ua.match(/version\\/([\\d.]+).*safari/),\r\n    _bSafari = _tmp ? !0 : !1,\r\n    _nSafari = _tmp ? _tmp[1] : 0,\r\n\r\n    _nFirefox = ua.indexOf('firefox'),\r\n    _bFirefox = (_nFirefox != -1),\r\n    \r\n    _bEdge = _bWin && !_bFirefox && (_nEdge != -1),\r\n    \r\n    _indexOfChrome = ua.indexOf('chrome'),\r\n    _bChrome =  !_bEdge && (_indexOfChrome != -1),\r\n\r\n    _bIE = _bWin && !_bFirefox && !_bEdge && !_bChrome && (_nMSIE != -1 || _nTrident != -1 || _nRV != -1),\r\n\r\n    _strBrowserVersion = '',\r\n    _mainVer = 0;\r\n\r\n\r\nvar _deviceType,\r\n    bIsIpad = ua.match(/ipad/i) == \"ipad\",\r\n    bIsIphoneOs = ua.match(/iphone os/i) == \"iphone os\",\r\n    bIsMidp = ua.match(/midp/i) == \"midp\",\r\n    bIsUc7 = ua.match(/rv:1.2.3.4/i) == \"rv:1.2.3.4\",\r\n    bIsUc = ua.match(/ucweb/i) == \"ucweb\",\r\n    bIsAndroid = ua.match(/android/i) == \"android\",\r\n    bIsCE = ua.match(/windows ce/i) == \"windows ce\",\r\n    bIsWM = ua.match(/windows mobile/i) == \"windows mobile\";\r\n    \r\nif (bIsIpad || bIsIphoneOs || bIsMidp || bIsUc7 || bIsUc || bIsAndroid || bIsCE || bIsWM) {\r\n    _deviceType = 'phone'; \r\n} else {\r\n    _deviceType = 'pc'; \r\n}  \r\n\r\n\r\nif(_bEdge) {\r\n    _tmp = ua.slice(_nEdge + 5);\r\n    _tmp = _tmp.slice(0, _tmp.indexOf(' '));\r\n    _strBrowserVersion = _tmp;\r\n    \r\n} else if (_bChrome) {\r\n    _tmp = ua.slice(_indexOfChrome + 7);\r\n    _tmp = _tmp.slice(0, _tmp.indexOf(' '));\r\n    _strBrowserVersion = _tmp;\r\n\r\n} else if (_bFirefox) {\t// FF\r\n    _tmp = ua.slice(_nFirefox + 8);\r\n    _tmp = _tmp.slice(0, _tmp.indexOf(' '));\r\n    _strBrowserVersion = _tmp;\r\n\r\n} else if (_bIE) {\r\n    if (_nMSIE != -1) {\r\n        // 'msie'\r\n        _tmp = ua.slice(_nMSIE + 4);\r\n        _tmp = _tmp.slice(0, _tmp.indexOf(';'));\r\n        _strBrowserVersion = _tmp;\r\n    } else if (_nRV != -1) {\r\n        // 'rv:'\r\n        _tmp = ua.slice(_nRV + 3);\r\n        _tmp = _tmp.slice(0, _tmp.indexOf(';'));\r\n        _tmp = _tmp.slice(0, _tmp.indexOf(')'));\r\n        _strBrowserVersion = _tmp;\r\n    } else if (_nTrident != -1) {\r\n        // 'trident'\r\n        _tmp = ua.slice(_nTrident + 7);\r\n        _tmp = _tmp.slice(0, _tmp.indexOf(';'));\r\n        _strBrowserVersion = _tmp;\r\n    }\r\n\r\n\r\n} else if (_bSafari) {\r\n    if (_tmp) {\r\n        _strBrowserVersion = _tmp[1];\r\n    }\r\n}\r\n\r\nif(_strBrowserVersion.indexOf('.') > -1)\r\n    _mainVer = _strBrowserVersion.slice(0, _strBrowserVersion.indexOf('.')) * 1.0;\r\n\t\r\nuaInfo = {\r\n    bWin: _bWin,\r\n    \r\n    bIE: _bIE,\r\n    bEdge: _bEdge,\r\n    bFirefox: _bFirefox,\r\n    bChrome: _bChrome,\r\n    bSafari: _bSafari,\r\n    \r\n    strVersion: _strBrowserVersion,\r\n    mainVer: _mainVer,\r\n    deviceType: _deviceType\r\n    \r\n};\r\n\r\n/*\r\nKeillion get from https://github.com/exif-js/exif-js and fix some bug.\r\n\r\nThe MIT License (MIT)\r\nCopyright (c) 2008 Jacob Seidelin\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n*/\r\n(function() {\r\n\r\n    var debug = false;\r\n\r\n    var root = self;\r\n\r\n    var EXIF = function(obj) {\r\n        if (obj instanceof EXIF) return obj;\r\n        if (!(this instanceof EXIF)) return new EXIF(obj);\r\n        this.EXIFwrapped = obj;\r\n    };\r\n\r\n    if (typeof exports !== 'undefined') {\r\n        if (typeof module !== 'undefined' && module.exports) {\r\n            exports = module.exports = EXIF;\r\n        }\r\n        exports.EXIF = EXIF;\r\n    } else {\r\n        root.EXIF = EXIF;\r\n    }\r\n\r\n    var ExifTags = EXIF.Tags = {\r\n\r\n        // version tags\r\n        0x9000 : \"ExifVersion\",             // EXIF version\r\n        0xA000 : \"FlashpixVersion\",         // Flashpix format version\r\n\r\n        // colorspace tags\r\n        0xA001 : \"ColorSpace\",              // Color space information tag\r\n\r\n        // image configuration\r\n        0xA002 : \"PixelXDimension\",         // Valid width of meaningful image\r\n        0xA003 : \"PixelYDimension\",         // Valid height of meaningful image\r\n        0x9101 : \"ComponentsConfiguration\", // Information about channels\r\n        0x9102 : \"CompressedBitsPerPixel\",  // Compressed bits per pixel\r\n\r\n        // user information\r\n        0x927C : \"MakerNote\",               // Any desired information written by the manufacturer\r\n        0x9286 : \"UserComment\",             // Comments by user\r\n\r\n        // related file\r\n        0xA004 : \"RelatedSoundFile\",        // Name of related sound file\r\n\r\n        // date and time\r\n        0x9003 : \"DateTimeOriginal\",        // Date and time when the original image was generated\r\n        0x9004 : \"DateTimeDigitized\",       // Date and time when the image was stored digitally\r\n        0x9290 : \"SubsecTime\",              // Fractions of seconds for DateTime\r\n        0x9291 : \"SubsecTimeOriginal\",      // Fractions of seconds for DateTimeOriginal\r\n        0x9292 : \"SubsecTimeDigitized\",     // Fractions of seconds for DateTimeDigitized\r\n\r\n        // picture-taking conditions\r\n        0x829A : \"ExposureTime\",            // Exposure time (in seconds)\r\n        0x829D : \"FNumber\",                 // F number\r\n        0x8822 : \"ExposureProgram\",         // Exposure program\r\n        0x8824 : \"SpectralSensitivity\",     // Spectral sensitivity\r\n        0x8827 : \"ISOSpeedRatings\",         // ISO speed rating\r\n        0x8828 : \"OECF\",                    // Optoelectric conversion factor\r\n        0x9201 : \"ShutterSpeedValue\",       // Shutter speed\r\n        0x9202 : \"ApertureValue\",           // Lens aperture\r\n        0x9203 : \"BrightnessValue\",         // Value of brightness\r\n        0x9204 : \"ExposureBias\",            // Exposure bias\r\n        0x9205 : \"MaxApertureValue\",        // Smallest F number of lens\r\n        0x9206 : \"SubjectDistance\",         // Distance to subject in meters\r\n        0x9207 : \"MeteringMode\",            // Metering mode\r\n        0x9208 : \"LightSource\",             // Kind of light source\r\n        0x9209 : \"Flash\",                   // Flash status\r\n        0x9214 : \"SubjectArea\",             // Location and area of main subject\r\n        0x920A : \"FocalLength\",             // Focal length of the lens in mm\r\n        0xA20B : \"FlashEnergy\",             // Strobe energy in BCPS\r\n        0xA20C : \"SpatialFrequencyResponse\",    //\r\n        0xA20E : \"FocalPlaneXResolution\",   // Number of pixels in width direction per FocalPlaneResolutionUnit\r\n        0xA20F : \"FocalPlaneYResolution\",   // Number of pixels in height direction per FocalPlaneResolutionUnit\r\n        0xA210 : \"FocalPlaneResolutionUnit\",    // Unit for measuring FocalPlaneXResolution and FocalPlaneYResolution\r\n        0xA214 : \"SubjectLocation\",         // Location of subject in image\r\n        0xA215 : \"ExposureIndex\",           // Exposure index selected on camera\r\n        0xA217 : \"SensingMethod\",           // Image sensor type\r\n        0xA300 : \"FileSource\",              // Image source (3 == DSC)\r\n        0xA301 : \"SceneType\",               // Scene type (1 == directly photographed)\r\n        0xA302 : \"CFAPattern\",              // Color filter array geometric pattern\r\n        0xA401 : \"CustomRendered\",          // Special processing\r\n        0xA402 : \"ExposureMode\",            // Exposure mode\r\n        0xA403 : \"WhiteBalance\",            // 1 = auto white balance, 2 = manual\r\n        0xA404 : \"DigitalZoomRation\",       // Digital zoom ratio\r\n        0xA405 : \"FocalLengthIn35mmFilm\",   // Equivalent foacl length assuming 35mm film camera (in mm)\r\n        0xA406 : \"SceneCaptureType\",        // Type of scene\r\n        0xA407 : \"GainControl\",             // Degree of overall image gain adjustment\r\n        0xA408 : \"Contrast\",                // Direction of contrast processing applied by camera\r\n        0xA409 : \"Saturation\",              // Direction of saturation processing applied by camera\r\n        0xA40A : \"Sharpness\",               // Direction of sharpness processing applied by camera\r\n        0xA40B : \"DeviceSettingDescription\",    //\r\n        0xA40C : \"SubjectDistanceRange\",    // Distance to subject\r\n\r\n        // other tags\r\n        0xA005 : \"InteroperabilityIFDPointer\",\r\n        0xA420 : \"ImageUniqueID\"            // Identifier assigned uniquely to each image\r\n    };\r\n\r\n    var TiffTags = EXIF.TiffTags = {\r\n        0x0100 : \"ImageWidth\",\r\n        0x0101 : \"ImageHeight\",\r\n        0x8769 : \"ExifIFDPointer\",\r\n        0x8825 : \"GPSInfoIFDPointer\",\r\n        0xA005 : \"InteroperabilityIFDPointer\",\r\n        0x0102 : \"BitsPerSample\",\r\n        0x0103 : \"Compression\",\r\n        0x0106 : \"PhotometricInterpretation\",\r\n        0x0112 : \"Orientation\",\r\n        0x0115 : \"SamplesPerPixel\",\r\n        0x011C : \"PlanarConfiguration\",\r\n        0x0212 : \"YCbCrSubSampling\",\r\n        0x0213 : \"YCbCrPositioning\",\r\n        0x011A : \"XResolution\",\r\n        0x011B : \"YResolution\",\r\n        0x0128 : \"ResolutionUnit\",\r\n        0x0111 : \"StripOffsets\",\r\n        0x0116 : \"RowsPerStrip\",\r\n        0x0117 : \"StripByteCounts\",\r\n        0x0201 : \"JPEGInterchangeFormat\",\r\n        0x0202 : \"JPEGInterchangeFormatLength\",\r\n        0x012D : \"TransferFunction\",\r\n        0x013E : \"WhitePoint\",\r\n        0x013F : \"PrimaryChromaticities\",\r\n        0x0211 : \"YCbCrCoefficients\",\r\n        0x0214 : \"ReferenceBlackWhite\",\r\n        0x0132 : \"DateTime\",\r\n        0x010E : \"ImageDescription\",\r\n        0x010F : \"Make\",\r\n        0x0110 : \"Model\",\r\n        0x0131 : \"Software\",\r\n        0x013B : \"Artist\",\r\n        0x8298 : \"Copyright\"\r\n    };\r\n\r\n    var GPSTags = EXIF.GPSTags = {\r\n        0x0000 : \"GPSVersionID\",\r\n        0x0001 : \"GPSLatitudeRef\",\r\n        0x0002 : \"GPSLatitude\",\r\n        0x0003 : \"GPSLongitudeRef\",\r\n        0x0004 : \"GPSLongitude\",\r\n        0x0005 : \"GPSAltitudeRef\",\r\n        0x0006 : \"GPSAltitude\",\r\n        0x0007 : \"GPSTimeStamp\",\r\n        0x0008 : \"GPSSatellites\",\r\n        0x0009 : \"GPSStatus\",\r\n        0x000A : \"GPSMeasureMode\",\r\n        0x000B : \"GPSDOP\",\r\n        0x000C : \"GPSSpeedRef\",\r\n        0x000D : \"GPSSpeed\",\r\n        0x000E : \"GPSTrackRef\",\r\n        0x000F : \"GPSTrack\",\r\n        0x0010 : \"GPSImgDirectionRef\",\r\n        0x0011 : \"GPSImgDirection\",\r\n        0x0012 : \"GPSMapDatum\",\r\n        0x0013 : \"GPSDestLatitudeRef\",\r\n        0x0014 : \"GPSDestLatitude\",\r\n        0x0015 : \"GPSDestLongitudeRef\",\r\n        0x0016 : \"GPSDestLongitude\",\r\n        0x0017 : \"GPSDestBearingRef\",\r\n        0x0018 : \"GPSDestBearing\",\r\n        0x0019 : \"GPSDestDistanceRef\",\r\n        0x001A : \"GPSDestDistance\",\r\n        0x001B : \"GPSProcessingMethod\",\r\n        0x001C : \"GPSAreaInformation\",\r\n        0x001D : \"GPSDateStamp\",\r\n        0x001E : \"GPSDifferential\"\r\n    };\r\n\r\n     // EXIF 2.3 Spec\r\n    var IFD1Tags = EXIF.IFD1Tags = {\r\n        0x0100: \"ImageWidth\",\r\n        0x0101: \"ImageHeight\",\r\n        0x0102: \"BitsPerSample\",\r\n        0x0103: \"Compression\",\r\n        0x0106: \"PhotometricInterpretation\",\r\n        0x0111: \"StripOffsets\",\r\n        0x0112: \"Orientation\",\r\n        0x0115: \"SamplesPerPixel\",\r\n        0x0116: \"RowsPerStrip\",\r\n        0x0117: \"StripByteCounts\",\r\n        0x011A: \"XResolution\",\r\n        0x011B: \"YResolution\",\r\n        0x011C: \"PlanarConfiguration\",\r\n        0x0128: \"ResolutionUnit\",\r\n        0x0201: \"JpegIFOffset\",    // When image format is JPEG, this value show offset to JPEG data stored.(aka \"ThumbnailOffset\" or \"JPEGInterchangeFormat\")\r\n        0x0202: \"JpegIFByteCount\", // When image format is JPEG, this value shows data size of JPEG image (aka \"ThumbnailLength\" or \"JPEGInterchangeFormatLength\")\r\n        0x0211: \"YCbCrCoefficients\",\r\n        0x0212: \"YCbCrSubSampling\",\r\n        0x0213: \"YCbCrPositioning\",\r\n        0x0214: \"ReferenceBlackWhite\"\r\n    };\r\n\r\n    var StringValues = EXIF.StringValues = {\r\n        ExposureProgram : {\r\n            0 : \"Not defined\",\r\n            1 : \"Manual\",\r\n            2 : \"Normal program\",\r\n            3 : \"Aperture priority\",\r\n            4 : \"Shutter priority\",\r\n            5 : \"Creative program\",\r\n            6 : \"Action program\",\r\n            7 : \"Portrait mode\",\r\n            8 : \"Landscape mode\"\r\n        },\r\n        MeteringMode : {\r\n            0 : \"Unknown\",\r\n            1 : \"Average\",\r\n            2 : \"CenterWeightedAverage\",\r\n            3 : \"Spot\",\r\n            4 : \"MultiSpot\",\r\n            5 : \"Pattern\",\r\n            6 : \"Partial\",\r\n            255 : \"Other\"\r\n        },\r\n        LightSource : {\r\n            0 : \"Unknown\",\r\n            1 : \"Daylight\",\r\n            2 : \"Fluorescent\",\r\n            3 : \"Tungsten (incandescent light)\",\r\n            4 : \"Flash\",\r\n            9 : \"Fine weather\",\r\n            10 : \"Cloudy weather\",\r\n            11 : \"Shade\",\r\n            12 : \"Daylight fluorescent (D 5700 - 7100K)\",\r\n            13 : \"Day white fluorescent (N 4600 - 5400K)\",\r\n            14 : \"Cool white fluorescent (W 3900 - 4500K)\",\r\n            15 : \"White fluorescent (WW 3200 - 3700K)\",\r\n            17 : \"Standard light A\",\r\n            18 : \"Standard light B\",\r\n            19 : \"Standard light C\",\r\n            20 : \"D55\",\r\n            21 : \"D65\",\r\n            22 : \"D75\",\r\n            23 : \"D50\",\r\n            24 : \"ISO studio tungsten\",\r\n            255 : \"Other\"\r\n        },\r\n        Flash : {\r\n            0x0000 : \"Flash did not fire\",\r\n            0x0001 : \"Flash fired\",\r\n            0x0005 : \"Strobe return light not detected\",\r\n            0x0007 : \"Strobe return light detected\",\r\n            0x0009 : \"Flash fired, compulsory flash mode\",\r\n            0x000D : \"Flash fired, compulsory flash mode, return light not detected\",\r\n            0x000F : \"Flash fired, compulsory flash mode, return light detected\",\r\n            0x0010 : \"Flash did not fire, compulsory flash mode\",\r\n            0x0018 : \"Flash did not fire, auto mode\",\r\n            0x0019 : \"Flash fired, auto mode\",\r\n            0x001D : \"Flash fired, auto mode, return light not detected\",\r\n            0x001F : \"Flash fired, auto mode, return light detected\",\r\n            0x0020 : \"No flash function\",\r\n            0x0041 : \"Flash fired, red-eye reduction mode\",\r\n            0x0045 : \"Flash fired, red-eye reduction mode, return light not detected\",\r\n            0x0047 : \"Flash fired, red-eye reduction mode, return light detected\",\r\n            0x0049 : \"Flash fired, compulsory flash mode, red-eye reduction mode\",\r\n            0x004D : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\",\r\n            0x004F : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\",\r\n            0x0059 : \"Flash fired, auto mode, red-eye reduction mode\",\r\n            0x005D : \"Flash fired, auto mode, return light not detected, red-eye reduction mode\",\r\n            0x005F : \"Flash fired, auto mode, return light detected, red-eye reduction mode\"\r\n        },\r\n        SensingMethod : {\r\n            1 : \"Not defined\",\r\n            2 : \"One-chip color area sensor\",\r\n            3 : \"Two-chip color area sensor\",\r\n            4 : \"Three-chip color area sensor\",\r\n            5 : \"Color sequential area sensor\",\r\n            7 : \"Trilinear sensor\",\r\n            8 : \"Color sequential linear sensor\"\r\n        },\r\n        SceneCaptureType : {\r\n            0 : \"Standard\",\r\n            1 : \"Landscape\",\r\n            2 : \"Portrait\",\r\n            3 : \"Night scene\"\r\n        },\r\n        SceneType : {\r\n            1 : \"Directly photographed\"\r\n        },\r\n        CustomRendered : {\r\n            0 : \"Normal process\",\r\n            1 : \"Custom process\"\r\n        },\r\n        WhiteBalance : {\r\n            0 : \"Auto white balance\",\r\n            1 : \"Manual white balance\"\r\n        },\r\n        GainControl : {\r\n            0 : \"None\",\r\n            1 : \"Low gain up\",\r\n            2 : \"High gain up\",\r\n            3 : \"Low gain down\",\r\n            4 : \"High gain down\"\r\n        },\r\n        Contrast : {\r\n            0 : \"Normal\",\r\n            1 : \"Soft\",\r\n            2 : \"Hard\"\r\n        },\r\n        Saturation : {\r\n            0 : \"Normal\",\r\n            1 : \"Low saturation\",\r\n            2 : \"High saturation\"\r\n        },\r\n        Sharpness : {\r\n            0 : \"Normal\",\r\n            1 : \"Soft\",\r\n            2 : \"Hard\"\r\n        },\r\n        SubjectDistanceRange : {\r\n            0 : \"Unknown\",\r\n            1 : \"Macro\",\r\n            2 : \"Close view\",\r\n            3 : \"Distant view\"\r\n        },\r\n        FileSource : {\r\n            3 : \"DSC\"\r\n        },\r\n\r\n        Components : {\r\n            0 : \"\",\r\n            1 : \"Y\",\r\n            2 : \"Cb\",\r\n            3 : \"Cr\",\r\n            4 : \"R\",\r\n            5 : \"G\",\r\n            6 : \"B\"\r\n        }\r\n    };\r\n\r\n    function addEvent(element, event, handler) {\r\n        if (element.addEventListener) {\r\n            element.addEventListener(event, handler, false);\r\n        } else if (element.attachEvent) {\r\n            element.attachEvent(\"on\" + event, handler);\r\n        }\r\n    }\r\n\r\n    function imageHasData(img) {\r\n        return !!(img.exifdata);\r\n    }\r\n\r\n\r\n    function base64ToArrayBuffer(base64, contentType) {\r\n        contentType = contentType || base64.match(/^data\\:([^\\;]+)\\;base64,/mi)[1] || ''; // e.g. 'data:image/jpeg;base64,...' => 'image/jpeg'\r\n        base64 = base64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\r\n        var binary = atob(base64);\r\n        var len = binary.length;\r\n        var buffer = new ArrayBuffer(len);\r\n        var view = new Uint8Array(buffer);\r\n        for (var i = 0; i < len; i++) {\r\n            view[i] = binary.charCodeAt(i);\r\n        }\r\n        return buffer;\r\n    }\r\n\r\n    function objectURLToBlob(url, callback) {\r\n        var http = new XMLHttpRequest();\r\n        http.open(\"GET\", url, true);\r\n        http.responseType = \"blob\";\r\n        http.onload = function(e) {\r\n            if (this.status == 200 || this.status === 0) {\r\n                callback(this.response);\r\n            }\r\n        };\r\n        http.send();\r\n    }\r\n\r\n    function getImageData(img, callback) {\r\n        function handleBinaryFile(binFile) {\r\n            var data = findEXIFinJPEG(binFile);\r\n            var iptcdata = findIPTCinJPEG(binFile);\r\n            var xmpdata= findXMPinJPEG(binFile);\r\n            img.exifdata = data || {};\r\n            img.iptcdata = iptcdata || {};\r\n            img.xmpdata = xmpdata || {};\r\n            if (callback) {\r\n                callback.call(img);\r\n            }\r\n        }\r\n\r\n        if (img.src) {\r\n            if (/^data\\:/i.test(img.src)) { // Data URI\r\n                var arrayBuffer = base64ToArrayBuffer(img.src);\r\n                handleBinaryFile(arrayBuffer);\r\n\r\n            } else if (/^blob\\:/i.test(img.src)) { // Object URL\r\n                var fileReader = new FileReader();\r\n                fileReader.onload = function(e) {\r\n                    handleBinaryFile(e.target.result);\r\n                };\r\n                objectURLToBlob(img.src, function (blob) {\r\n                    fileReader.readAsArrayBuffer(blob);\r\n                });\r\n            } else {\r\n                var http = new XMLHttpRequest();\r\n                http.onload = function() {\r\n                    if (this.status == 200 || this.status === 0) {\r\n                        handleBinaryFile(http.response);\r\n                    } else {\r\n                        throw \"Could not load image\";\r\n                    }\r\n                    http = null;\r\n                };\r\n                http.open(\"GET\", img.src, true);\r\n                http.responseType = \"arraybuffer\";\r\n                http.send(null);\r\n            }\r\n        } else if (self.FileReader && (img instanceof self.Blob || img instanceof self.File)) {\r\n            var fileReader = new FileReader();\r\n            fileReader.onload = function(e) {\r\n                if (debug) console.log(\"Got file of length \" + e.target.result.byteLength);\r\n                handleBinaryFile(e.target.result);\r\n            };\r\n\r\n            fileReader.readAsArrayBuffer(img);\r\n        }\r\n    }\r\n\r\n    function findEXIFinJPEG(file) {\r\n        var dataView = new DataView(file);\r\n\r\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\r\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\r\n            if (debug) console.log(\"Not a valid JPEG\");\r\n            return false; // not a valid jpeg\r\n        }\r\n\r\n        var offset = 2,\r\n            length = file.byteLength,\r\n            marker;\r\n\r\n        while (offset < length) {\r\n            if (dataView.getUint8(offset) != 0xFF) {\r\n                if (debug) console.log(\"Not a valid marker at offset \" + offset + \", found: \" + dataView.getUint8(offset));\r\n                return false; // not a valid marker, something is wrong\r\n            }\r\n\r\n            marker = dataView.getUint8(offset + 1);\r\n            if (debug) console.log(marker);\r\n\r\n            // we could implement handling for other markers here,\r\n            // but we're only looking for 0xFFE1 for EXIF data\r\n\r\n            if (marker == 225) {\r\n                if (debug) console.log(\"Found 0xFFE1 marker\");\r\n\r\n                return readEXIFData(dataView, offset + 4, dataView.getUint16(offset + 2) - 2);\r\n\r\n                // offset += 2 + file.getShortAt(offset+2, true);\r\n\r\n            } else {\r\n                offset += 2 + dataView.getUint16(offset+2);\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    function findIPTCinJPEG(file) {\r\n        var dataView = new DataView(file);\r\n\r\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\r\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\r\n            if (debug) console.log(\"Not a valid JPEG\");\r\n            return false; // not a valid jpeg\r\n        }\r\n\r\n        var offset = 2,\r\n            length = file.byteLength;\r\n\r\n\r\n        var isFieldSegmentStart = function(dataView, offset){\r\n            return (\r\n                dataView.getUint8(offset) === 0x38 &&\r\n                dataView.getUint8(offset+1) === 0x42 &&\r\n                dataView.getUint8(offset+2) === 0x49 &&\r\n                dataView.getUint8(offset+3) === 0x4D &&\r\n                dataView.getUint8(offset+4) === 0x04 &&\r\n                dataView.getUint8(offset+5) === 0x04\r\n            );\r\n        };\r\n\r\n        while (offset < length) {\r\n\r\n            if ( isFieldSegmentStart(dataView, offset )){\r\n\r\n                // Get the length of the name header (which is padded to an even number of bytes)\r\n                var nameHeaderLength = dataView.getUint8(offset+7);\r\n                if(nameHeaderLength % 2 !== 0) nameHeaderLength += 1;\r\n                // Check for pre photoshop 6 format\r\n                if(nameHeaderLength === 0) {\r\n                    // Always 4\r\n                    nameHeaderLength = 4;\r\n                }\r\n\r\n                var startOffset = offset + 8 + nameHeaderLength;\r\n                var sectionLength = dataView.getUint16(offset + 6 + nameHeaderLength);\r\n\r\n                return readIPTCData(file, startOffset, sectionLength);\r\n\r\n                break;\r\n\r\n            }\r\n\r\n\r\n            // Not the marker, continue searching\r\n            offset++;\r\n\r\n        }\r\n\r\n    }\r\n    var IptcFieldMap = {\r\n        0x78 : 'caption',\r\n        0x6E : 'credit',\r\n        0x19 : 'keywords',\r\n        0x37 : 'dateCreated',\r\n        0x50 : 'byline',\r\n        0x55 : 'bylineTitle',\r\n        0x7A : 'captionWriter',\r\n        0x69 : 'headline',\r\n        0x74 : 'copyright',\r\n        0x0F : 'category'\r\n    };\r\n    function readIPTCData(file, startOffset, sectionLength){\r\n        var dataView = new DataView(file);\r\n        var data = {};\r\n        var fieldValue, fieldName, dataSize, segmentType, segmentSize;\r\n        var segmentStartPos = startOffset;\r\n        while(segmentStartPos < startOffset+sectionLength) {\r\n            if(dataView.getUint8(segmentStartPos) === 0x1C && dataView.getUint8(segmentStartPos+1) === 0x02){\r\n                segmentType = dataView.getUint8(segmentStartPos+2);\r\n                if(segmentType in IptcFieldMap) {\r\n                    dataSize = dataView.getInt16(segmentStartPos+3);\r\n                    segmentSize = dataSize + 5;\r\n                    fieldName = IptcFieldMap[segmentType];\r\n                    fieldValue = getStringFromDB(dataView, segmentStartPos+5, dataSize);\r\n                    // Check if we already stored a value with this name\r\n                    if(data.hasOwnProperty(fieldName)) {\r\n                        // Value already stored with this name, create multivalue field\r\n                        if(data[fieldName] instanceof Array) {\r\n                            data[fieldName].push(fieldValue);\r\n                        }\r\n                        else {\r\n                            data[fieldName] = [data[fieldName], fieldValue];\r\n                        }\r\n                    }\r\n                    else {\r\n                        data[fieldName] = fieldValue;\r\n                    }\r\n                }\r\n\r\n            }\r\n            segmentStartPos++;\r\n        }\r\n        return data;\r\n    }\r\n\r\n\r\n\r\n    function readTags(file, tiffStart, dirStart, strings, bigEnd) {\r\n        var entries = file.getUint16(dirStart, !bigEnd),\r\n            tags = {},\r\n            entryOffset, tag,\r\n            i;\r\n\r\n        for (i=0;i<entries;i++) {\r\n            entryOffset = dirStart + i*12 + 2;\r\n            tag = strings[file.getUint16(entryOffset, !bigEnd)];\r\n            if (!tag && debug) console.log(\"Unknown tag: \" + file.getUint16(entryOffset, !bigEnd));\r\n            tags[tag] = readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd);\r\n        }\r\n        return tags;\r\n    }\r\n\r\n\r\n    function readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd) {\r\n        var type = file.getUint16(entryOffset+2, !bigEnd),\r\n            numValues = file.getUint32(entryOffset+4, !bigEnd),\r\n            valueOffset = file.getUint32(entryOffset+8, !bigEnd) + tiffStart,\r\n            offset,\r\n            vals, val, n,\r\n            numerator, denominator;\r\n\r\n        switch (type) {\r\n            case 1: // byte, 8-bit unsigned int\r\n            case 7: // undefined, 8-bit byte, value depending on field\r\n                if (numValues == 1) {\r\n                    return file.getUint8(entryOffset + 8, !bigEnd);\r\n                } else {\r\n                    offset = numValues > 4 ? valueOffset : (entryOffset + 8);\r\n                    vals = [];\r\n                    for (n=0;n<numValues;n++) {\r\n                        vals[n] = file.getUint8(offset + n);\r\n                    }\r\n                    return vals;\r\n                }\r\n\r\n            case 2: // ascii, 8-bit byte\r\n                offset = numValues > 4 ? valueOffset : (entryOffset + 8);\r\n                return getStringFromDB(file, offset, numValues-1);\r\n\r\n            case 3: // short, 16 bit int\r\n                if (numValues == 1) {\r\n                    return file.getUint16(entryOffset + 8, !bigEnd);\r\n                } else {\r\n                    offset = numValues > 2 ? valueOffset : (entryOffset + 8);\r\n                    vals = [];\r\n                    for (n=0;n<numValues;n++) {\r\n                        vals[n] = file.getUint16(offset + 2*n, !bigEnd);\r\n                    }\r\n                    return vals;\r\n                }\r\n\r\n            case 4: // long, 32 bit int\r\n                if (numValues == 1) {\r\n                    return file.getUint32(entryOffset + 8, !bigEnd);\r\n                } else {\r\n                    vals = [];\r\n                    for (n=0;n<numValues;n++) {\r\n                        vals[n] = file.getUint32(valueOffset + 4*n, !bigEnd);\r\n                    }\r\n                    return vals;\r\n                }\r\n\r\n            case 5:    // rational = two long values, first is numerator, second is denominator\r\n                if (numValues == 1) {\r\n                    numerator = file.getUint32(valueOffset, !bigEnd);\r\n                    denominator = file.getUint32(valueOffset+4, !bigEnd);\r\n                    val = new Number(numerator / denominator);\r\n                    val.numerator = numerator;\r\n                    val.denominator = denominator;\r\n                    return val;\r\n                } else {\r\n                    vals = [];\r\n                    for (n=0;n<numValues;n++) {\r\n                        numerator = file.getUint32(valueOffset + 8*n, !bigEnd);\r\n                        denominator = file.getUint32(valueOffset+4 + 8*n, !bigEnd);\r\n                        vals[n] = new Number(numerator / denominator);\r\n                        vals[n].numerator = numerator;\r\n                        vals[n].denominator = denominator;\r\n                    }\r\n                    return vals;\r\n                }\r\n\r\n            case 9: // slong, 32 bit signed int\r\n                if (numValues == 1) {\r\n                    return file.getInt32(entryOffset + 8, !bigEnd);\r\n                } else {\r\n                    vals = [];\r\n                    for (n=0;n<numValues;n++) {\r\n                        vals[n] = file.getInt32(valueOffset + 4*n, !bigEnd);\r\n                    }\r\n                    return vals;\r\n                }\r\n\r\n            case 10: // signed rational, two slongs, first is numerator, second is denominator\r\n                if (numValues == 1) {\r\n                    return file.getInt32(valueOffset, !bigEnd) / file.getInt32(valueOffset+4, !bigEnd);\r\n                } else {\r\n                    vals = [];\r\n                    for (n=0;n<numValues;n++) {\r\n                        vals[n] = file.getInt32(valueOffset + 8*n, !bigEnd) / file.getInt32(valueOffset+4 + 8*n, !bigEnd);\r\n                    }\r\n                    return vals;\r\n                }\r\n        }\r\n    }\r\n\r\n    /**\r\n    * Given an IFD (Image File Directory) start offset\r\n    * returns an offset to next IFD or 0 if it's the last IFD.\r\n    */\r\n    function getNextIFDOffset(dataView, dirStart, bigEnd){\r\n        //the first 2bytes means the number of directory entries contains in this IFD\r\n        var entries = dataView.getUint16(dirStart, !bigEnd);\r\n\r\n        // After last directory entry, there is a 4bytes of data,\r\n        // it means an offset to next IFD.\r\n        // If its value is '0x00000000', it means this is the last IFD and there is no linked IFD.\r\n\r\n        return dataView.getUint32(dirStart + 2 + entries * 12, !bigEnd); // each entry is 12 bytes long\r\n    }\r\n\r\n    function readThumbnailImage(dataView, tiffStart, firstIFDOffset, bigEnd){\r\n        // get the IFD1 offset\r\n        var IFD1OffsetPointer = getNextIFDOffset(dataView, tiffStart+firstIFDOffset, bigEnd);\r\n\r\n        if (!IFD1OffsetPointer) {\r\n            // console.log('******** IFD1Offset is empty, image thumb not found ********');\r\n            return {};\r\n        }\r\n        else if (IFD1OffsetPointer > dataView.byteLength) { // this should not happen\r\n            // console.log('******** IFD1Offset is outside the bounds of the DataView ********');\r\n            return {};\r\n        }\r\n        // console.log('*******  thumbnail IFD offset (IFD1) is: %s', IFD1OffsetPointer);\r\n\r\n        var thumbTags = readTags(dataView, tiffStart, tiffStart + IFD1OffsetPointer, IFD1Tags, bigEnd)\r\n\r\n        // EXIF 2.3 specification for JPEG format thumbnail\r\n\r\n        // If the value of Compression(0x0103) Tag in IFD1 is '6', thumbnail image format is JPEG.\r\n        // Most of Exif image uses JPEG format for thumbnail. In that case, you can get offset of thumbnail\r\n        // by JpegIFOffset(0x0201) Tag in IFD1, size of thumbnail by JpegIFByteCount(0x0202) Tag.\r\n        // Data format is ordinary JPEG format, starts from 0xFFD8 and ends by 0xFFD9. It seems that\r\n        // JPEG format and 160x120pixels of size are recommended thumbnail format for Exif2.1 or later.\r\n\r\n        if (thumbTags['Compression']) {\r\n            // console.log('Thumbnail image found!');\r\n\r\n            switch (thumbTags['Compression']) {\r\n                case 6:\r\n                    // console.log('Thumbnail image format is JPEG');\r\n                    if (thumbTags.JpegIFOffset && thumbTags.JpegIFByteCount) {\r\n                    // extract the thumbnail\r\n                        var tOffset = tiffStart + thumbTags.JpegIFOffset;\r\n                        var tLength = thumbTags.JpegIFByteCount;\r\n                        thumbTags['blob'] = new Blob([new Uint8Array(dataView.buffer, tOffset, tLength)], {\r\n                            type: 'image/jpeg'\r\n                        });\r\n                    }\r\n                break;\r\n\r\n            case 1:\r\n                console.log(\"Thumbnail image format is TIFF, which is not implemented.\");\r\n                break;\r\n            default:\r\n                console.log(\"Unknown thumbnail image format '%s'\", thumbTags['Compression']);\r\n            }\r\n        }\r\n        else if (thumbTags['PhotometricInterpretation'] == 2) {\r\n            console.log(\"Thumbnail image format is RGB, which is not implemented.\");\r\n        }\r\n        return thumbTags;\r\n    }\r\n\r\n    function getStringFromDB(buffer, start, length) {\r\n        var outstr = \"\";\r\n        for (var n = start; n < start+length; n++) {\r\n            outstr += String.fromCharCode(buffer.getUint8(n));\r\n        }\r\n        return outstr;\r\n    }\r\n\r\n    function readEXIFData(file, start) {\r\n        if (getStringFromDB(file, start, 4) != \"Exif\") {\r\n            if (debug) console.log(\"Not valid EXIF data! \" + getStringFromDB(file, start, 4));\r\n            return false;\r\n        }\r\n\r\n        var bigEnd,\r\n            tags, tag,\r\n            exifData, gpsData,\r\n            tiffOffset = start + 6;\r\n\r\n        // test for TIFF validity and endianness\r\n        if (file.getUint16(tiffOffset) == 0x4949) {\r\n            bigEnd = false;\r\n        } else if (file.getUint16(tiffOffset) == 0x4D4D) {\r\n            bigEnd = true;\r\n        } else {\r\n            if (debug) console.log(\"Not valid TIFF data! (no 0x4949 or 0x4D4D)\");\r\n            return false;\r\n        }\r\n\r\n        if (file.getUint16(tiffOffset+2, !bigEnd) != 0x002A) {\r\n            if (debug) console.log(\"Not valid TIFF data! (no 0x002A)\");\r\n            return false;\r\n        }\r\n\r\n        var firstIFDOffset = file.getUint32(tiffOffset+4, !bigEnd);\r\n\r\n        if (firstIFDOffset < 0x00000008) {\r\n            if (debug) console.log(\"Not valid TIFF data! (First offset less than 8)\", file.getUint32(tiffOffset+4, !bigEnd));\r\n            return false;\r\n        }\r\n\r\n        tags = readTags(file, tiffOffset, tiffOffset + firstIFDOffset, TiffTags, bigEnd);\r\n\r\n        if (tags.ExifIFDPointer) {\r\n            exifData = readTags(file, tiffOffset, tiffOffset + tags.ExifIFDPointer, ExifTags, bigEnd);\r\n            for (tag in exifData) {\r\n                switch (tag) {\r\n                    case \"LightSource\" :\r\n                    case \"Flash\" :\r\n                    case \"MeteringMode\" :\r\n                    case \"ExposureProgram\" :\r\n                    case \"SensingMethod\" :\r\n                    case \"SceneCaptureType\" :\r\n                    case \"SceneType\" :\r\n                    case \"CustomRendered\" :\r\n                    case \"WhiteBalance\" :\r\n                    case \"GainControl\" :\r\n                    case \"Contrast\" :\r\n                    case \"Saturation\" :\r\n                    case \"Sharpness\" :\r\n                    case \"SubjectDistanceRange\" :\r\n                    case \"FileSource\" :\r\n                        exifData[tag] = StringValues[tag][exifData[tag]];\r\n                        break;\r\n\r\n                    case \"ExifVersion\" :\r\n                    case \"FlashpixVersion\" :\r\n                        exifData[tag] = String.fromCharCode(exifData[tag][0], exifData[tag][1], exifData[tag][2], exifData[tag][3]);\r\n                        break;\r\n\r\n                    case \"ComponentsConfiguration\" :\r\n                        exifData[tag] =\r\n                            StringValues.Components[exifData[tag][0]] +\r\n                            StringValues.Components[exifData[tag][1]] +\r\n                            StringValues.Components[exifData[tag][2]] +\r\n                            StringValues.Components[exifData[tag][3]];\r\n                        break;\r\n                }\r\n                tags[tag] = exifData[tag];\r\n            }\r\n        }\r\n\r\n        if (tags.GPSInfoIFDPointer) {\r\n            gpsData = readTags(file, tiffOffset, tiffOffset + tags.GPSInfoIFDPointer, GPSTags, bigEnd);\r\n            for (tag in gpsData) {\r\n                switch (tag) {\r\n                    case \"GPSVersionID\" :\r\n                        gpsData[tag] = gpsData[tag][0] +\r\n                            \".\" + gpsData[tag][1] +\r\n                            \".\" + gpsData[tag][2] +\r\n                            \".\" + gpsData[tag][3];\r\n                        break;\r\n                }\r\n                tags[tag] = gpsData[tag];\r\n            }\r\n        }\r\n\r\n        // extract thumbnail\r\n        tags['thumbnail'] = readThumbnailImage(file, tiffOffset, firstIFDOffset, bigEnd);\r\n\r\n        return tags;\r\n    }\r\n\r\n   function findXMPinJPEG(file) {\r\n\r\n        if (!('DOMParser' in self)) {\r\n            // console.warn('XML parsing not supported without DOMParser');\r\n            return;\r\n        }\r\n        var dataView = new DataView(file);\r\n\r\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\r\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\r\n           if (debug) console.log(\"Not a valid JPEG\");\r\n           return false; // not a valid jpeg\r\n        }\r\n\r\n        var offset = 2,\r\n            length = file.byteLength,\r\n            dom = new DOMParser();\r\n\r\n        while (offset < (length-4)) {\r\n            if (getStringFromDB(dataView, offset, 4) == \"http\") {\r\n                var startOffset = offset - 1;\r\n                var sectionLength = dataView.getUint16(offset - 2) - 1;\r\n                var xmpString = getStringFromDB(dataView, startOffset, sectionLength)\r\n                var xmpEndIndex = xmpString.indexOf('xmpmeta>') + 8;\r\n                xmpString = xmpString.substring( xmpString.indexOf( '<x:xmpmeta' ), xmpEndIndex );\r\n\r\n                var indexOfXmp = xmpString.indexOf('x:xmpmeta') + 10\r\n                //Many custom written programs embed xmp/xml without any namespace. Following are some of them.\r\n                //Without these namespaces, XML is thought to be invalid by parsers\r\n                xmpString = xmpString.slice(0, indexOfXmp)\r\n                            + 'xmlns:Iptc4xmpCore=\"http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/\" '\r\n                            + 'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" '\r\n                            + 'xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\" '\r\n                            + 'xmlns:plus=\"http://schemas.android.com/apk/lib/com.google.android.gms.plus\" '\r\n                            + 'xmlns:ext=\"http://www.gettyimages.com/xsltExtension/1.0\" '\r\n                            + 'xmlns:exif=\"http://ns.adobe.com/exif/1.0/\" '\r\n                            + 'xmlns:stEvt=\"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#\" '\r\n                            + 'xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/ResourceRef#\" '\r\n                            + 'xmlns:crs=\"http://ns.adobe.com/camera-raw-settings/1.0/\" '\r\n                            + 'xmlns:xapGImg=\"http://ns.adobe.com/xap/1.0/g/img/\" '\r\n                            + 'xmlns:Iptc4xmpExt=\"http://iptc.org/std/Iptc4xmpExt/2008-02-29/\" '\r\n                            + xmpString.slice(indexOfXmp)\r\n\r\n                var domDocument = dom.parseFromString( xmpString, 'text/xml' );\r\n                return xml2Object(domDocument);\r\n            } else{\r\n             offset++;\r\n            }\r\n        }\r\n    }\r\n\r\n    function xml2Object(xml) {\r\n        try {\r\n            var obj = {};\r\n            if (xml.children.length > 0) {\r\n              for (var i = 0; i < xml.children.length; i++) {\r\n                var item = xml.children.item(i);\r\n                var attributes = item.attributes;\r\n                for(var idx in attributes) {\r\n                    var itemAtt = attributes[idx];\r\n                    var dataKey = itemAtt.nodeName;\r\n                    var dataValue = itemAtt.nodeValue;\r\n\r\n                    if(dataKey !== undefined) {\r\n                        obj[dataKey] = dataValue;\r\n                    }\r\n                }\r\n                var nodeName = item.nodeName;\r\n\r\n                if (typeof (obj[nodeName]) == \"undefined\") {\r\n                  obj[nodeName] = xml2json(item);\r\n                } else {\r\n                  if (typeof (obj[nodeName].push) == \"undefined\") {\r\n                    var old = obj[nodeName];\r\n\r\n                    obj[nodeName] = [];\r\n                    obj[nodeName].push(old);\r\n                  }\r\n                  obj[nodeName].push(xml2json(item));\r\n                }\r\n              }\r\n            } else {\r\n              obj = xml.textContent;\r\n            }\r\n            return obj;\r\n          } catch (e) {\r\n              console.log(e.message);\r\n          }\r\n    }\r\n\r\n    EXIF.getData = function(img, callback) {\r\n        if (((self.Image && img instanceof self.Image)\r\n            || (self.HTMLImageElement && img instanceof self.HTMLImageElement))\r\n            && !img.complete)\r\n            return false;\r\n\r\n        if (!imageHasData(img)) {\r\n            getImageData(img, callback);\r\n        } else {\r\n            if (callback) {\r\n                callback.call(img);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    EXIF.getTag = function(img, tag) {\r\n        if (!imageHasData(img)) return;\r\n        return img.exifdata[tag];\r\n    }\r\n    \r\n    EXIF.getIptcTag = function(img, tag) {\r\n        if (!imageHasData(img)) return;\r\n        return img.iptcdata[tag];\r\n    }\r\n\r\n    EXIF.getAllTags = function(img) {\r\n        if (!imageHasData(img)) return {};\r\n        var a,\r\n            data = img.exifdata,\r\n            tags = {};\r\n        for (a in data) {\r\n            if (data.hasOwnProperty(a)) {\r\n                tags[a] = data[a];\r\n            }\r\n        }\r\n        return tags;\r\n    }\r\n    \r\n    EXIF.getAllIptcTags = function(img) {\r\n        if (!imageHasData(img)) return {};\r\n        var a,\r\n            data = img.iptcdata,\r\n            tags = {};\r\n        for (a in data) {\r\n            if (data.hasOwnProperty(a)) {\r\n                tags[a] = data[a];\r\n            }\r\n        }\r\n        return tags;\r\n    }\r\n\r\n    EXIF.pretty = function(img) {\r\n        if (!imageHasData(img)) return \"\";\r\n        var a,\r\n            data = img.exifdata,\r\n            strPretty = \"\";\r\n        for (a in data) {\r\n            if (data.hasOwnProperty(a)) {\r\n                if (typeof data[a] == \"object\") {\r\n                    if (data[a] instanceof Number) {\r\n                        strPretty += a + \" : \" + data[a] + \" [\" + data[a].numerator + \"/\" + data[a].denominator + \"]\\r\\n\";\r\n                    } else {\r\n                        strPretty += a + \" : [\" + data[a].length + \" values]\\r\\n\";\r\n                    }\r\n                } else {\r\n                    strPretty += a + \" : \" + data[a] + \"\\r\\n\";\r\n                }\r\n            }\r\n        }\r\n        return strPretty;\r\n    }\r\n\r\n    EXIF.readFromBinaryFile = function(file) {\r\n        return findEXIFinJPEG(file);\r\n    }\r\n\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('exif-js', [], function() {\r\n            return EXIF;\r\n        });\r\n    }\r\n}.call(this));\r\n\r\n(function (Alvin) {\r\n\tif (!Alvin.MBC)\r\n\t\tAlvin.MBC = {};\r\n\r\n\tvar lib = Alvin.MBC.Lib = {};\r\n\r\n\tlib.getElDimensions = function (el) {\r\n\t\tvar displayFormat, elDimensions;\r\n\r\n\t\tif (!el) return false;\r\n\r\n\t\tdisplayFormat = el.style.display;\r\n\r\n\t\tel.style.display = '';\r\n\r\n\t\telDimensions = \r\n\t\t{\r\n\t\t\tclientTop: el.clientTop, \r\n\t\t\tclientLeft: el.clientLeft,\r\n\t\t\tclientWidth: el.clientWidth ? el.clientWidth : (parseInt(el.style.width) ? parseInt(el.style.width) : 0),\r\n\t\t\tclientHeight: el.clientHeight ? el.clientHeight : (parseInt(el.style.height) ? parseInt(el.style.height) : 0)\r\n\t\t};\r\n\r\n\t\tel.style.display = displayFormat;\r\n\r\n\t\treturn elDimensions;\r\n\t}\r\n\r\n\tlib.hasClass = function(obj,cls) {  \r\n\t\treturn obj.className.match(new RegExp('(\\\\s|^)' + cls + '(\\\\s|$)'));  \r\n\t};  \r\n\r\n\tlib.addClass = function(obj,cls) {  \r\n\t\tif (!this.hasClass(obj,cls)) obj.className += cls;  \r\n\t}  \r\n\r\n\tlib.removeClass = function(obj,cls) {  \r\n\t\tif (this.hasClass(obj,cls)) {  \r\n\t\t\tvar reg = new RegExp('(\\\\s|^)' + cls + '(\\\\s|$)');  \r\n\t\t\tobj.className = obj.className.replace(reg, ' ');  \r\n\t\t}  \r\n\t}; \r\n\r\n\tlib.toggleClass = function(obj,cls){  \r\n\t    if(this.hasClass(obj,cls)){  \r\n\t        this.removeClass(obj,cls);  \r\n\t    }else{  \r\n\t        this.addClass(obj,cls);  \r\n\t    }  \r\n\t};\r\n\r\n\tlib.isNumber = function (val) {\r\n\t\tif(val === \"\" || val ==null){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif(!isNaN(val)){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tlib.each = function (object, fn, context) {\r\n        if (object) {\r\n            var key,\r\n                val,\r\n                keys,\r\n                i = 0,\r\n                length = object.length,\r\n                // do not use typeof obj == 'function': bug in phantomjs\r\n                isObj = lib.isUndefined(length) || lib.isFunction(object);\r\n\r\n            context = context || null;\r\n\r\n            if (isObj) {\r\n                keys = lib.keys(object);\r\n                for (; i < keys.length; i++) {\r\n                    key = keys[i];\r\n                    // can not use hasOwnProperty\r\n                    if (fn.call(context, object[key], key, object) === false) {\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                for (val = object[0];\r\n                    i < length; val = object[++i]) {\r\n                    if (fn.call(context, val, i, object) === false) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return object;\r\n\t};\r\n\r\n\tlib.isUndefined = function (exp) {\r\n\t\tif (typeof(exp) == \"undefined\")\r\n\t\t{\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t\r\n\tlib.isFunction = function (_fun) {\r\n\t\treturn _fun && typeof (_fun) === 'function';\r\n\t};\r\n\r\n\tvar hasEnumBug = !({ toString: 1 }.propertyIsEnumerable('toString')),\r\n        enumProperties = [\r\n            'constructor',\r\n            'hasOwnProperty',\r\n            'isPrototypeOf',\r\n            'propertyIsEnumerable',\r\n            'toString',\r\n            'toLocaleString',\r\n            'valueOf'\r\n        ];\r\n\t\t\r\n    function hasOwnProperty(o, p) {\r\n        return ({}).hasOwnProperty.call(o, p);\r\n\t}\r\n\t\r\n\tlib.keys = Object.keys || function(o) {\r\n        var result = [], p, i;\r\n\r\n        for (p in o) {\r\n            // lib.keys(new XX())\r\n            if (hasOwnProperty(o, p)) {\r\n                result.push(p);\r\n            }\r\n        }\r\n\r\n        if (hasEnumBug) {\r\n            for (i = enumProperties.length - 1; i >= 0; i--) {\r\n                p = enumProperties[i];\r\n                if (hasOwnProperty(o, p)) {\r\n                    result.push(p);\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n\t};\r\n\r\n\tlib.doCallbackNoBreak = function(callback, paras){\r\n\t\tif(callback){\r\n\t\t\ttry{\r\n\t\t\t\tcallback.apply(window, paras||[]);\r\n\t\t\t}\r\n\t\t\tcatch(ex){\r\n\t\t\t\tsetTimeout(function(){throw(ex);},0);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tlib.convertBase64ToBlob = function(base64Str, mimeType){\r\n\tvar byteCharacters = window.atob(base64Str);\r\n\tvar byteNumArr = new Array(byteCharacters.length);\r\n\tfor(var i=0; i < byteCharacters.length; ++i){\r\n\t\tbyteNumArr[i] = byteCharacters.charCodeAt(i);\r\n\t}\r\n\tvar uint8Arr = new Uint8Array(byteNumArr);\r\n\treturn new Blob([uint8Arr], {type: mimeType});\r\n\t};\r\n\r\n\tlib.convertURLToBlob = function(url, callback) {\r\n\tvar http = new XMLHttpRequest();\r\n\thttp.open(\"GET\", url, true);\r\n\thttp.responseType = \"blob\";\r\n\thttp.onloadend = function() {\r\n\t\tcallback(this.response);\r\n\t};\r\n\thttp.send();\r\n\t};\r\n\r\n\tlib.canvasToBlob = function(cvs, callback, mimeType, quality){\r\n\tif(cvs.toBlob){\r\n\t\tcvs.toBlob(callback, mimeType, quality);\r\n\t}else{\r\n\t\tvar b64str = cvs.toDataURL(mimeType, quality);\r\n\t\tvar blob = lib.convertBase64ToBlob(b64str.substring(b64str.indexOf(\",\")+1), mimeType);\r\n\t\tcallback(blob);\r\n\t}\r\n\t};\r\n\r\n\tlib.getBlobFromAnyImgData = function(imgData, callback){\r\n\tif(imgData instanceof Blob){\r\n\t\tcallback(imgData);\r\n\t}else if(imgData instanceof HTMLCanvasElement){\r\n\t\tlib.canvasToBlob(imgData, function(blob){\r\n\t\t\tcallback(blob);\r\n\t\t});\r\n\t}else if(typeof imgData == \"string\" || imgData instanceof String){\r\n\t\tvar url = imgData;\r\n\t\tif(\"data:\" == url.substring(0, 5)){ // url is base64\r\n\t\t\tvar mimeType = \"\";\r\n\t\t\tif(\"image/\" == url.substring(5, 11)){\r\n\t\t\t\tmimeType = url.substring(5, url.indexOf(\";\", 11));\r\n\t\t\t}\r\n\t\t\tvar blob = lib.convertBase64ToBlob(url.substring(url.indexOf(\"base64,\")+7), mimeType);\r\n\t\t\tcallback(blob);\r\n\t\t}else{ // url is link, such as 'https://....'\r\n\t\t\tlib.convertURLToBlob(url, function(blob){\r\n\t\t\t\tcallback(blob);\r\n\t\t\t});\r\n\t\t}\r\n\t}else if(imgData instanceof HTMLImageElement){\r\n\t\tvar src;\r\n\t\t//src maybe access denied\r\n\t\ttry{\r\n\t\t\tsrc = imgData.src;\r\n\t\t}catch(ex){\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tthrow(ex);\r\n\t\t\t},0);\r\n\t\t\tcallback(null, '');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// url not available, maybe network problem\r\n\t\t// use imgData -> canvas -> blob instand \r\n\t\tvar tCvs = document.createElement('canvas');\r\n\t\ttCvs.width = imgData.naturalWidth;\r\n\t\ttCvs.height = imgData.naturalHeight;\r\n\t\tvar ctx = tCvs.getContext('2d');\r\n\t\tctx.drawImage(imgData, 0, 0);\r\n\r\n\t\t// use suffix guess image mime type\r\n\t\tvar suffix = \"\";\r\n\t\tvar questionPos = src.lastIndexOf(\"?\");\r\n\t\tvar dotPos = -1;\r\n\t\tif(-1 != questionPos){\r\n\t\t\tdotPos = src.lastIndexOf(\".\", questionPos);\r\n\t\t\tif(-1 != dotPos && questionPos - dotPos <= 5){ //max supported type suffix is 4\r\n\t\t\t\tsuffix = src.substring(dotPos + 1, questionPos);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tdotPos = src.lastIndexOf(\".\");\r\n\t\t\tif(-1 != dotPos){\r\n\t\t\t\tif(src.length - dotPos <= 5){ //max supported type suffix is 4\r\n\t\t\t\t\tsuffix = src.substring(dotPos + 1);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tsuffix = src.substring(dotPos + 1, dotPos + 5);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar saveFormat;\r\n\t\tif(-1 != suffix.indexOf(\"webp\")){\r\n\t\t\tsaveFormat = \"image/webp\";\r\n\t\t}else if(-1 != suffix.indexOf(\"png\") || -1 != suffix.indexOf(\"gif\") || -1 != suffix.indexOf(\"svg\")){\r\n\t\t\tsaveFormat = \"image/png\";\r\n\t\t}else{ // like jpeg\r\n\t\t\tsaveFormat = \"image/jpeg\";\r\n\t\t}\r\n\r\n\t\tlib.canvasToBlob(tCvs, function(blob){\r\n\t\t\tcallback(blob);\r\n\t\t}, saveFormat);    \r\n\r\n\t}else{\r\n\t\t//not support\r\n\t\tcallback(null);\r\n\t}\r\n\r\n\t};\r\n\r\n\tlib.addEvent = function(obj,type,handle){\r\n\t\tvar typeAry = type.split(' ');\r\n\t\tif(!obj.length){\r\n\t\t\tfor(var j=0;j<typeAry.length;j++){\r\n\t\t\t\tobj.addEventListener ? obj.addEventListener(typeAry[j],handle,false) : obj.attachEvent(\"on\"+typeAry[j],handle);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tfor(var i=0;i<obj.length;i++){\r\n\t\t\t\tfor(var j=0;j<typeAry.length;j++){\r\n\t\t\t\t\tobj[i].addEventListener ? obj[i].addEventListener(typeAry[j],handle,false) : obj[i].attachEvent(\"on\"+typeAry[j],handle);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tlib.removeEvent = function(obj,type,handle){\r\n\t\tvar typeAry = type.split(' ');\r\n\t\tif(!obj.length){\r\n\t\t\tfor(var j=0;j<typeAry.length;j++){\r\n\t\t\t\tobj.removeEventListener ? obj.removeEventListener(typeAry[j],handle,false) : obj.detachEvent(\"on\"+typeAry[j],handle);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tfor(var i=0;i<obj.length;i++){\r\n\t\t\t\tfor(var j=0;j<typeAry.length;j++){\r\n\t\t\t\t\tobj[i].removeEventListener ? obj[i].removeEventListener(typeAry[j],handle,false) : obj[i].detachEvent(\"on\"+typeAry[j],handle);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tlib.stopDefault = function(e){\r\n\t\tif ( e && e.preventDefault ){ \r\n\t\t\te.preventDefault();\r\n\t\t} else { \r\n\t\t\twindow.event.returnValue = false;\r\n\t\t}\r\n\t};\r\n\r\n\tlib._querySelectorAll = function(element, selector){\r\n\t\tvar idAllocator = 10000;\r\n\t\tif (element.querySelectorAll){\r\n\t\t\treturn element.querySelectorAll(selector);\r\n\t\t}else {\r\n\t\t\tvar needsID = element.id === \"\";\r\n\t\t\tif (needsID) {\r\n\t\t\t\t++idAllocator;\r\n\t\t\t\telement.id = \"__qsa\" + idAllocator;\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\treturn document.querySelectorAll(\"#\" + element.id + \" \" + selector);\r\n\t\t\t}\r\n\t\t\tfinally {\r\n\t\t\t\tif (needsID) {\r\n\t\t\t\t\telement.id = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tlib.fireEvent = function (name, el) {\r\n\t\tvar event;\r\n\t\tif (document.createEvent) {\r\n\t\t\tevent = document.createEvent('HTMLEvents');\r\n\t\t\tevent.initEvent(name, true, true);\r\n\r\n\t\t\tif (el.dispatchEvent)\r\n\t\t\t\tel.dispatchEvent(event);\r\n\t\t}\r\n\t\telse if (document.createEventObject) {\r\n\t\t\tevent = document.createEventObject();\r\n\t\t\tevent.bubbles = true;\r\n\t\t\tevent.cancelable = true;\r\n\t\t\tel.fireEvent(name, event);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tevent = new Event(name);\r\n\t\t\tif (el.dispatchEvent)\r\n\t\t\t\tel.dispatchEvent(event);\r\n\t\t}\r\n\t}\r\n\r\n\t//indexOf() do not compatible with IE6-8\r\n\tif(!Array.prototype.indexOf){  \r\n\t\tArray.prototype.indexOf = function(val){  \r\n\t\t\tvar value = this;  \r\n\t\t\tfor(var i =0; i < value.length; i++){  \r\n\t\t\t\tif(value[i] == val) return i;  \r\n\t\t\t}  \r\n\t\t\treturn -1;  \r\n\t\t};  \r\n\t}\r\n\r\n\t// querySelector & querySelectorAll do not compatible with IE6-7\r\n\tif (!document.querySelectorAll) {\r\n\t\tdocument.querySelectorAll = function (selectors) {\r\n\t\t\tvar style = document.createElement('style'), elements = [], element;\r\n\t\t\tdocument.documentElement.firstChild.appendChild(style);\r\n\t\t\tdocument._qsa = [];\r\n\r\n\t\t\tstyle.styleSheet.cssText = selectors + '{x-qsa:expression(document._qsa && document._qsa.push(this))}';\r\n\t\t\twindow.scrollBy(0, 0);\r\n\t\t\tstyle.parentNode.removeChild(style);\r\n\r\n\t\t\twhile (document._qsa.length) {\r\n\t\t\t\telement = document._qsa.shift();\r\n\t\t\t\telement.style.removeAttribute('x-qsa');\r\n\t\t\t\telements.push(element);\r\n\t\t\t}\r\n\t\t\tdocument._qsa = null;\r\n\t\t\treturn elements;\r\n\t\t};\r\n\t}\r\n\r\n\tif (!document.querySelector) {\r\n\t\tdocument.querySelector = function (selectors) {\r\n\t\t\tvar elements = document.querySelectorAll(selectors);\r\n\t\t\treturn (elements.length) ? elements[0] : null;\r\n\t\t};\r\n\t}\r\n\r\n\tlib.mix = function (dest, source) {\r\n\t\tfor (var i in source) {\r\n\t\t\tif (source.hasOwnProperty(i)) {\r\n\t\t\t\tdest[i] = source[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn dest;\r\n\t}\r\n\r\n\t// global errors\r\n\tlib.Errors = {\r\n\t\tSucess: function (obj) {\r\n\t\t\tobj._errorCode = 0;\r\n\t\t\tobj._errorString = 'Successful.';\r\n\t\t},\r\n\t\tIndexOutOfRange: function (obj) {\r\n\t\t\tobj._errorCode = -1000;\r\n\t\t\tobj._errorString = 'The index is out of range.';\r\n\t\t},\r\n\t\tFucNotValidInThisMode: function (obj,fuc,mode) {\r\n\t\t\tobj._errorCode = -1001;\r\n\t\t\tobj._errorString = ''+fuc+'(): This function is not valid in '+mode+' mode.';\r\n\t\t},\r\n\t\tInvalidValue: function (obj) {\r\n\t\t\tobj._errorCode = -1002;\r\n\t\t\tobj._errorString = 'Invalid value.';\r\n\t\t},\r\n\t\tInvalidParameterType: function (obj) {\r\n\t\t\tobj._errorCode = -1003;\r\n\t\t\tobj._errorString = 'Parameter type is not supported.';\r\n\t\t},\r\n\r\n\t\t__last: false\r\n\t}\r\n\r\n\tlib.DEF = function (self, name, obj){\r\n\t\tObject.defineProperty(self, name, obj);\r\n\t}\r\n\r\n\tlib.attachProperty = function (st) {\r\n\t\tvar _this = st;\r\n\t\tvar DEF = lib.DEF;\r\n\r\n\t\tDEF(_this, 'ErrorCode', {\r\n\t\t\tget: function () {// read-only\r\n\t\t\t\treturn _this._errorCode;\r\n\t\t\t}\r\n\t\t});\r\n\t\tDEF(_this, 'ErrorString', {\r\n\t\t\tget: function () {// read-only\r\n\t\t\t\tif (_this._errorCode != 0) {\r\n\t\t\t\t\treturn _this._errorString;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn 'Successful.';\r\n\t\t\t}\r\n\t\t});\r\n\t\tDEF(_this, 'HowManyImagesInBuffer', {\r\n\t\t\tget: function () {\r\n\t\t\t\treturn _this.GetCount();\r\n\t\t\t}\r\n\t\t});\r\n\t\tDEF(_this, 'CurrentImageIndexInBuffer', {\r\n\t\t\tget: function () {\r\n\t\t\t\treturn _this.GetCurentIndex();\r\n\t\t\t},\r\n\t\t\tset: function (v) {\r\n\t\t\t\tvar _v = v * 1;\r\n\r\n\t\t\t\tif (_v >= 0 && _v < _this.GetCount()) {\r\n\t\t\t\t\t_this.ShowImage(_v);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n})(Alvin);/**\r\n * MIT https://github.com/lahmatiy/es6-promise-polyfill\r\n*/\r\n(function(global){\r\n\r\n//\r\n// Check for native Promise and it has correct interface\r\n//\r\n\r\nvar NativePromise = global['Promise'];\r\nvar nativePromiseSupported =\r\n  NativePromise &&\r\n  // Some of these methods are missing from\r\n  // Firefox/Chrome experimental implementations\r\n  'resolve' in NativePromise &&\r\n  'reject' in NativePromise &&\r\n  'all' in NativePromise &&\r\n  'race' in NativePromise &&\r\n  // Older version of the spec had a resolver object\r\n  // as the arg rather than a function\r\n  (function(){\r\n    var resolve;\r\n    new NativePromise(function(r){ resolve = r; });\r\n    return typeof resolve === 'function';\r\n  })();\r\n\r\n\r\n//\r\n// export if necessary\r\n//\r\n\r\nif (typeof exports !== 'undefined' && exports)\r\n{\r\n  // node.js\r\n  exports.Promise = nativePromiseSupported ? NativePromise : Promise;\r\n  exports.Polyfill = Promise;\r\n}\r\nelse\r\n{\r\n  // AMD\r\n  if (typeof define == 'function' && define.amd)\r\n  {\r\n    define(function(){\r\n      return nativePromiseSupported ? NativePromise : Promise;\r\n    });\r\n  }\r\n  else\r\n  {\r\n    // in browser add to global\r\n    if (!nativePromiseSupported)\r\n      global['Promise'] = Promise;\r\n  }\r\n}\r\n\r\n\r\n//\r\n// Polyfill\r\n//\r\n\r\nvar PENDING = 'pending';\r\nvar SEALED = 'sealed';\r\nvar FULFILLED = 'fulfilled';\r\nvar REJECTED = 'rejected';\r\nvar NOOP = function(){};\r\n\r\nfunction isArray(value) {\r\n  return Object.prototype.toString.call(value) === '[object Array]';\r\n}\r\n\r\n// async calls\r\nvar asyncSetTimer = typeof setImmediate !== 'undefined' ? setImmediate : setTimeout;\r\nvar asyncQueue = [];\r\nvar asyncTimer;\r\n\r\nfunction asyncFlush(){\r\n  // run promise callbacks\r\n  for (var i = 0; i < asyncQueue.length; i++)\r\n    asyncQueue[i][0](asyncQueue[i][1]);\r\n\r\n  // reset async asyncQueue\r\n  asyncQueue = [];\r\n  asyncTimer = false;\r\n}\r\n\r\nfunction asyncCall(callback, arg){\r\n  asyncQueue.push([callback, arg]);\r\n\r\n  if (!asyncTimer)\r\n  {\r\n    asyncTimer = true;\r\n    asyncSetTimer(asyncFlush, 0);\r\n  }\r\n}\r\n\r\n\r\nfunction invokeResolver(resolver, promise) {\r\n  function resolvePromise(value) {\r\n    resolve(promise, value);\r\n  }\r\n\r\n  function rejectPromise(reason) {\r\n    reject(promise, reason);\r\n  }\r\n\r\n  try {\r\n    resolver(resolvePromise, rejectPromise);\r\n  } catch(e) {\r\n    rejectPromise(e);\r\n  }\r\n}\r\n\r\nfunction invokeCallback(subscriber){\r\n  var owner = subscriber.owner;\r\n  var settled = owner.state_;\r\n  var value = owner.data_;  \r\n  var callback = subscriber[settled];\r\n  var promise = subscriber.then;\r\n\r\n  if (typeof callback === 'function')\r\n  {\r\n    settled = FULFILLED;\r\n    try {\r\n      value = callback(value);\r\n    } catch(e) {\r\n      reject(promise, e);\r\n    }\r\n  }\r\n\r\n  if (!handleThenable(promise, value))\r\n  {\r\n    if (settled === FULFILLED)\r\n      resolve(promise, value);\r\n\r\n    if (settled === REJECTED)\r\n      reject(promise, value);\r\n  }\r\n}\r\n\r\nfunction handleThenable(promise, value) {\r\n  var resolved;\r\n\r\n  try {\r\n    if (promise === value)\r\n      throw new TypeError('A promises callback cannot return that same promise.');\r\n\r\n    if (value && (typeof value === 'function' || typeof value === 'object'))\r\n    {\r\n      var then = value.then;  // then should be retrived only once\r\n\r\n      if (typeof then === 'function')\r\n      {\r\n        then.call(value, function(val){\r\n          if (!resolved)\r\n          {\r\n            resolved = true;\r\n\r\n            if (value !== val)\r\n              resolve(promise, val);\r\n            else\r\n              fulfill(promise, val);\r\n          }\r\n        }, function(reason){\r\n          if (!resolved)\r\n          {\r\n            resolved = true;\r\n\r\n            reject(promise, reason);\r\n          }\r\n        });\r\n\r\n        return true;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    if (!resolved)\r\n      reject(promise, e);\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction resolve(promise, value){\r\n  if (promise === value || !handleThenable(promise, value))\r\n    fulfill(promise, value);\r\n}\r\n\r\nfunction fulfill(promise, value){\r\n  if (promise.state_ === PENDING)\r\n  {\r\n    promise.state_ = SEALED;\r\n    promise.data_ = value;\r\n\r\n    asyncCall(publishFulfillment, promise);\r\n  }\r\n}\r\n\r\nfunction reject(promise, reason){\r\n  if (promise.state_ === PENDING)\r\n  {\r\n    promise.state_ = SEALED;\r\n    promise.data_ = reason;\r\n\r\n    asyncCall(publishRejection, promise);\r\n  }\r\n}\r\n\r\nfunction publish(promise) {\r\n  var callbacks = promise.then_;\r\n  promise.then_ = undefined;\r\n\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    invokeCallback(callbacks[i]);\r\n  }\r\n}\r\n\r\nfunction publishFulfillment(promise){\r\n  promise.state_ = FULFILLED;\r\n  publish(promise);\r\n}\r\n\r\nfunction publishRejection(promise){\r\n  promise.state_ = REJECTED;\r\n  publish(promise);\r\n}\r\n\r\n/**\r\n* @class\r\n*/\r\nfunction Promise(resolver){\r\n  if (typeof resolver !== 'function')\r\n    throw new TypeError('Promise constructor takes a function argument');\r\n\r\n  if (this instanceof Promise === false)\r\n    throw new TypeError('Failed to construct \\'Promise\\': Please use the \\'new\\' operator, this object constructor cannot be called as a function.');\r\n\r\n  this.then_ = [];\r\n\r\n  invokeResolver(resolver, this);\r\n}\r\n\r\nPromise.prototype = {\r\n  constructor: Promise,\r\n\r\n  state_: PENDING,\r\n  then_: null,\r\n  data_: undefined,\r\n\r\n  then: function(onFulfillment, onRejection){\r\n    var subscriber = {\r\n      owner: this,\r\n      then: new this.constructor(NOOP),\r\n      fulfilled: onFulfillment,\r\n      rejected: onRejection\r\n    };\r\n\r\n    if (this.state_ === FULFILLED || this.state_ === REJECTED)\r\n    {\r\n      // already resolved, call callback async\r\n      asyncCall(invokeCallback, subscriber);\r\n    }\r\n    else\r\n    {\r\n      // subscribe\r\n      this.then_.push(subscriber);\r\n    }\r\n\r\n    return subscriber.then;\r\n  },\r\n\r\n  'catch': function(onRejection) {\r\n    return this.then(null, onRejection);\r\n  }\r\n};\r\n\r\nPromise.all = function(promises){\r\n  var Class = this;\r\n\r\n  if (!isArray(promises))\r\n    throw new TypeError('You must pass an array to Promise.all().');\r\n\r\n  return new Class(function(resolve, reject){\r\n    var results = [];\r\n    var remaining = 0;\r\n\r\n    function resolver(index){\r\n      remaining++;\r\n      return function(value){\r\n        results[index] = value;\r\n        if (!--remaining)\r\n          resolve(results);\r\n      };\r\n    }\r\n\r\n    for (var i = 0, promise; i < promises.length; i++)\r\n    {\r\n      promise = promises[i];\r\n\r\n      if (promise && typeof promise.then === 'function')\r\n        promise.then(resolver(i), reject);\r\n      else\r\n        results[i] = promise;\r\n    }\r\n\r\n    if (!remaining)\r\n      resolve(results);\r\n  });\r\n};\r\n\r\nPromise.race = function(promises){\r\n  var Class = this;\r\n\r\n  if (!isArray(promises))\r\n    throw new TypeError('You must pass an array to Promise.race().');\r\n\r\n  return new Class(function(resolve, reject) {\r\n    for (var i = 0, promise; i < promises.length; i++)\r\n    {\r\n      promise = promises[i];\r\n\r\n      if (promise && typeof promise.then === 'function')\r\n        promise.then(resolve, reject);\r\n      else\r\n        resolve(promise);\r\n    }\r\n  });\r\n};\r\n\r\nPromise.resolve = function(value){\r\n  var Class = this;\r\n\r\n  if (value && typeof value === 'object' && value.constructor === Class)\r\n    return value;\r\n\r\n  return new Class(function(resolve){\r\n    resolve(value);\r\n  });\r\n};\r\n\r\nPromise.reject = function(reason){\r\n  var Class = this;\r\n\r\n  return new Class(function(resolve, reject){\r\n    reject(reason);\r\n  });\r\n};\r\n\r\n})(typeof window != 'undefined' ? window : typeof global != 'undefined' ? global : typeof self != 'undefined' ? self : this);\r\n/*\r\n * master branch: https://github.com/Keillion/www.keillion.site Unlicense\r\n */\r\n/*global jQuery*/\r\nvar kUtil = kUtil || {};\r\nif(!Math.sign){\r\n    Math.sign = function(num){\r\n        if(num > 0){\r\n            return 1;\r\n        }else if(num == 0){\r\n            if(1 / num < 0){\r\n                return -0;\r\n            }else{\r\n                return 0;\r\n            }\r\n        }else if(num < 0){\r\n            return -1;\r\n        }else{\r\n            return NaN;\r\n        }\r\n    };\r\n}\r\nkUtil.Matrix = function(a,b,c,d,e,f){\r\n    this.a=a,\r\n    this.b=b,\r\n    this.c=c,\r\n    this.d=d,\r\n    this.e=e,\r\n    this.f=f;\r\n};\r\nkUtil.Matrix.dot = function(matrixA, matrixB){\r\n    var A=matrixA, B=matrixB;\r\n    return new kUtil.Matrix(\r\n        A.a*B.a+A.c*B.b,\r\n        A.b*B.a+A.d*B.b,\r\n        A.a*B.c+A.c*B.d,\r\n        A.b*B.c+A.d*B.d,\r\n        A.a*B.e+A.c*B.f+A.e,\r\n        A.b*B.e+A.d*B.f+A.f\r\n    );\r\n};\r\nkUtil.Matrix.prototype.dot = function(matrix){\r\n    return kUtil.Matrix.dot(this, matrix);\r\n};\r\nkUtil.Matrix.equals = function(matrixA, matrixB){\r\n    var A=matrixA, B=matrixB;\r\n    return A.a==B.a && A.b==B.b && A.c==B.c && A.d==B.d && A.e==B.e && A.f==B.f;\r\n};\r\nkUtil.Matrix.prototype.equals = function(matrix){\r\n    return kUtil.Matrix.equals(this, matrix);\r\n};\r\nkUtil.Matrix.prototype.inversion = function(){\r\n    var a=this.a, b=this.b, c=this.c, d=this.d, e=this.e, f=this.f;\r\n    var M = a*d - b*c;\r\n    return new kUtil.Matrix(\r\n        d/M,\r\n        -b/M,\r\n        -c/M,\r\n        a/M,\r\n        (c*f - d*e)/M,\r\n        (b*e - a*f)/M\r\n    );\r\n};\r\nkUtil.convertURLToBlob = function(url, callback) {\r\n    var http = new XMLHttpRequest();\r\n    http.open(\"GET\", url, true);\r\n    http.responseType = \"blob\";\r\n    http.onloadend = function() {\r\n        callback(this.response);\r\n    };\r\n    http.send();\r\n};\r\nkUtil.convertBase64ToBlob = function(base64Str, mimeType){\r\n    var byteCharacters = atob(base64Str);\r\n    var byteNumArr = new Array(byteCharacters.length);\r\n    for(var i=0; i < byteCharacters.length; ++i){\r\n        byteNumArr[i] = byteCharacters.charCodeAt(i);\r\n    }\r\n    var uint8Arr = new Uint8Array(byteNumArr);\r\n    return new Blob([uint8Arr], {type: mimeType});\r\n};\r\n/**\r\n * author: meizz; modify: Keillion\r\n * https://blog.csdn.net/meizz/article/details/405708\r\n * */\r\nDate.prototype.kUtilFormat = function(fmt){\r\n    var o = {\r\n        \"M+\" : this.getUTCMonth()+1,\r\n        \"d+\" : this.getUTCDate(),\r\n        \"h+\" : this.getUTCHours(),\r\n        \"m+\" : this.getUTCMinutes(),\r\n        \"s+\" : this.getUTCSeconds(),\r\n        \"q+\" : Math.floor((this.getUTCMonth()+3)/3),\r\n        \"S\"  : this.getUTCMilliseconds()\r\n    };\r\n    if(/(y+)/.test(fmt))\r\n        fmt=fmt.replace(RegExp.$1, (this.getFullYear()+\"\").substr(4 - RegExp.$1.length));\r\n    for(var k in o)\r\n        if(new RegExp(\"(\"+ k +\")\").test(fmt))\r\n            fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : ((\"00\"+ o[k]).substr((\"\"+ o[k]).length)));\r\n    return fmt;\r\n};\r\nkUtil.copyToClipBoard = function(txt){\r\n    if(navigator.clipboard){\r\n        navigator.clipboard.writeText(txt)['catch'](function(ex){\r\n            alert('copy failed, info: '+(ex.message || ex));\r\n        });\r\n    }else{\r\n        var textarea = document.createElement('textarea');\r\n        textarea.style.width = '4px';\r\n        textarea.style.height = '4px';\r\n        textarea.style.position = 'fixed';\r\n        textarea.style.left = '0';\r\n        textarea.style.top = '0';\r\n        jQuery(document.body).append(textarea);\r\n        textarea.value = txt;\r\n        var isIOS = navigator.userAgent.match(/ipad|iphone/i);\r\n        if(isIOS){\r\n            //ios\r\n            var range = document.createRange();\r\n            range.selectNodeContents(textarea);\r\n            var selection = window.getSelection();\r\n            selection.removeAllRanges();\r\n            selection.addRange(range);\r\n            textarea.setSelectionRange(0, 999999);\r\n        }else{\r\n            //other\r\n            textarea.focus();\r\n            textarea.select();\r\n        }\r\n        try{\r\n            var bSuccess = document.execCommand('copy');//ios would not return true\r\n            if(!bSuccess && !isIOS){\r\n                alert('copy failed');\r\n            }\r\n        }catch(ex){\r\n            alert('copy failed, info: '+(ex.message || ex));\r\n        }\r\n        jQuery(textarea).remove();\r\n    }\r\n};\r\n(function($){\r\n    $.fn.borderWidth = function(){\r\n        var cs = null;\r\n        if(window.getComputedStyle){\r\n            cs = getComputedStyle(this[0]);\r\n        }else{\r\n            cs = this[0].currentStyle;\r\n        }\r\n        var info = {};\r\n        info.left = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"border-left-width\") : cs.getAttribute(\"border-left-width\")) || 0;\r\n        info.top = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"border-top-width\") : cs.getAttribute(\"border-top-width\")) || 0;\r\n        info.right = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"border-right-width\") : cs.getAttribute(\"border-right-width\")) || 0;\r\n        info.bottom = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"border-bottom-width\") : cs.getAttribute(\"border-bottom-width\")) || 0;\r\n        return info;\r\n    };\r\n    $.fn.padding = function(){\r\n        var cs = null;\r\n        if(window.getComputedStyle){\r\n            cs = getComputedStyle(this[0]);\r\n        }else{\r\n            cs = this[0].currentStyle;\r\n        }\r\n        var info = {};\r\n        info.left = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"padding-left\") : cs.getAttribute(\"padding-left\")) || 0;\r\n        info.top = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"padding-top\") : cs.getAttribute(\"padding-top\")) || 0;\r\n        info.right = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"padding-right\") : cs.getAttribute(\"padding-right\")) || 0;\r\n        info.bottom = parseFloat(cs.getPropertyValue ? cs.getPropertyValue(\"padding-bottom\") : cs.getAttribute(\"padding-bottom\")) || 0;\r\n        return info;\r\n    };\r\n    $.fn.borderBoxRect = function(){\r\n        var cs = null;\r\n        if(window.getComputedStyle){\r\n            cs = getComputedStyle(this[0]);\r\n        }\r\n        var offset = this.offset();\r\n        var info = {};\r\n        /*info.zoom = 1;\r\n         tudo:matrix\r\n        var strTransform = this.css('transform');\r\n        if('none'!=strTransform){\r\n            var partStr = 'matrix(';\r\n            var matrixIndex = strTransform.indexOf(partStr) + partStr.length;\r\n            if(-1 != matrixIndex){\r\n                var matrixArr = strTransform.substring(matrixIndex, strTransform.indexOf(')', matrixIndex)).split(',');\r\n                info.zoom = parseFloat(matrixArr[0]);\r\n            }\r\n        }*/\r\n        info.pageX0 = offset.left;\r\n        info.pageY0 = offset.top;\r\n        info.width = cs?parseFloat(cs.width):this.outerWidth();//*info.zoom;\r\n        info.height = cs?parseFloat(cs.height):this.outerHeight();//*info.zoom;\r\n        info.pageX1 = info.pageX0 + info.width;\r\n        info.pageY1 = info.pageY0 + info.height;\r\n        //tudo: client\\screen\r\n        return info;\r\n    };\r\n    $.fn.paddingBoxRect = function(){\r\n        var borderBoxRect = this.borderBoxRect();\r\n        var borderWidth = this.borderWidth();\r\n        var info = {};\r\n        //info.zoom = borderBoxRect.zoom;\r\n        info.pageX0 = borderBoxRect.pageX0 + borderWidth.left;//*info.zoom;\r\n        info.pageY0 = borderBoxRect.pageY0 + borderWidth.top;//*info.zoom;\r\n        info.width = window.getComputedStyle?borderBoxRect.width - (borderWidth.left + borderWidth.right):this.innerWidth();//*info.zoom;\r\n        info.height = window.getComputedStyle?borderBoxRect.height - (borderWidth.top + borderWidth.bottom):this.innerHeight();//*info.zoom;\r\n        info.pageX1 = borderBoxRect.pageX1 - borderWidth.right;//*info.zoom;\r\n        info.pageY1 = borderBoxRect.pageY1 - borderWidth.bottom;//*info.zoom;\r\n        //tudo: client\\screen\r\n        return info;\r\n    };\r\n    $.fn.contentBoxRect = function(){\r\n        var paddingBoxRect = this.paddingBoxRect();\r\n        var padding = this.padding();\r\n        var info = {};\r\n        //info.zoom = paddingBoxRect.zoom;\r\n        info.pageX0 = paddingBoxRect.pageX0 + padding.left;//*info.zoom;\r\n        info.pageY0 = paddingBoxRect.pageY0 + padding.top;//*info.zoom;\r\n        info.width = window.getComputedStyle?paddingBoxRect.width - (padding.left + padding.right):this.width();//*info.zoom;\r\n        info.height = window.getComputedStyle?paddingBoxRect.height - (padding.top + padding.bottom):this.height();//*info.zoom;\r\n        info.pageX1 = paddingBoxRect.pageX1 - padding.right;//*info.zoom;\r\n        info.pageY1 = paddingBoxRect.pageY1 - padding.bottom;//*info.zoom;\r\n        //tudo: client\\screen\r\n        return info;\r\n    };\r\n    $.fn.getTransform = function(){\r\n        var strTransform = this.css('transform');\r\n        if('none' == strTransform || '' == strTransform){\r\n            //jq bug, transform might not get latest, I only resolve the situation when set matrix(...)\r\n            strTransform = this[0].style.transform;\r\n        }\r\n        var partStr = 'matrix(';\r\n        var matrixIndex = strTransform.indexOf(partStr);\r\n        if(-1 != matrixIndex){\r\n            matrixIndex += partStr.length;\r\n            var arr = strTransform.substring(matrixIndex, strTransform.indexOf(')', matrixIndex)).split(',');\r\n            for(var i=0; i<arr.length; ++i){\r\n                arr[i] = parseFloat(arr[i]);\r\n            }\r\n            return new kUtil.Matrix(arr[0],arr[1],arr[2],arr[3],arr[4],arr[5]);//.apply(kUtil.Matrix, matrixArr);\r\n        }\r\n        partStr = 'scale(';\r\n        var scaleIndex = strTransform.indexOf(partStr);\r\n        if(-1 != scaleIndex){\r\n            scaleIndex += partStr.length;\r\n            var zoom = parseFloat(strTransform.substring(scaleIndex));\r\n            return new kUtil.Matrix(zoom,0,0,zoom,0,0);\r\n        }\r\n        return new kUtil.Matrix(1,0,0,1,0,0);\r\n    };\r\n    $.fn.setTransform = function(matrix){\r\n        var m = matrix;\r\n        var str = 'matrix('+[m.a,m.b,m.c,m.d,m.e,m.f].join(',')+')';\r\n        this.css('transform', str);\r\n    };\r\n})(jQuery);\r\n(function (DL,MBC) {\r\n    \"use strict\";\r\n    var lib = DL;   \r\n    function VideoViewer(cfg){\r\n        var _this = this;\r\n        _this.videoHtmlElement = [\r\n            '<div class=\"kPainterVideoMdl\">',\r\n                '<video class=\"kPainterVideo\" webkit-playsinline=\"true\"></video>',\r\n                '<select class=\"kPainterCameraSelect\">',\r\n                '</select>',\r\n                '<select class=\"kPainterResolutionSelect\">',\r\n                    '<option class=\"kPainterGotResolutionOpt\" value=\"got\" selected></option>',\r\n                    '<option data-width=\"3840\" data-height=\"2160\">ask 3840 x 2160</option>',\r\n                    '<option data-width=\"1920\" data-height=\"1080\">ask 1920 x 1080</option>',\r\n                    '<option data-width=\"1600\" data-height=\"1200\">ask 1600 x 1200</option>',\r\n                    '<option data-width=\"1280\" data-height=\"720\">ask 1280 x 720</option>',\r\n                    '<option data-width=\"800\" data-height=\"600\">ask 800 x 600</option>',\r\n                    '<option data-width=\"640\" data-height=\"480\">ask 640 x 480</option>',\r\n                    '<option data-width=\"640\" data-height=\"360\">ask 640 x 360</option>',\r\n                '</select>',\r\n                '<button class=\"kPainterBtnGrabVideo\"><svg width=\"48\" viewBox=\"0 0 2048 1792\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1024 672q119 0 203.5 84.5t84.5 203.5-84.5 203.5-203.5 84.5-203.5-84.5-84.5-203.5 84.5-203.5 203.5-84.5zm704-416q106 0 181 75t75 181v896q0 106-75 181t-181 75h-1408q-106 0-181-75t-75-181v-896q0-106 75-181t181-75h224l51-136q19-49 69.5-84.5t103.5-35.5h512q53 0 103.5 35.5t69.5 84.5l51 136h224zm-704 1152q185 0 316.5-131.5t131.5-316.5-131.5-316.5-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5z\"/></svg></button>',\r\n                '<button class=\"kPainterBtnCloseVideo\"><svg width=\"48\" viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z\"/></svg></button>',\r\n            '</div>'\r\n        ].join('');\r\n\r\n        _this.videoSettings = cfg.videoSettings;\r\n        _this.viewer = cfg.viewer;\r\n        _this.beforeAddImgFromGrabVideoBtn = null;\r\n        _this.afterAddImgFromGrabVideoBtn = null;\r\n\r\n        // video 是否关闭\r\n        _this.videoClosed = true;\r\n    }\r\n\r\n    VideoViewer.prototype.__Init = function(){\r\n        var _this = this;\r\n\r\n        _this.videoWrapper = document.getElementById(\"videoWrapper\");\r\n        _this.video = lib._querySelectorAll(_this.videoWrapper,'.kPainterVideo')[0];\r\n        _this.cameraSel = lib._querySelectorAll(_this.videoWrapper,'.kPainterCameraSelect')[0];\r\n        _this.resolutionSel = lib._querySelectorAll(_this.videoWrapper,'.kPainterResolutionSelect')[0];\r\n        _this.optGotRsl = lib._querySelectorAll(_this.videoWrapper,'.kPainterGotResolutionOpt')[0];\r\n        _this.btnGrab = lib._querySelectorAll(_this.videoWrapper,'.kPainterBtnGrabVideo')[0];\r\n        _this.btnClose = lib._querySelectorAll(_this.videoWrapper,'.kPainterBtnCloseVideo')[0];\r\n\r\n        function camSelChange(){\r\n            _this.playVideo(_this.cameraSel.value).then(function(){\r\n                if(!_this.videoClosed){\r\n                    _this.stopVideo();\r\n                }\r\n            }).catch(function(ex){\r\n                alert('Play video failed: ' + (ex.message || ex));\r\n            });\r\n        };\r\n        if(_this.cameraSel) lib.addEvent(_this.cameraSel,\"change\", camSelChange);\r\n\r\n        function relSelChange(){\r\n            _this.playVideo().then(function(){\r\n                if(!_this.videoClosed){\r\n                    _this.stopVideo();\r\n                }\r\n            }).catch(function(ex){\r\n                alert('Play video failed: ' + (ex.message || ex));\r\n            });\r\n            return true;\r\n        };\r\n        if(_this.resolutionSel) lib.addEvent(_this.resolutionSel,\"change\", relSelChange);\r\n        \r\n        function btnGrabClick(){\r\n            _this.grabVideo(true);\r\n            _this.hideVideo();\r\n            return true;\r\n        };\r\n        if(_this.btnGrab) lib.addEvent(_this.btnGrab,\"click\", btnGrabClick);\r\n\r\n        function closeWindow(){\r\n            _this.stopVideo();\r\n            _this.videoClosed = true;\r\n            _this.optGotRsl.removeAttribute('data-width');\r\n            \r\n            if(_this.cameraSel) lib.removeEvent(_this.cameraSel,\"change\", camSelChange);\r\n            if(_this.resolutionSel) lib.removeEvent(_this.resolutionSel,\"change\", relSelChange);\r\n            if(_this.btnGrab) lib.removeEvent(_this.btnGrab,\"click\", btnGrabClick);\r\n            if(_this.btnClose) lib.removeEvent(_this.btnClose,\"click\", closeWindow);\r\n\r\n            document.body.removeChild(_this.videoWrapper);\r\n        };\r\n\r\n        _this.hideVideo = closeWindow;\r\n        if(_this.btnClose) lib.addEvent(_this.btnClose,\"click\", closeWindow);\r\n        \r\n    }\r\n\r\n    VideoViewer.prototype.updateDevice = function(){\r\n        var _this = this;\r\n        if(!_this.cameraSel){\r\n            return Promise.reject('no camera select');\r\n        }\r\n        return navigator.mediaDevices.enumerateDevices().then(deviceInfos=>{\r\n            var oldVal = _this.cameraSel.value;\r\n            _this.cameraSel.innerHTML = \"\";\r\n            var selOpt = undefined;\r\n            window.console.log(deviceInfos,\"deviceInfos\")\r\n            for(var i = 0; i < deviceInfos.length; ++i){\r\n                var info = deviceInfos[i];\r\n                if(info.kind != 'videoinput'){\r\n                    continue;\r\n                }\r\n                var opt = document.createElement('option');\r\n                opt.value = info.deviceId;\r\n                opt.innerText = info.label || 'camera '+ i;\r\n                _this.cameraSel.appendChild(opt);\r\n                if(oldVal == info.deviceId){\r\n                    selOpt = opt;\r\n                }\r\n            }\r\n            var optArr = _this.cameraSel.childNodes;\r\n            if(!selOpt && optArr.length){\r\n                try{\r\n                    _this.video.srcObject.getTracks().forEach((track)=>{\r\n                        if('video' == track.kind){\r\n                            for(var i = 0; i < optArr.length; ++i){\r\n                                var opt = optArr[i];\r\n                                if(track.label == opt.innerText){\r\n                                    selOpt = opt;\r\n                                    throw 'found the using source';\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                }catch(ex){\r\n                    //if(self.kConsoleLog){self.kConsoleLog(ex);}\r\n                    console.log(ex);\r\n                }\r\n            }\r\n            if(selOpt){\r\n                _this.cameraSel.value = selOpt.value;\r\n            }\r\n        });\r\n    }\r\n\r\n    VideoViewer.prototype.stopVideo = function(){\r\n        var _this = this;\r\n        if(_this.video.srcObject){\r\n            //if(self.kConsoleLog)self.kConsoleLog('======stop video========');\r\n            _this.video.srcObject.getTracks().forEach(function(track) {\r\n                track.stop();\r\n            });\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    VideoViewer.prototype.playVideo = function(deviceId){\r\n        var _this = this;\r\n        return new Promise((resolve,reject)=>{\r\n\r\n            _this.stopVideo();\r\n\r\n            //if(self.kConsoleLog)self.kConsoleLog('======before video========');\r\n            var constraints = _this.videoSettings ? _this.videoSettings : _this.viewer.videoSettings;\r\n            var selRslOpt = _this.resolutionSel ? _this.resolutionSel.children[_this.resolutionSel.selectedIndex] : null;\r\n            if(selRslOpt && selRslOpt.hasAttribute('data-width')){\r\n                var selW = selRslOpt.getAttribute('data-width');\r\n                var selH = selRslOpt.getAttribute('data-height');\r\n                _this.optGotRsl.setAttribute('data-width', selW);\r\n                _this.optGotRsl.setAttribute('data-height', selH);\r\n                var bMobileSafari = /Safari/.test(navigator.userAgent) && /iPhone/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent);\r\n                if(bMobileSafari){\r\n                    if(selW >= 1280){\r\n                        constraints.video.width = 1280;\r\n                    }else if(selW >= 640){\r\n                        constraints.video.width = 640;\r\n                    }else if(selW >= 320){\r\n                        constraints.video.width = 320;\r\n                    }\r\n                }else{\r\n                    constraints.video.width = { ideal: selW };\r\n                    constraints.video.height = { ideal: selH };\r\n                }\r\n                if(!deviceId){\r\n                    var selCamOpt = _this.cameraSel.children[_this.cameraSel.selectedIndex];\r\n                    if(selCamOpt){\r\n                        deviceId = selCamOpt.value;\r\n                    }\r\n                }\r\n                if(deviceId){\r\n                    constraints.video.facingMode = undefined;\r\n                    constraints.video.deviceId = {exact: deviceId};\r\n                }\r\n            }\r\n            \r\n            var hasTryedNoWidthHeight = false;\r\n            var getAndPlayVideo = ()=>{\r\n                //if(self.kConsoleLog)self.kConsoleLog('======try getUserMedia========');\r\n                //if(self.kConsoleLog)self.kConsoleLog('ask '+JSON.stringify(constraints.video.width)+'x'+JSON.stringify(constraints.video.height));\r\n                navigator.mediaDevices.getUserMedia(constraints).then((stream)=>{\r\n                    //if(self.kConsoleLog)self.kConsoleLog('======get video========');\r\n                    return new Promise((resolve2, reject2)=>{\r\n                        _this.video.srcObject = stream;\r\n                        _this.video.onloadedmetadata = ()=>{\r\n                            //if(self.kConsoleLog)self.kConsoleLog('======play video========');\r\n                            _this.video.play().then(()=>{\r\n                            // if(self.kConsoleLog)self.kConsoleLog('======played video========');\r\n                                var gotRsl = _this.video.videoWidth+'x'+_this.video.videoHeight;\r\n                                if(_this.optGotRsl)_this.optGotRsl.innerText = gotRsl;\r\n                                if(_this.resolutionSel)_this.resolutionSel.value = 'got';\r\n                                //if(self.kConsoleLog)self.kConsoleLog(gotRsl);\r\n                                resolve2();\r\n                            },(ex)=>{\r\n                                reject2(ex);\r\n                            });\r\n                        };\r\n                        _this.video.onerror = ()=>{reject2();};\r\n                    });\r\n                }).then(()=>{\r\n                    resolve();\r\n                }).catch((ex)=>{\r\n                    //if(self.kConsoleLog)self.kConsoleLog(ex);\r\n                    if(!hasTryedNoWidthHeight){\r\n                        hasTryedNoWidthHeight = true;\r\n                        constraints.video.width = undefined;\r\n                        constraints.video.height = undefined;\r\n                        getAndPlayVideo();\r\n                    }else{\r\n                        reject(ex);\r\n                    }\r\n                });\r\n            };\r\n            getAndPlayVideo();\r\n        });\r\n    }\r\n\r\n    VideoViewer.prototype.grabVideo = function(isAutoAdd){\r\n        var _this = this;\r\n        if(_this.videoClosed) return;\r\n\r\n        var canvas = document.createElement(\"canvas\");\r\n        canvas.width = _this.video.videoWidth;\r\n        canvas.height = _this.video.videoHeight;\r\n        var ctx = canvas.getContext(\"2d\");\r\n        ctx.drawImage(_this.video,0,0);\r\n        if(!isAutoAdd){\r\n            return canvas;\r\n        }\r\n        return _this.viewer.LoadImageEx(canvas);\r\n    }\r\n\r\n    VideoViewer.prototype.showVideo = function(){\r\n        var _this = this;\r\n\r\n        if(!_this.videoClosed) return;\r\n\r\n        _this.videoClosed = false;\r\n\r\n        var videoWrp = document.createElement(\"div\");\r\n        videoWrp.setAttribute(\"id\",\"videoWrapper\");\r\n        videoWrp.innerHTML = _this.videoHtmlElement;\r\n        document.body.appendChild(videoWrp);\r\n\r\n        _this.__Init();\r\n\r\n        return _this.playVideo().then(function(){\r\n            if(_this.videoClosed){\r\n                _this.stopVideo();\r\n                return Promise.reject('Video window has closed.');\r\n            }else{\r\n                _this.updateDevice().catch(function(ex){\r\n                    //if(self.kConsoleLog)kConsoleLog(ex);\r\n                    console.log(ex);\r\n                });\r\n                return Promise.resolve();\r\n            }\r\n        });\r\n    }\r\n\r\n    MBC.VideoViewer = VideoViewer;\r\n\r\n})(Alvin.MBC.Lib,Alvin.MBC);(function (DL, MBC) {\r\n    \"use strict\";\r\n    var lib = DL;\r\n\r\n    function ImageAreaSelector(cfg) {\r\n        var _this = this;\r\n        var containerDiv = [\r\n            '<div class=\"kPainterCroper\" style=\"display:none;\">',\r\n            '<div class=\"kPainterCells\">',\r\n            '<div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>',\r\n            '</div',\r\n            '><div class=\"kPainterBigMover\" data-orient=\"0,0\" style=\"display:none\"></div',\r\n            '><div class=\"kPainterEdges\">',\r\n            '<div data-orient=\"1\"></div',\r\n            '><div data-orient=\"2\"></div',\r\n            '><div data-orient=\"3\"></div',\r\n            '><div data-orient=\"4\"></div>',\r\n            '</div',\r\n            '><div class=\"kPainterCorners\">',\r\n            '<div data-orient=\"5\"><i></i></div',\r\n            '><div data-orient=\"6\"><i></i></div',\r\n            '><div data-orient=\"7\"><i></i></div',\r\n            '><div data-orient=\"8\"><i></i></div>',\r\n            '</div>',\r\n            '</div',\r\n            '><div class=\"kPainterPerspect\" style=\"display:none;\">',\r\n            '<canvas class=\"kPainterPerspectCvs\"></canvas',\r\n            '><div class=\"kPainterPerspectCorner\" data-index=\"0\">lt</div',\r\n            '><div class=\"kPainterPerspectCorner\" data-index=\"1\">rt</div',\r\n            '><div class=\"kPainterPerspectCorner\" data-index=\"2\">rb</div',\r\n            '><div class=\"kPainterPerspectCorner\" data-index=\"3\">lb</div>',\r\n            '</div',\r\n            '><div class=\"kPainterGesturePanel\"></div>'\r\n        ].join('');\r\n\r\n        _this.viewer = cfg.viewer;\r\n        _this.container = cfg.container;\r\n\r\n        _this.container.insertAdjacentHTML('beforeEnd', containerDiv);\r\n        _this.kPainterCroper = lib._querySelectorAll(_this.container, 'div.kPainterCroper')[0];\r\n\r\n        _this.kPainterCells = lib._querySelectorAll(_this.container, 'div.kPainterCells > div');\r\n\r\n        // 控件的四个顶点\r\n        _this.kPainterCorners = lib._querySelectorAll(_this.container, 'div.kPainterCorners > div');\r\n        // 控件的四条边框\r\n        _this.kPainterEdges = lib._querySelectorAll(_this.container, 'div.kPainterEdges > div');\r\n\r\n        _this.bVisible = false;\r\n        _this.isAutoShowCropUI = true;\r\n        _this.isCropRectShowing = false;\r\n\r\n        // 是否选中可拖拽的边或点\r\n        _this.dragging = false;\r\n\r\n        // 控件的最大宽高\r\n        _this.maxWidth = 0;\r\n        _this.maxHeight = 0;\r\n\r\n        // 控件的最小宽高\r\n        _this.minWidth = 50;\r\n        _this.minHeight = 50;\r\n\r\n        // 最小的边距\r\n        _this.minTop = 0;\r\n        _this.minLeft = 0;\r\n\r\n        // 当前边距信息\r\n        _this.top = 0;\r\n        _this.left = 0;\r\n\r\n        // 控件的 UI 属性\r\n        _this.borderColor = 'red';\r\n        _this.backgroundColor = 'rgba(255,0,0,0.2)';\r\n\r\n        // 鼠标按下时控件的初始信息\r\n        _this._startPos = {\r\n            targetNode: -1, // 控件当前拖拽的边/角：边 -（1：左，2：上，3：右，4：下），角 - （5：左上，6：右上，7：右下，8：左下）\r\n            startX: 0, // 鼠标落点位置\r\n            startY: 0,\r\n            width: 0, // 开始拖拽是控件的高\r\n            height: 0,\r\n            left: 0, // 开始拖拽是控件的位置\r\n            top: 0\r\n        };\r\n\r\n        // 画布实时的裁切信息：相对于伸缩后的图片\r\n        _this.drawArea = {\r\n            x: 0,\r\n            y: 0,\r\n            width: 0,\r\n            height: 0\r\n        };\r\n\r\n        // 实际的裁切信息：相对于原图\r\n        _this.cropArea = null;\r\n\r\n        _this.__Init();\r\n\r\n    }\r\n\r\n    ImageAreaSelector.prototype.__Init = function () {\r\n        var _this = this;\r\n\r\n        // 给控件四条边和四个角添加响应点击事件\r\n        for (var i = 0; i < 4; i++) {\r\n            lib.addEvent([_this.kPainterCorners[i], _this.kPainterEdges[i]], \"mousedown touchstart\", fuc_touchstart);\r\n        }\r\n\r\n        function fuc_touchstart(event) {\r\n            var ev = event || window.event;\r\n            lib.stopDefault(ev);\r\n\r\n            _this.dragging = true;\r\n\r\n            lib.addEvent(_this.container, \"mousemove touchmove\", fuc_touchmove);\r\n            lib.addEvent(_this.container, \"mouseleave mouseup touchend\", fuc_touchend);\r\n\r\n            var touches = ev.changedTouches;\r\n\r\n            var curX, curY;\r\n            if (touches) {\r\n                //Multi-contact is prohibited\r\n                if (touches.length != 1) {\r\n                    return false;\r\n                }\r\n                curX = touches[0].pageX;\r\n                curY = touches[0].pageY;\r\n            } else {\r\n                curX = ev.clientX;\r\n                curY = ev.clientY;\r\n            }\r\n            _this._startPos = {\r\n                targetNode: parseInt(this.getAttribute(\"data-orient\")),\r\n                startX: curX,\r\n                startY: curY,\r\n                width: _this.drawArea.width,\r\n                height: _this.drawArea.height,\r\n                left: _this.drawArea.x,\r\n                top: _this.drawArea.y\r\n            }\r\n\r\n        }\r\n\r\n        function fuc_touchmove(event) {\r\n            var ev = event || window.event;\r\n            lib.stopDefault(ev);\r\n            if (!_this.dragging) return;\r\n            var touches = ev.changedTouches;\r\n            var sp = _this._startPos;\r\n\r\n            if (touches) {\r\n                var _curOffsetX = touches[0].pageX - sp.startX,\r\n                    _curOffsetY = touches[0].pageY - sp.startY;\r\n            } else {\r\n                var _curOffsetX = ev.clientX - sp.startX,\r\n                    _curOffsetY = ev.clientY - sp.startY;\r\n            }\r\n\r\n            // 控件的实时位置和大小信息\r\n            var curW, curH, curL, curT;\r\n\r\n            switch (sp.targetNode) {\r\n                case 1:\r\n                    // 拖拽 左侧边框\r\n                    curW = (sp.width - _curOffsetX) > (sp.left + sp.width) ? (sp.left + sp.width) : (sp.width - _curOffsetX) < _this.minWidth ? _this.minWidth : (sp.width - _curOffsetX);\r\n                    curH = sp.height;\r\n                    curL = sp.left + sp.width - curW;\r\n                    curT = sp.top;\r\n                    break;\r\n                case 2:\r\n                    // 拖拽 上侧边框\r\n                    curW = sp.width;\r\n                    curH = (sp.height - _curOffsetY) > (sp.top + sp.height) ? (sp.top + sp.height) : (sp.height - _curOffsetY) < _this.minHeight ? _this.minHeight : (sp.height - _curOffsetY);\r\n                    curL = sp.left;\r\n                    curT = sp.top + sp.height - curH;\r\n                    break;\r\n                case 3:\r\n                    // 拖拽 右侧边框\r\n                    curW = (sp.width + _curOffsetX) > (_this.maxWidth - sp.left) ? (_this.maxWidth - sp.left) : (sp.width + _curOffsetX) < _this.minWidth ? _this.minWidth : (sp.width + _curOffsetX);\r\n                    curH = sp.height;\r\n                    curL = sp.left;\r\n                    curT = sp.top;\r\n                    break;\r\n                case 4:\r\n                    // 拖拽 下侧边框\r\n                    curW = sp.width;\r\n                    curH = (sp.height + _curOffsetY) > (_this.maxHeight - sp.top) ? (_this.maxHeight - sp.top) : (sp.height + _curOffsetY) < _this.minHeight ? _this.minHeight : (sp.height + _curOffsetY);\r\n                    curL = sp.left;\r\n                    curT = sp.top;\r\n                    break;\r\n                case 5:\r\n                    // 拖拽 左上顶点\r\n                    curW = (sp.width - _curOffsetX) > (sp.left + sp.width) ? (sp.left + sp.width) : (sp.width - _curOffsetX) < _this.minWidth ? _this.minWidth : (sp.width - _curOffsetX);\r\n                    curH = (sp.height - _curOffsetY) > (sp.top + sp.height) ? (sp.top + sp.height) : (sp.height - _curOffsetY) < _this.minHeight ? _this.minHeight : (sp.height - _curOffsetY);\r\n                    curL = sp.left + sp.width - curW;\r\n                    curT = sp.top + sp.height - curH;\r\n                    break;\r\n                case 6:\r\n                    // 拖拽 右上顶点\r\n                    curW = (sp.width + _curOffsetX) > (_this.maxWidth - sp.left) ? (_this.maxWidth - sp.left) : (sp.width + _curOffsetX) < _this.minWidth ? _this.minWidth : (sp.width + _curOffsetX);\r\n                    curH = (sp.height - _curOffsetY) > (sp.top + sp.height) ? (sp.top + sp.height) : (sp.height - _curOffsetY) < _this.minHeight ? _this.minHeight : (sp.height - _curOffsetY);\r\n                    curL = sp.left;\r\n                    curT = sp.top + sp.height - curH;\r\n                    break;\r\n                case 7:\r\n                    // 拖拽 右下顶点\r\n                    curW = (sp.width + _curOffsetX) > (_this.maxWidth - sp.left) ? (_this.maxWidth - sp.left) : (sp.width + _curOffsetX) < _this.minWidth ? _this.minWidth : (sp.width + _curOffsetX);\r\n                    curH = (sp.height + _curOffsetY) > (_this.maxHeight - sp.top) ? (_this.maxHeight - sp.top) : (sp.height + _curOffsetY) < _this.minHeight ? _this.minHeight : (sp.height + _curOffsetY);\r\n                    curL = sp.left;\r\n                    curT = sp.top;\r\n                    break;\r\n                case 8:\r\n                    // 拖拽 左下顶点\r\n                    curW = (sp.width - _curOffsetX) > (sp.left + sp.width) ? (sp.left + sp.width) : (sp.width - _curOffsetX) < _this.minWidth ? _this.minWidth : (sp.width - _curOffsetX);\r\n                    curH = (sp.height + _curOffsetY) > (_this.maxHeight - sp.top) ? (_this.maxHeight - sp.top) : (sp.height + _curOffsetY) < _this.minHeight ? _this.minHeight : (sp.height + _curOffsetY);\r\n                    curL = sp.left + sp.width - curW;\r\n                    curT = sp.top;\r\n                    break;\r\n                default:\r\n                    return;\r\n            }\r\n\r\n            _this.__updateDrawArea(curW, curH, curL, curT);\r\n\r\n        }\r\n\r\n        function fuc_touchend(event) {\r\n            var ev = event || window.event;\r\n            lib.stopDefault(ev);\r\n            if (!_this.dragging) return;\r\n            _this.dragging = false;\r\n\r\n            lib.removeEvent(_this.container, \"mousemove touchmove\", fuc_touchmove);\r\n            lib.removeEvent(_this.container, \"mouseleave mouseup touchend\", fuc_touchend);\r\n        }\r\n    }\r\n\r\n    ImageAreaSelector.prototype.SetVisible = function (bVisible) {\r\n        var _this = this;\r\n        if (bVisible) {\r\n            _this.bVisible = true;\r\n            _this.kPainterCroper.style.display = '';\r\n        } else {\r\n            _this.bVisible = false;\r\n            _this.kPainterCroper.style.display = 'none';\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    ImageAreaSelector.prototype.ShowCropRect = function () {\r\n        var _this = this;\r\n        if (_this.viewer.mode != 'edit') return;\r\n        _this.isCropRectShowing = true;\r\n        _this.SetVisible(true);\r\n\r\n        if (!_this.viewer.isSwitchedWH) {\r\n            _this.maxWidth = _this.viewer._canvasArea.width;\r\n            _this.maxHeight = _this.viewer._canvasArea.height;\r\n        } else {\r\n            _this.maxWidth = _this.viewer._canvasArea.height;\r\n            _this.maxHeight = _this.viewer._canvasArea.width;\r\n        }\r\n        _this.minLeft = (_this.viewer._imgContainerW - _this.maxWidth) / 2;\r\n        _this.minTop = (_this.viewer._imgContainerH - _this.maxHeight) / 2;\r\n\r\n        _this.__updateDrawArea(_this.maxWidth, _this.maxHeight, 0, 0);\r\n        return true;\r\n    }\r\n\r\n    ImageAreaSelector.prototype.HideCropRect = function () {\r\n        var _this = this;\r\n        _this.isCropRectShowing = false;\r\n        _this.SetVisible(false);\r\n\r\n        return true;\r\n    }\r\n\r\n    ImageAreaSelector.prototype.__updateDrawArea = function (w, h, x, y) {\r\n        var _this = this;\r\n\r\n        _this.drawArea.width = w;\r\n        _this.drawArea.height = h;\r\n        _this.drawArea.x = x;\r\n        _this.drawArea.y = y;\r\n\r\n        _this.__updatePosition(w, h, x + _this.minLeft, y + _this.minTop);\r\n    }\r\n\r\n    ImageAreaSelector.prototype.__updatePosition = function (w, h, l, t) {\r\n        var _this = this;\r\n        _this.left = l;\r\n        _this.top = t;\r\n\r\n        _this.kPainterCroper.style.width = w + 'px';\r\n        _this.kPainterCroper.style.height = h + 'px';\r\n        _this.kPainterCroper.style.left = _this.left + 'px';\r\n        _this.kPainterCroper.style.top = _this.top + 'px';\r\n        return true;\r\n    }\r\n\r\n    ImageAreaSelector.prototype.__getCropArea = function () {\r\n        var _this = this,\r\n            curCropRect,\r\n            _x = _this.drawArea.x / _this.maxWidth,\r\n            _y = _this.drawArea.y / _this.maxHeight,\r\n            _w = _this.drawArea.width / _this.maxWidth,\r\n            _h = _this.drawArea.height / _this.maxHeight;\r\n\r\n        curCropRect = {\r\n            x: _x,\r\n            y: _y,\r\n            width: _w,\r\n            height: _h\r\n        }\r\n        _this.cropArea = curCropRect;\r\n        return curCropRect;\r\n    }\r\n\r\n    MBC.ImageAreaSelector = ImageAreaSelector;\r\n\r\n})(Alvin.MBC.Lib, Alvin.MBC);(function (DL,MBC) {\r\n\t\"use strict\";\r\n\tvar lib = DL;\r\n\r\n\tfunction ImageControl(cfg) {\r\n\t\tvar _this = this;\r\n\r\n\t\t// ImageControl 容器的宽高\r\n\t\t_this.containerWidth = 0;\r\n\t\t_this.containerHeight = 0;\r\n\r\n\t\t// ImageControl 的宽高\r\n\t\t_this.controlWidth = 0;\r\n\t\t_this.controlHeight = 0;\r\n\r\n\t\t// ImageControl 的原始宽高\r\n\t\t_this._origImageWidth = -1;\r\n\t\t_this._origImageHeight = -1;\r\n\r\n\t\t// ImageControl 里 image 实际占用的宽/高\r\n\t\t_this._width = 0;\r\n\t\t_this._height = 0;\r\n\r\n\t\t// ImageControl 位置信息\r\n\t\t_this.Left = 0;\r\n\t\t_this.Top = 0;\t\r\n\r\n\t\t_this.objImage = false;\r\n\t\t_this.imageUrl = null;\r\n\r\n\t\t// ImageControl 在 client 端的索引\r\n\t\t_this.cIndex = -1;\r\n\r\n\t\t_this.bVisible = true;\r\n\r\n\t\t_this.viewer = null;\r\n\r\n\t\t// 初始化 ImageControl\r\n\t\t_this.__init(cfg);\r\n\t}\r\n\r\n\t// 初始化\r\n\tImageControl.prototype.__init = function (cfg) {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.viewer = cfg.viewer;\r\n\t\t_this.controlWidth = _this.containerWidth = cfg.imgContainerW;\r\n\t\t_this.controlHeight = _this.containerHeight = cfg.imgContainerH;\r\n\t\t_this.imageUrl = cfg.imageUrl;\r\n\t\t_this.cIndex = cfg.index;\r\n\r\n\t\t_this.divOut = document.createElement('div');\r\n\t\t_this.divOut.style.display = 'inline-block';\r\n\t\t_this.divOut.style.position = 'absolute';\r\n\t\t_this.divOut.style.top = _this.Top + 'px';\r\n\t\t_this.divOut.style.left = _this.Left + 'px';\r\n\t\t_this.divOut.style.width = _this.controlWidth + 'px';\r\n\t\t_this.divOut.style.height = _this.controlHeight + 'px';\r\n\r\n\t\t_this.__getImageByUrl();\r\n\t};\r\n\r\n\tImageControl.prototype.SetVisible = function (bShow) {\r\n\t\tvar _this = this;\r\n\r\n\t\tif (_this.cIndex == -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_this.bVisible = bShow;\r\n\r\n\t\tif(_this.bVisible){\r\n\t\t\t_this.divOut.style.display = '';\r\n\t\t}else{\r\n\t\t\t_this.divOut.style.display = 'none';\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\tImageControl.prototype.ChangeControlSize = function (width, height) {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.containerWidth = _this.viewer._imgsDivW;\r\n\t\t_this.containerHeight = _this.viewer._imgsDivH;\r\n\t\t\r\n\t\t_this.controlWidth = width;\r\n\t\t_this.controlHeight = height;\r\n\t\t_this.divOut.style.width = _this.controlWidth + 'px';\r\n\t\t_this.divOut.style.height = _this.controlHeight + 'px';\r\n\r\n\t\t_this.Left = (_this.containerWidth - _this.controlWidth)/2;\r\n\t\t_this.Top = (_this.containerHeight - _this.controlHeight)/2;\r\n\r\n\t\tif(_this.cIndex == _this.viewer.GetCurentIndex())\r\n\t\t\t_this.SetLocation(_this.Left, _this.Top);\r\n\r\n\t\t_this.Show();\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 设置控件位置\r\n\tImageControl.prototype.SetLocation = function (x, y) {\r\n\t\tvar _this = this;\r\n\t\tif(arguments.length == 0){\r\n\t\t\t_this.Left = (_this.containerWidth - _this.controlWidth)/2;\r\n\t\t\t_this.Top = (_this.containerHeight - _this.controlHeight)/2;\r\n\t\t}\r\n\t\tif(arguments.length == 1){\r\n\t\t\t_this.Left = x;\r\n\t\t}\r\n\t\tif(arguments.length > 1){\r\n\t\t\t_this.Left = x;\r\n\t\t\t_this.Top = y;\r\n\t\t}\r\n\t\t\r\n\t\tif (_this.divOut) {\r\n\t\t\tif (_this.divOut.parentNode)\r\n\t\t\t\t_this.divOut.parentNode.style.position = \"relative\";\r\n\t\t\t_this.divOut.style.position = 'absolute';\r\n\t\t\t_this.divOut.style.left = _this.Left + 'px';\r\n\t\t\t_this.divOut.style.top = _this.Top + 'px';\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\tImageControl.prototype.GetEL = function () {\r\n\t\treturn this.divOut;\r\n\t};\r\n\r\n\tImageControl.prototype.GetIndex = function (){\r\n\t\treturn this.cIndex;\r\n\t}\r\n\r\n\tImageControl.prototype.SetIndex = function (index){\r\n\t\tvar _this = this;\r\n\t\tif(lib.isNumber(index) && index>=0)\r\n\t\t\t_this.cIndex = index;\r\n\t\telse\r\n\t\t\t_this.cIndex = -1;\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// 清空图片，显示Loading...\r\n\tImageControl.prototype.ClearImage = function () {\r\n\t\tvar _this = this;\t\r\n\r\n\t\t_this.objImage = false;\r\n\r\n\t\t_this._origImageWidth = -1;\r\n\t\t_this._origImageHeight = -1;\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 重新显示图片\r\n\tImageControl.prototype.Show = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\tif (_this.cIndex == -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_this.__fitImage();\r\n\t\treturn true;\r\n\t};\r\n\r\n\tImageControl.prototype.Destroy = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.ClearImage();\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 刷新 ImageControl\r\n\tImageControl.prototype.Refresh = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.__getImageByUrl();\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 计算 ImageControl 里实际显示 image 的宽高\r\n\tImageControl.prototype.__fitImage = function () {\r\n\t\tvar _this = this;\r\n\t\tif(!_this.objImage) return;\r\n\r\n\t\tvar objImageLeft, objImageTop;\r\n\t\tvar containerAspectRatio = _this.controlWidth/_this.controlHeight;\r\n\t\tvar imageAspectRatio = _this._origImageWidth/_this._origImageHeight;\r\n\t\tif(containerAspectRatio > imageAspectRatio){\r\n\t\t\t_this._height = _this.controlHeight;\r\n\t\t\t_this._width = imageAspectRatio*_this.controlHeight;\r\n\r\n\t\t\tobjImageLeft = Math.floor((_this.controlWidth-_this._width)/2);\r\n\t\t\tobjImageTop = 0;\r\n\t\t}else{\r\n\t\t\t_this._width = _this.controlWidth;\r\n\t\t\t_this._height = _this.controlWidth/imageAspectRatio;\r\n\r\n\t\t\tobjImageLeft = 0;\r\n\t\t\tobjImageTop = Math.floor((_this.controlHeight-_this._height)/2);\r\n\t\t}\r\n\r\n\t\t_this.objImage.style.position = 'absolute';\r\n\t\t_this.objImage.style.left = objImageLeft + 'px';\r\n\t\t_this.objImage.style.top = objImageTop + 'px';\r\n\t\t_this.objImage.style.width = _this._width + 'px';\r\n\t\t_this.objImage.style.height = _this._height + 'px';\r\n\t}\r\n\r\n\t//把图片加载到控件上\r\n\tImageControl.prototype.__getImageByUrl = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\tvar newImage = new Image();\r\n\t\tnewImage.className = 'aryImages-item';\r\n\t\tnewImage.setAttribute('alt', 'image');\r\n\t\tnewImage.src = _this.imageUrl;\r\n\t\tnewImage.onload = function () {\r\n\t\t\t_this.objImage = newImage;\r\n\t\t\t_this._origImageWidth = newImage.width;\r\n\t\t\t_this._origImageHeight = newImage.height;\r\n\r\n\t\t\t_this.divOut.innerHTML = '';\r\n\t\t\t_this.divOut.appendChild(_this.objImage);\r\n\r\n\t\t\t_this.Show();\r\n\t\t\t_this.SetVisible(true);\r\n\t\t};\r\n\r\n\t\tnewImage.onerror = function (e) {\r\n\t\t\t//newImage.src = url;\r\n\t\t};\r\n\t\treturn true;\r\n\t};\r\n\r\n\tMBC.ImageControl = ImageControl;\r\n\r\n})(Alvin.MBC.Lib, Alvin.MBC);(function (DL, MBC) {\r\n\t\"use strict\";\r\n\tvar lib = DL;\r\n\r\n\tfunction ThumbnailControl(cfg) {\r\n\t\tvar _this = this;\r\n\r\n\t\t// ThumbnailControl 实际占用的宽/高 包括滚动条\r\n\t\t_this._width = 0;\r\n\t\t_this._height = 0;\r\n\r\n\t\t// ThumbnailControl 位置信息\r\n\t\t_this.Left = 0;\r\n\t\t_this.Top = 0;\r\n\r\n\t\t// ThumbnailControl 的原始宽高\r\n\t\t_this._origImageWidth = 0;\r\n\t\t_this._origImageHeight = 0;\r\n\r\n\t\t// canvas宽/高 \r\n\t\t_this.canvasWidth = 0;\r\n\t\t_this.canvasHeight = 0;\r\n\r\n\t\t_this.borderWidth = 1; // 暂时为1, 不要改\r\n\t\t_this.borderColor = '#DDDDDD';\r\n\t\t_this.selectionBorderColor = '#7DA2CE';\r\n\t\t_this.backgroundColor = '#FFFFFF';\r\n\r\n\t\t_this.bSelect = false;\r\n\r\n\t\t// thumbnail 里 image 在 client 端的索引\r\n\t\t_this.cIndex = -1;\r\n\r\n\t\t_this.drawArea = {\r\n\t\t\twidth: _this.canvasWidth,\r\n\t\t\theight: _this.canvasHeight,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t};\r\n\r\n\t\t_this.canvasBackgroundGradientColorPairs = {\r\n\t\t\tNotSelectedHovering: ['rgb(250,252,253)', 'rgb(239,246,253)'],\r\n\t\t\tSelected: ['rgb(221,234,252)', 'rgb(199,222,252)']\r\n\t\t};\r\n\r\n\t\t_this.bVisible = true;\r\n\t\t_this.thumbOut = false;\r\n\t\t_this.thumbCanvas = false;\r\n\r\n\t\t_this.viewer = null;\r\n\r\n\t\t_this.thumbnailImagesPerRow = 3;\r\n\r\n\t\t_this.attachImage = false;\r\n\r\n\t\t// init\r\n\t\t_this.__init(cfg);\r\n\t}\r\n\r\n\t// Method\r\n\t// 初始化\r\n\tThumbnailControl.prototype.__init = function (cfg) {\r\n\t\tvar _this = this,\r\n\t\t\tdoc = window.document;\r\n\r\n\t\t_this.viewer = cfg.viewer;\r\n\t\t_this.Top = _this.viewer.ThumbnailImageMargin;\r\n\t\t_this.Left = _this.viewer.ThumbnailImageMargin;\r\n\r\n\t\t_this.thumbnailImagesPerRow = (_this.viewer.thumbnailImagesPerRow > 2) ? (_this.viewer.thumbnailImagesPerRow) : 3;;\r\n\t\t_this._width = _this.viewer.ThumbnailControlW;\r\n\t\t_this._height = _this.viewer.ThumbnailControlH;\r\n\t\t_this.canvasWidth = _this._width;\r\n\t\t_this.canvasHeight = _this._height;\r\n\r\n\t\t_this.imageUrl = cfg.imageUrl;\r\n\t\t_this.cIndex = cfg.index;\r\n\r\n\t\t_this.thumbOut = doc.createElement('div');\r\n\t\t_this.thumbOut.style.display = 'inline-block';\r\n\t\t_this.thumbOut.style.width = _this._width + 2 + 'px';\r\n\t\t_this.thumbOut.style.height = _this._height + 2 + 'px';\r\n\t\t_this.thumbOut.style.position = 'absolute';\r\n\t\t_this.thumbOut.style.top = _this.Top + 'px';\r\n\t\t_this.thumbOut.style.left = _this.Left + 'px';\r\n\t\t_this.thumbOut.style.border = _this.borderWidth + 'px solid ' + _this.borderColor;\r\n\t\t_this.thumbOut.style.cursor = 'pointer';\r\n\r\n\t\t_this.thumbCanvas = doc.createElement('canvas');\r\n\t\t_this.thumbCanvas.style.position = 'relative';\r\n\t\t_this.thumbCanvas.style.top = '0px';\r\n\t\t_this.thumbCanvas.width = _this.canvasWidth;\r\n\t\t_this.thumbCanvas.height = _this.canvasHeight;\r\n\r\n\t\t_this.thumbOut.appendChild(_this.thumbCanvas);\r\n\r\n\t\tlib.addEvent(_this.thumbOut, \"click\", function () {\r\n\t\t\t_this.viewer.ShowImage(_this.cIndex);\r\n\t\t});\r\n\r\n\t\tlib.addEvent(_this.thumbOut, \"mouseenter\", function () {\r\n\t\t\t_this.bMouseHovering = true;\r\n\t\t\tif (_this.bSelect) return;\r\n\t\t\t_this.Show();\r\n\t\t});\r\n\r\n\t\tlib.addEvent(_this.thumbOut, \"mouseout\", function () {\r\n\t\t\t_this.bMouseHovering = false;\r\n\t\t\tif (_this.bSelect) return;\r\n\t\t\t_this.Show();\r\n\t\t});\r\n\r\n\t\t_this.__getImageByUrl();\r\n\t};\r\n\r\n\tThumbnailControl.prototype.SetVisible = function (bShow) {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.bVisible = bShow;\r\n\t\tif (bShow) {\r\n\t\t\t_this.thumbOut.style.display = '';\r\n\t\t\t_this.Show();\r\n\t\t} else {\r\n\t\t\t_this.thumbOut.style.display = 'none';\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.ChangeControlSize = function (width, height) {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this._width = width;\r\n\t\t_this._height = height;\r\n\r\n\t\t_this.canvasWidth = width;\r\n\t\t_this.canvasHeight = height;\r\n\r\n\t\t_this.thumbOut.style.width = _this._width + 2 + 'px';\r\n\t\t_this.thumbOut.style.height = _this._height + 2 + 'px';\r\n\r\n\t\t_this.Show();\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 设置背景色\r\n\tThumbnailControl.prototype.SetBackgroundColor = function (bkcolor) {\r\n\t\tvar _this = this;\r\n\t\t_this.backgroundColor = bkcolor;\r\n\r\n\t\t_this.Show();\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 设置控件位置\r\n\tThumbnailControl.prototype.SetLocation = function (l, t) {\r\n\t\tvar _this = this;\r\n\t\t_this.Left = l;\r\n\t\t_this.Top = t;\r\n\r\n\t\tif (_this.thumbOut) {\r\n\t\t\tif (_this.thumbOut.parentNode)\r\n\t\t\t\t_this.thumbOut.parentNode.style.position = \"relative\";\r\n\t\t\t_this.thumbOut.style.left = l + 'px';\r\n\t\t\t_this.thumbOut.style.top = t + 'px';\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 设置border颜色\r\n\tThumbnailControl.prototype.SetSelectionImageBorderColor = function (selectionBorderColor) {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.selectionBorderColor = selectionBorderColor;\r\n\t\t_this.__refreshBorder();\r\n\t\treturn true;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.GetEL = function () {\r\n\r\n\t\treturn this.thumbOut;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.GetControlWidth = function () {\r\n\t\treturn this._width;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.GetControlHeight = function () {\r\n\t\treturn this._height;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.SetIndex = function (index) {\r\n\t\tvar _this = this;\r\n\t\tif (lib.isNumber(index) && index >= 0)\r\n\t\t\t_this.cIndex = index;\r\n\t\telse\r\n\t\t\t_this.cIndex = -1;\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 清空图片，显示Loading...\r\n\tThumbnailControl.prototype.ClearImage = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.objImage = false;\r\n\r\n\t\t_this._origImageWidth = -1;\r\n\t\t_this._origImageHeight = -1;\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 重新显示图片\r\n\tThumbnailControl.prototype.Show = function (bShowFromScrollEvent) {\r\n\t\tvar _this = this,\r\n\t\t\tctx;\r\n\r\n\t\tif (_this.bVisible) {\r\n\t\t\t_this.thumbOut.style.display = 'inline-block';\r\n\t\t} else {\r\n\t\t\t_this.thumbOut.style.display = 'none';\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tctx = _this.thumbCanvas.getContext(\"2d\");\r\n\t\t_this.__restoreCanvas(ctx, _this.canvasWidth, _this.canvasHeight);\r\n\r\n\t\tctx.clearRect(0, 0, _this.canvasWidth, _this.canvasHeight);\r\n\r\n\t\tif (!_this.objImage ||\r\n\t\t\t_this.objImage.src == 'data:,' ||\r\n\t\t\t_this.objImage.width == 0 || _this.objImage.height == 0 ||\r\n\t\t\t_this.objImage.src == '') {\r\n\r\n\t\t\t// fill background color\r\n\t\t\tctx.fillStyle = _this.backgroundColor;\r\n\r\n\t\t\tctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n\r\n\t\t\t// if width>53px show \"Loading...\"\r\n\r\n\t\t\tif (_this._width > 53) {\r\n\t\t\t\tctx.font = \"12px Times New Roman\";\r\n\t\t\t\tctx.textAlign = \"center\";\r\n\t\t\t\tctx.strokeText(\"Loading...\", ctx.canvas.width * 0.5, ctx.canvas.height * 0.5);\r\n\t\t\t}\r\n\r\n\t\t\t//Actually draw the image on canvas\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (_this.cIndex == -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_this.__fitImage();\r\n\r\n\t\tif (_this.drawArea.width < _this.canvasWidth || _this.drawArea.height < _this.canvasHeight) {\r\n\t\t\t// 如果宽、高比当前画布小，说明有留白，需要画背景色\r\n\t\t\tvar gradient = ctx.createLinearGradient(0, 0, _this.canvasWidth, _this.canvasHeight);\r\n\r\n\t\t\tif (_this.bSelect) {\r\n\t\t\t\tgradient.addColorStop(0, _this.canvasBackgroundGradientColorPairs.Selected[0]);\r\n\t\t\t\tgradient.addColorStop(1, _this.canvasBackgroundGradientColorPairs.Selected[1]);\r\n\t\t\t\tctx.fillStyle = gradient;\r\n\t\t\t} else if (_this.bMouseHovering) {\r\n\t\t\t\tgradient.addColorStop(0, _this.canvasBackgroundGradientColorPairs.NotSelectedHovering[0]);\r\n\t\t\t\tgradient.addColorStop(1, _this.canvasBackgroundGradientColorPairs.NotSelectedHovering[1]);\r\n\t\t\t\tctx.fillStyle = gradient;\r\n\t\t\t} else {\r\n\t\t\t\tctx.fillStyle = _this.backgroundColor;\r\n\t\t\t}\r\n\r\n\t\t\tctx.fillRect(0, 0, _this.canvasWidth, _this.canvasHeight);\r\n\t\t}\r\n\r\n\t\tif (_this.objImage) {\r\n\r\n\t\t\tif (_this.attachImage) {\r\n\t\t\t\t_this.thumbOut.style.position = 'relative';\r\n\t\t\t\t_this.objImage.style.position = 'absolute';\r\n\t\t\t\t_this.objImage.style.top = Math.floor(_this.drawArea.y) + 'px';\r\n\t\t\t\t_this.objImage.style.left = Math.floor(_this.drawArea.x) + 'px';\r\n\r\n\t\t\t\t_this.thumbOut.appendChild(_this.objImage);\r\n\t\t\t} else {\r\n\t\t\t\tctx.drawImage(_this.objImage, Math.floor(_this.drawArea.x), Math.floor(_this.drawArea.y), _this.drawArea.width, _this.drawArea.height);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 图片被选中\r\n\tThumbnailControl.prototype.SetSelect = function (bSelect) {\r\n\t\tvar _this = this;\r\n\t\t_this.bSelect = bSelect;\r\n\t\t_this.__refreshBorder();\r\n\t\t_this.Show();\r\n\t\treturn true;\r\n\t};\r\n\r\n\r\n\tThumbnailControl.prototype.Destroy = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\tif (_this.thumbCanvas) {\r\n\t\t\tvar ctx = _this.thumbCanvas.getContext(\"2d\");\r\n\t\t\tif (_this.canvasWidth > 0 && _this.canvasHeight > 0)\r\n\t\t\t\tctx.clearRect(0, 0, _this.canvasWidth, _this.canvasHeight);\r\n\t\t}\r\n\r\n\t\t_this.ClearImage();\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.Refresh = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.__getImageByUrl();\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 清空图片，显示Loading...\r\n\tThumbnailControl.prototype.ClearControl = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\t_this.ClearImage();\r\n\t\t_this.Show();\r\n\t\treturn true;\r\n\t};\r\n\r\n\t// 计算 ThumbnailControl 里实际显示 image 的宽高\r\n\tThumbnailControl.prototype.__fitImage = function () {\r\n\t\tvar _this = this;\r\n\t\tvar canvasAspectRatio = _this.canvasWidth / _this.canvasHeight;\r\n\t\tvar imageAspectRatio = _this._origImageWidth / _this._origImageHeight;\r\n\t\tif (canvasAspectRatio > imageAspectRatio) {\r\n\t\t\t_this.drawArea.height = _this.canvasHeight;\r\n\t\t\t_this.drawArea.width = imageAspectRatio * _this.canvasHeight;\r\n\r\n\t\t\t_this.drawArea.x = Math.floor((_this.canvasWidth - _this.drawArea.width) / 2);\r\n\t\t\t_this.drawArea.y = 0;\r\n\t\t} else {\r\n\t\t\t_this.drawArea.width = _this.canvasWidth;\r\n\t\t\t_this.drawArea.height = _this.drawArea.width / imageAspectRatio;\r\n\r\n\t\t\t_this.drawArea.x = 0;\r\n\t\t\t_this.drawArea.y = Math.floor((_this.canvasHeight - _this.drawArea.height) / 2);\r\n\t\t}\r\n\t}\r\n\r\n\t//把图片加载到控件上\r\n\tThumbnailControl.prototype.__getImageByUrl = function () {\r\n\t\tvar _this = this;\r\n\r\n\t\tvar newImage = new Image();\r\n\t\tnewImage.className = 'aryThumbnailControls-item';\r\n\t\tnewImage.setAttribute('alt', 'image');\r\n\t\tnewImage.src = _this.imageUrl;\r\n\t\tnewImage.onload = function () {\r\n\t\t\t_this.objImage = newImage;\r\n\t\t\t_this._origImageWidth = newImage.width;\r\n\t\t\t_this._origImageHeight = newImage.height;\r\n\r\n\t\t\t_this.Show();\r\n\t\t};\r\n\r\n\t\tnewImage.onerror = function (e) {\r\n\t\t\t//newImage.src = url;\r\n\t\t};\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.__restoreCanvas = function (ctx, w, h) {\r\n\t\tvar _this = this;\r\n\t\tctx.canvas.width = w;\r\n\t\tctx.canvas.height = h;\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\tThumbnailControl.prototype.__refreshBorder = function () {\r\n\t\tvar _this = this;\r\n\t\tif (_this.bSelect) {\r\n\t\t\t// set border\r\n\t\t\t_this.thumbOut.style.border = _this.borderWidth + 'px solid ' + _this.selectionBorderColor;\r\n\t\t\t_this.thumbOut.style.cursor = 'default';\r\n\t\t} else {\r\n\t\t\t_this.thumbOut.style.border = _this.borderWidth + 'px solid ' + _this.borderColor;\r\n\t\t\t_this.thumbOut.style.cursor = 'pointer';\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\tMBC.ThumbnailControl = ThumbnailControl;\r\n\r\n})(Alvin.MBC.Lib, Alvin.MBC);(function (DL, MBC) {\r\n    \"use strict\";\r\n    var lib = DL;\r\n\r\n    function ImageViewer(cfg) {\r\n        var _this = this;\r\n        var containerDiv = [\r\n            '<div class=\"imageContainer\">',\r\n            '<div class=\"kPainterImgsDiv\">',\r\n            '<canvas class=\"kPainterCanvas\" style=\"display:none;position:absolute;\"></canvas>',\r\n            '</div>',\r\n            '</div>',\r\n            '<div class=\"thumbnailContainer\"></div>'\r\n        ].join('');\r\n        _this._imageViewer = document.getElementById(cfg.ContainerId);\r\n        _this._imageViewer.innerHTML = containerDiv;\r\n        _this._canvas = lib._querySelectorAll(_this._imageViewer, 'canvas.kPainterCanvas')[0];\r\n        _this.ctx = _this._canvas.getContext('2d');\r\n        _this._imgContainer = lib._querySelectorAll(_this._imageViewer, 'div.imageContainer')[0];\r\n        _this._imgsDiv = lib._querySelectorAll(_this._imageViewer, 'div.kPainterImgsDiv')[0];\r\n        _this._thumbnailContainer = lib._querySelectorAll(_this._imageViewer, 'div.thumbnailContainer')[0];\r\n\r\n        if (cfg.Width)\r\n            _this._imageViewerW = cfg.Width;\r\n\r\n        if (cfg.Height)\r\n            _this._imageViewerH = cfg.Height;\r\n\r\n        _this._imageViewer.style.width = _this._imageViewerW;\r\n        _this._imageViewer.style.height = _this._imageViewerH;\r\n\r\n        _this._defaultFileInput = document.createElement(\"input\");\r\n        _this._defaultFileInput.setAttribute(\"type\", \"file\");\r\n        _this._defaultFileInput.setAttribute(\"accept\", \"image/bmp,image/gif,image/jpeg,image/png,image/webp\");\r\n        _this._defaultFileInput.setAttribute(\"multiple\", \"true\");\r\n\r\n        _this.curIndex = -1;\r\n\r\n        // ImageViewer 当前所处的模式：view、edit\r\n        _this.mode = 'view';\r\n\r\n        _this._errorCode = 0;\r\n        _this._errorString = '';\r\n\r\n        // ImageControl 数组\r\n        _this.aryImageControls = [];\r\n        _this.BackgroundColor = \"#FFFFFF\";\r\n\r\n        // ThumbnailControl 数组\r\n        _this.aryThumbnailControls = [];\r\n        // Thumbnails 中多个控件之间的距离\r\n        _this.ThumbnailImageMargin = 10;\r\n        // Thumbnails 中的小控件的宽度\r\n        _this.ThumbnailControlW = 0;\r\n        // Thumbnails 中的小控件的高度\r\n        _this.ThumbnailBackgroundColor = \"#FFFFFF\";\r\n        _this.ThumbnailControlH = 0;\r\n        _this._thumbnailsDiv = document.createElement('div');\r\n        _this._thumbnailsDiv.style.width = _this._thumbnailContainerW + 'px';\r\n        // _this._thumbnailsDiv.style.width = '100%';\r\n        _this._thumbnailContainer.appendChild(_this._thumbnailsDiv);\r\n\r\n        lib.addEvent(_this._defaultFileInput, \"change\", function (event) {\r\n            var ev = event || window.event;\r\n\r\n            if (_this.beforeAddImgFromFileChooseWindow) {\r\n                lib.doCallbackNoBreak(_this.beforeAddImgFromFileChooseWindow, [ev, false]);\r\n            } else {\r\n                _this.LoadImageEx(ev.target.files);\r\n            }\r\n\r\n        });\r\n\r\n        lib.addEvent(_this._imageViewer, \"dragover\", function (event) {\r\n            var ev = event || window.event;\r\n            lib.stopDefault(ev);\r\n        });\r\n\r\n        lib.addEvent(_this._imageViewer, \"drop\", function (event) {\r\n            var ev = event || window.event;\r\n            if (_this.mode != 'view') return;\r\n            lib.stopDefault(ev);\r\n            _this.LoadImageEx(ev.dataTransfer.files);\r\n        });\r\n\r\n        _this._startPos = {};\r\n        lib.addEvent(_this._imgContainer, \"touchstart mousedown\", fuc_touchstart);\r\n        lib.addEvent(_this._imgContainer, \"touchmove\", fuc_touchmove);\r\n        lib.addEvent(_this._imgContainer, \"touchend mouseup\", fuc_touchend);\r\n\r\n        function fuc_touchstart(event) {\r\n            var ev = event || window.event;\r\n            if (_this.mode != 'view') return;\r\n            lib.stopDefault(ev);\r\n\r\n            lib.addEvent(_this._imgContainer, \"mousemove\", fuc_touchmove);\r\n            lib.addEvent(_this._imgContainer, \"mouseleave\", fuc_touchend);\r\n\r\n            var touches = ev.changedTouches;\r\n\r\n            if (touches) {\r\n                //Multi-contact is prohibited\r\n                if (touches.length != 1) {\r\n                    return false;\r\n                }\r\n\r\n                _this._startPos = {\r\n                    startX: touches[0].pageX,\r\n                    startY: touches[0].pageY\r\n                }\r\n            } else {\r\n                _this._startPos = {\r\n                    startX: ev.clientX,\r\n                    startY: ev.clientY\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        function fuc_touchmove(event) {\r\n            var ev = event || window.event;\r\n            if (_this.mode != 'view') return;\r\n            lib.stopDefault(ev);\r\n\r\n            if (_this.GetCount() < 2) {\r\n                return false;\r\n            }\r\n\r\n            var touches = ev.changedTouches;\r\n\r\n            if (touches) {\r\n                var _curOffsetX = touches[0].pageX - _this._startPos.startX,\r\n                    _curOffsetY = touches[0].pageY - _this._startPos.startY;\r\n            } else {\r\n                var _curOffsetX = ev.clientX - _this._startPos.startX,\r\n                    _curOffsetY = ev.clientY - _this._startPos.startY;\r\n            }\r\n\r\n            var _aryImgs = _this.aryImageControls,\r\n                _curIndex = _this.curIndex,\r\n                _pIndex = (_curIndex - 1) < 0 ? (_aryImgs.length - 1) : (_curIndex - 1),\r\n                _nIndex = (_curIndex + 1) > (_aryImgs.length - 1) ? 0 : (_curIndex + 1);\r\n\r\n            _aryImgs[_curIndex].SetLocation((_this._imgsDivW - _aryImgs[_curIndex].controlWidth) / 2 + _curOffsetX);\r\n            _aryImgs[_pIndex].SetLocation(-(_this._imgContainerW - _curOffsetX));\r\n            _aryImgs[_nIndex].SetLocation(_this._imgContainerW + _curOffsetX);\r\n\r\n            //console.log('pageX: '+touches[0].pageX+\" pageY: \"+touches[0].pageY);   \r\n        }\r\n\r\n        function fuc_touchend(event) {\r\n            var ev = event || window.event;\r\n            if (_this.mode != 'view') return;\r\n            lib.stopDefault(ev);\r\n\r\n            if (_this.GetCount() < 1) {\r\n                return false;\r\n            }\r\n\r\n            lib.removeEvent(_this._imgContainer, \"mousemove\", fuc_touchmove);\r\n            lib.removeEvent(_this._imgContainer, \"mouseleave\", fuc_touchend);\r\n\r\n            if (_this.GetCount() < 2) {\r\n                return false;\r\n            }\r\n\r\n            var touches = ev.changedTouches;\r\n\r\n            if (touches) {\r\n                var _curOffsetX = touches[0].pageX - _this._startPos.startX,\r\n                    _curOffsetY = touches[0].pageY - _this._startPos.startY;\r\n            } else {\r\n                var _curOffsetX = ev.clientX - _this._startPos.startX,\r\n                    _curOffsetY = ev.clientY - _this._startPos.startY;\r\n            }\r\n\r\n            if (_curOffsetX > _this._imgsDivW / 3) {\r\n                _this.ChangePage('p');\r\n            } else if (_curOffsetX < -_this._imgsDivW / 3) {\r\n                _this.ChangePage('n');\r\n            } else {\r\n                _this.__reInitImageControlPosition();\r\n            }\r\n        }\r\n\r\n        //https://developer.mozilla.org/zh-CN/docs/Web/Events\r\n\r\n        // 操做数组：记录操作方法\r\n        _this.stack = [];\r\n        _this.curStep = -1;\r\n\r\n        // ImageViewer 当前显示的图片是否因为旋转而宽高互换\r\n        _this.isSwitchedWH = false;\r\n\r\n        // 是否替换原图\r\n        _this.replaceOriginalImage = false;\r\n\r\n        // Canvas 的宽高和位置信息\r\n        _this._canvasArea = {\r\n            width: 300,\r\n            height: 150,\r\n            left: 0,\r\n            top: 0\r\n        };\r\n\r\n        _this.videoSettings = {\r\n            video: {\r\n                /*width:{ideal:2048},height:{ideal:2048},*/\r\n                facingMode: {\r\n                    ideal: \"environment\"\r\n                }\r\n            }\r\n        };\r\n\r\n        var cfg = {};\r\n        cfg.viewer = _this;\r\n        cfg.videoSettings = _this.videoSettings;\r\n        cfg.container = _this._imgContainer;\r\n\r\n        _this.VideoViewer = new MBC.VideoViewer(cfg);\r\n        _this.ImageAreaSelector = new MBC.ImageAreaSelector(cfg);\r\n\r\n        lib.attachProperty(_this);\r\n        // 设置  ImageViewer 里的元素宽高\r\n        _this.__init();\r\n    }\r\n\r\n    ImageViewer.prototype.beforeAddImgFromFileChooseWindow = null;\r\n    ImageViewer.prototype.afterAddImgFromFileChooseWindow = null;\r\n\r\n    ImageViewer.prototype.beforeAddImgFromDropFile = null;\r\n    ImageViewer.prototype.afterAddImgFromDropFile = null;\r\n\r\n    ImageViewer.prototype.__init = function () {\r\n        var _this = this;\r\n\r\n        _this._imageViewerW = lib.getElDimensions(_this._imageViewer).clientWidth;\r\n        _this._imageViewerH = lib.getElDimensions(_this._imageViewer).clientHeight;\r\n\r\n        _this._imgContainerW = lib.getElDimensions(_this._imgContainer).clientWidth;\r\n        _this._imgContainerH = lib.getElDimensions(_this._imgContainer).clientHeight;\r\n\r\n        _this._imgsDivW = lib.getElDimensions(_this._imgsDiv).clientWidth;\r\n        _this._imgsDivH = lib.getElDimensions(_this._imgsDiv).clientHeight;\r\n\r\n        _this._thumbnailContainerW = lib.getElDimensions(_this._thumbnailContainer).clientWidth;\r\n        _this._thumbnailContainerH = lib.getElDimensions(_this._thumbnailContainer).clientHeight;\r\n        // _this._thumbnailContainerH = _this._imageViewerH;\r\n\r\n        // console.log(_this._thumbnailContainerW, \"_this._thumbnailContainerW \")\r\n        // console.log(_this._thumbnailContainerH, \"_this._thumbnailContainerH \")\r\n        // console.log(_this.thumbnailImagesPerRow, \"_this.thumbnailImagesPerRow \")\r\n        // console.log(Math.floor(_this._thumbnailContainerH / _this._thumbnailContainerW), \"Math.floor(_this._thumbnailContainerH / _this._thumbnailContainerW) \")\r\n\r\n        // Thumbnails 中每行的控件数\r\n        _this.thumbnailImagesPerRow = Math.floor(_this._thumbnailContainerH / _this._thumbnailContainerW) > 2 ? Math.floor(_this._thumbnailContainerH / _this._thumbnailContainerW) : 3;\r\n\r\n        _this._thumbnailsDiv.style.height = _this._thumbnailContainerH + 'px';\r\n    }\r\n\r\n    ImageViewer.prototype.AdaptiveLayout = function () {\r\n        var _this = this;\r\n\r\n        _this.__init();\r\n\r\n        // 重置 ImageControl 控件的宽高和位置\r\n        var _aryImgs = _this.aryImageControls;\r\n        for (var i = 0; i < _aryImgs.length; i++) {\r\n            var tempW = _aryImgs[i].controlWidth,\r\n                tempH = _aryImgs[i].controlHeight;\r\n            if (tempW < _this._imgsDivW && tempH < _this._imgsDivH) {\r\n                _aryImgs[i].ChangeControlSize(tempW, tempH);\r\n            } else {\r\n                _aryImgs[i].ChangeControlSize(_this._imgsDivW, _this._imgsDivH);\r\n            }\r\n        }\r\n\r\n        // 重置 ThumbnailControl 控件的宽高和位置\r\n        _this.__reInitThumbnailControlPosition();\r\n\r\n        // 重置 canvas 控件的宽高和位置\r\n        if (_this.mode == 'edit') {\r\n            _this.__setCanvasStyleFit();\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.LoadImageEx = function (imgData) {\r\n        var _this = this;\r\n        if (_this.mode == 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'LoadImageEx', 'edit');\r\n            return false;\r\n        }\r\n\r\n        if (arguments.length == 0) {\r\n            _this.ShowFileChooseWindow();\r\n            return;\r\n        }\r\n\r\n        if (imgData instanceof Blob || imgData instanceof HTMLCanvasElement || typeof imgData == \"string\" || imgData instanceof String || imgData instanceof HTMLImageElement) {\r\n            lib.getBlobFromAnyImgData(imgData, function (blob) {\r\n                _this.LoadImageInner(blob);\r\n            });\r\n        } else if (imgData instanceof Array || imgData instanceof FileList) {\r\n            for (var i = 0; i < imgData.length; ++i) {\r\n                _this.LoadImageEx(imgData[i]);\r\n            }\r\n            return;\r\n        } else {\r\n            //_this._errorString = \"addImage(imgData): Type of 'imgData' should be 'Blob', 'HTMLCanvasElement', 'HTMLImageElement', 'String(url)', 'Array(a array of source)', 'FileList'.\";\r\n            lib.Errors.InvalidParameterType(_this);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    ImageViewer.prototype.LoadImageInner = function (url) {\r\n        var _this = this,\r\n            cfg = {};\r\n        cfg.viewer = _this;\r\n        cfg.imageViewerW = _this._imageViewerW;\r\n        cfg.imageViewerH = _this._imageViewerH;\r\n        cfg.imgContainerW = _this._imgsDivW;\r\n        cfg.imgContainerH = _this._imgsDivH;\r\n        cfg.index = _this.curIndex = _this.aryImageControls.length;\r\n\r\n        if (url instanceof Blob) {\r\n            cfg.imageUrl = URL.createObjectURL(url);\r\n        } else {\r\n            cfg.imageUrl = url;\r\n        }\r\n\r\n        // 添加 ImageControl \r\n        var objImageControl = new MBC.ImageControl(cfg);\r\n        _this.aryImageControls.push(objImageControl);\r\n        _this.__addImgToContainer(objImageControl.GetEL());\r\n\r\n        // 添加 ThumbnailControl \r\n        var objThumbnailControl = new MBC.ThumbnailControl(cfg);\r\n        _this.aryThumbnailControls.push(objThumbnailControl);\r\n        _this.__addImgToThumbnail(objThumbnailControl.GetEL());\r\n\r\n        _this.__resetSelection();\r\n\r\n        _this._updateNumUI();\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.ShowVideo = function () {\r\n        this.VideoViewer.showVideo();\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.ShowImage = function (index) {\r\n        var _this = this;\r\n\r\n        if (index < 0 || index > _this.aryImageControls.length - 1) {\r\n            lib.Errors.InvalidValue(_this);\r\n            return false;\r\n        }\r\n        _this.curIndex = index;\r\n\r\n        _this.__reInitImageControlPosition();\r\n        _this.__resetSelection();\r\n\r\n        _this._updateNumUI();\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.ChangePage = function (cmd) {\r\n        var _this = this;\r\n        var _index;\r\n        switch (cmd) {\r\n            case \"f\":\r\n                _index = 0;\r\n                break;\r\n            case \"p\":\r\n                _index = _this.curIndex - 1;\r\n                break;\r\n            case \"n\":\r\n                _index = _this.curIndex + 1;\r\n                break;\r\n            case \"l\":\r\n                _index = _this.aryImageControls.length - 1;\r\n                break;\r\n            default:\r\n                if (arguments.length < 1 || isNaN(cmd)) {\r\n                    return false;\r\n                } else {\r\n                    _index = Math.round(cmd);\r\n                }\r\n        }\r\n        /*eslint-enable indent*/\r\n        if (_index < 0) {\r\n            _index = _this.aryImageControls.length - 1;\r\n        } else if (_index > _this.aryImageControls.length - 1) {\r\n            _index = 0;\r\n        }\r\n\r\n        _this.ShowImage(_index);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.GetCurentIndex = function () {\r\n        return this.curIndex;\r\n    }\r\n\r\n    ImageViewer.prototype.GetCount = function () {\r\n        return this.aryImageControls.length;\r\n    }\r\n\r\n    ImageViewer.prototype.GetImage = function (index, isOri) {\r\n        var _curIndex = index || this.curIndex;\r\n        if (isOri) {\r\n            return this.aryImageControls[_curIndex];\r\n        } else {\r\n            return this.aryImageControls[_curIndex].cloneNode(true);\r\n        }\r\n\r\n    }\r\n\r\n    lib.each(['SaveAsBMP', 'SaveAsJPEG', 'SaveAsTIFF', 'SaveAsPNG', 'SaveAsPDF'], function (method) {\r\n        ImageViewer.prototype[method] = function (filename, index) {\r\n            var _this = this;\r\n            if (_this.mode == 'edit') {\r\n                lib.Errors.FucNotValidInThisMode(_this, method, 'edit');\r\n                return false;\r\n            }\r\n            if (arguments.length < 2) {\r\n                index = _this.curIndex;\r\n            }\r\n            if (!lib.isNumber(index)) {\r\n                return false;\r\n            }\r\n            index = Math.round(index);\r\n            if (index < 0 || index >= _this.aryImageControls.length) {\r\n                return false;\r\n            }\r\n\r\n            var a = document.createElement('a');\r\n            a.target = '_blank';\r\n            var img = _this.aryImageControls[index].objImage;\r\n            var blob = img.src;\r\n\r\n            if (!filename) {\r\n                filename = (new Date()).getTime() + '.png';\r\n            }\r\n            a.download = filename;\r\n            //var objUrl = URL.createObjectURL(blob);\r\n            var objUrl = blob;\r\n            a.href = objUrl;\r\n            var ev = new MouseEvent('click', {\r\n                \"view\": window,\r\n                \"bubbles\": true,\r\n                \"cancelable\": false\r\n            });\r\n            a.dispatchEvent(ev);\r\n            //a.click();\r\n            setTimeout(function () {\r\n                URL.revokeObjectURL(objUrl);\r\n            }, 10000);\r\n            return filename;\r\n        };\r\n    });\r\n\r\n    ImageViewer.prototype.ShowFileChooseWindow = function () {\r\n        var _this = this;\r\n        if (_this.mode == 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'ShowFileChooseWindow', 'edit');\r\n            return false;\r\n        }\r\n\r\n        _this._defaultFileInput.click();\r\n        return true;\r\n    };\r\n\r\n    // 获取 imageviewer 的背景色\r\n    ImageViewer.prototype.GetBackgroundColor = function (v) {\r\n        return this.BackgroundColor;\r\n    };\r\n\r\n    // 设置 imageviewer 的背景色\r\n    ImageViewer.prototype.SetBackgroundColor = function (v) {\r\n        var _this = this;\r\n        _this.BackgroundColor = v;\r\n\r\n        if (_this._imgContainer)\r\n            _this._imgContainer.style.backgroundColor = v;\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    // 设置裁切框的背景色\r\n    ImageViewer.prototype.SetCropBackgroundColor = function (v) {\r\n        var _this = this;\r\n        var cells = _this.ImageAreaSelector.kPainterCells;\r\n        _this.ImageAreaSelector.backgroundColor = v;\r\n        for (var i = 0; i < cells.length; i++) {\r\n            cells[i].style.backgroundColor = v;\r\n        }\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    }\r\n\r\n    // 设置裁切框的边框色\r\n    ImageViewer.prototype.SetCropBorderColor = function (v) {\r\n        var _this = this;\r\n        var cells = _this.ImageAreaSelector.kPainterCells;\r\n        var corners = _this.ImageAreaSelector.kPainterCorners;\r\n        _this.ImageAreaSelector.borderColor = v;\r\n        for (var i = 0; i < cells.length; i++) {\r\n            cells[i].style.borderColor = v;\r\n        }\r\n        for (var i = 0; i < corners.length; i++) {\r\n            corners[i].style.borderColor = v;\r\n        }\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.GetThumbnaiBackgroundColor = function (v) {\r\n        return this.ThumbnailBackgroundColor;\r\n    };\r\n\r\n    ImageViewer.prototype.SetThumbnailBackgroundColor = function (v) {\r\n        var _this = this;\r\n        _this.ThumbnailBackgroundColor = v;\r\n\r\n        if (_this._thumbnailContainer)\r\n            _this._thumbnailContainer.style.backgroundColor = v;\r\n\r\n        for (var i = 0; i < _this.aryThumbnailControls.length; i++) {\r\n            _this.aryThumbnailControls[i].SetBackgroundColor(_this.ThumbnailBackgroundColor);\r\n        }\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.GetThumbnailImageMargin = function () {\r\n        var _this = this;\r\n        return _this.ThumbnailImageMargin;\r\n    };\r\n\r\n    ImageViewer.prototype.SetThumbnailImageMargin = function (v) {\r\n        var _this = this;\r\n\r\n        if (v <= 0 || (v > _this._thumbnailContainerH / _this.thumbnailImagesPerRow) || (v > _this._thumbnailContainerW)) {\r\n            lib.Errors.InvalidValue(_this);\r\n            return false;\r\n        } else {\r\n            _this.ThumbnailImageMargin = parseInt(v);\r\n\r\n            _this.__reInitThumbnailControlPosition();\r\n            lib.Errors.Sucess(_this);\r\n            return true;\r\n        }\r\n    };\r\n\r\n    ImageViewer.prototype.ShowImageEditor = function () {\r\n        var _this = this;\r\n        if (_this.mode == 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'ShowImageEditor', 'edit');\r\n            return false;\r\n        } else if (_this.curIndex < 0) {\r\n            lib.Errors.IndexOutOfRange(_this);\r\n            return false;\r\n        }\r\n        _this.mode = 'edit';\r\n\r\n        var curImg = _this.aryImageControls[_this.curIndex];\r\n        curImg.SetVisible(false);\r\n        _this.__setCanvasVisible(true);\r\n        _this.ctx.clearRect(0, 0, _this._canvasArea.width, _this._canvasArea.height);\r\n        _this._canvasArea = {\r\n            width: 300,\r\n            height: 150,\r\n            left: 0,\r\n            top: 0\r\n        };\r\n        var transformNew = new kUtil.Matrix(1, 0, 0, 1, 0, 0);\r\n        $(_this._canvas).setTransform(transformNew);\r\n        var _curStack = {\r\n            fun: 'ShowImageEditor',\r\n            crop: {\r\n                x: 0,\r\n                y: 0,\r\n                width: 1,\r\n                height: 1\r\n            },\r\n            draw: {\r\n                x: 0,\r\n                y: 0,\r\n                width: curImg._origImageWidth,\r\n                height: curImg._origImageHeight\r\n            },\r\n            transform: new kUtil.Matrix(1, 0, 0, 1, 0, 0),\r\n            srcBlob: curImg.imageUrl\r\n        };\r\n        _this.stack.push(_curStack);\r\n        _this.curStep++;\r\n\r\n        _this.__updateCanvasInner(false);\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.CloseImageEditor = function (bShowImg) {\r\n        var _this = this;\r\n        if (_this.mode == 'view') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'CloseImageEditor', 'view');\r\n            return false;\r\n        }\r\n        _this.mode = 'view';\r\n        var _bShowImg = (bShowImg == false) ? false : true;\r\n\r\n        _this.__setCanvasVisible(false);\r\n        _this.aryImageControls[_this.curIndex].SetVisible(_bShowImg);\r\n        _this.stack = [];\r\n        _this.curStep = -1;\r\n        _this.isSwitchedWH = false;\r\n        _this.ImageAreaSelector.HideCropRect();\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.RotateLeft = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'RotateLeft', 'view');\r\n            return false;\r\n        }\r\n\r\n        var transformOri = $(_this._canvas).getTransform();\r\n        var transformNew = kUtil.Matrix.dot(new kUtil.Matrix(0, -1, 1, 0, 0, 0), transformOri);\r\n        $(_this._canvas).setTransform(transformNew);\r\n\r\n        _this.__pushStack('rotateLeft');\r\n        _this.__setCanvasStyleFit();\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.RotateRight = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'RotateRight', 'view');\r\n            return false;\r\n        }\r\n\r\n        var transformOri = $(_this._canvas).getTransform();\r\n        var transformNew = kUtil.Matrix.dot(new kUtil.Matrix(0, 1, -1, 0, 0, 0), transformOri);\r\n        $(_this._canvas).setTransform(transformNew);\r\n\r\n        _this.__pushStack('rotateRight');\r\n        _this.__setCanvasStyleFit();\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.Rotate = function (index, angle) {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'Rotate', 'view');\r\n            return false;\r\n        }\r\n\r\n        var rotateRightTime = parseInt(angle / 90);\r\n        var transformNew = $(_this._canvas).getTransform();\r\n        for (var i = 0; i < rotateRightTime; i++) {\r\n            transformNew = kUtil.Matrix.dot(new kUtil.Matrix(0, 1, -1, 0, 0, 0), transformNew);\r\n        }\r\n        $(_this._canvas).setTransform(transformNew);\r\n\r\n        _this.__pushStack('rotateRight');\r\n        _this.__setCanvasStyleFit();\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.Mirror = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'Mirror', 'view');\r\n            return false;\r\n        }\r\n\r\n        var transformOri = $(_this._canvas).getTransform();\r\n        var transformNew = kUtil.Matrix.dot(new kUtil.Matrix(-1, 0, 0, 1, 0, 0), transformOri);\r\n        $(_this._canvas).setTransform(transformNew);\r\n\r\n        _this.__pushStack('mirror');\r\n        _this.__setCanvasStyleFit();\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.Flip = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'Flip', 'view');\r\n            return false;\r\n        }\r\n\r\n        var transformOri = $(_this._canvas).getTransform();\r\n        var transformNew = kUtil.Matrix.dot(new kUtil.Matrix(1, 0, 0, -1, 0, 0), transformOri);\r\n        $(_this._canvas).setTransform(transformNew);\r\n\r\n        _this.__pushStack('flip');\r\n        _this.__setCanvasStyleFit();\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    };\r\n\r\n    ImageViewer.prototype.Crop = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'Crop', 'view');\r\n            return false;\r\n        }\r\n        var _newCropArea = _this.ImageAreaSelector.__getCropArea();\r\n        if (_newCropArea.x == 0 && _newCropArea.y == 0 && _newCropArea.width == 1 && _newCropArea.height == 1) {\r\n            return;\r\n        }\r\n\r\n        _this.__pushStack('Crop');\r\n\r\n        _this.__updateCanvasInner(false);\r\n\r\n        lib.Errors.Sucess(_this);\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.Save = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'Save', 'view');\r\n            return false;\r\n        }\r\n\r\n        _this.__updateCanvasInner(true);\r\n\r\n        _this.CloseImageEditor(false);\r\n        if (!_this.replaceOriginalImage) {\r\n            _this.LoadImageEx(_this._canvas);\r\n        } else {\r\n            lib.canvasToBlob(_this._canvas, function (blob) {\r\n                var url = URL.createObjectURL(blob);\r\n                var curImg = _this.aryImageControls[_this.curIndex];\r\n                var curThumbImg = _this.aryThumbnailControls[_this.curIndex];\r\n\r\n                curImg.imageUrl = url;\r\n                curImg.Refresh();\r\n\r\n                curThumbImg.imageUrl = url;\r\n                curThumbImg.Refresh();\r\n            });\r\n        }\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.Undo = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'Undo', 'view');\r\n            return false;\r\n        }\r\n        if (_this.curStep > 0) {\r\n            var toStep = _this.curStep - 1;\r\n            while (null == _this.stack[toStep]) {\r\n                --toStep;\r\n            }\r\n            _this.__fromToStepAsync(_this.curStep, toStep);\r\n        }\r\n    }\r\n\r\n    ImageViewer.prototype.Redo = function () {\r\n        var _this = this;\r\n        if (_this.mode != 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'Redo', 'view');\r\n            return false;\r\n        }\r\n        if (_this.curStep < _this.stack.length - 1) {\r\n            var toStep = _this.curStep + 1;\r\n            while (null == _this.stack[toStep]) {\r\n                ++toStep;\r\n            }\r\n            _this.__fromToStepAsync(_this.curStep, toStep);\r\n        }\r\n    }\r\n\r\n    ImageViewer.prototype.RemoveAllSelectedImages = function () {\r\n        var _this = this,\r\n            index = _this.curIndex;\r\n        if (_this.mode == 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'RemoveAllSelectedImages', 'edit');\r\n            return false;\r\n        }\r\n\r\n        // 删除 ImageControl 控件\r\n        _this.__RemoveImageControl(index);\r\n\r\n        // 删除 ThumbnailControl 控件\r\n        _this.__RemoveThumbnailControl(index);\r\n\r\n        var _index = _this.curIndex > (_this.aryImageControls.length - 1) ? (_this.aryImageControls.length - 1) : _this.curIndex;\r\n        _this.ShowImage(_index);\r\n\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.RemoveAllImages = function () {\r\n        var _this = this,\r\n            i;\r\n        if (_this.mode == 'edit') {\r\n            lib.Errors.FucNotValidInThisMode(_this, 'RemoveAllImages', 'edit');\r\n            return false;\r\n        }\r\n\r\n        // 删除 ImageControl 控件\r\n        var iCount = _this.aryImageControls.length;\r\n        for (i = iCount - 1; i >= 0; i--) {\r\n            _this.__RemoveImageControl(i);\r\n        }\r\n\r\n        // 删除 ThumbnailControl 控件\r\n        var iThumbCount = _this.aryThumbnailControls.length;\r\n        for (i = iThumbCount - 1; i >= 0; i--) {\r\n            _this.__RemoveThumbnailControl(i);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.__RemoveImageControl = function (index) {\r\n        var _this = this;\r\n        if (index < _this.aryImageControls.length && index >= 0) {\r\n            var objImgControl = _this.aryImageControls[index];\r\n            objImgControl.Destroy();\r\n            _this.aryImageControls.splice(index, 1);\r\n            _this._imgsDiv.removeChild(objImgControl.GetEL());\r\n        }\r\n        for (var i = index; i < _this.aryImageControls.length; i++) {\r\n            var objImgControl = _this.aryImageControls[i];\r\n            objImgControl.SetIndex(i);\r\n        }\r\n    }\r\n\r\n    ImageViewer.prototype.__RemoveThumbnailControl = function (index) {\r\n        var _this = this;\r\n        if (index < _this.aryThumbnailControls.length && index >= 0) {\r\n            var objThumbControl = _this.aryThumbnailControls[index];\r\n            objThumbControl.Destroy();\r\n            _this.aryThumbnailControls.splice(index, 1);\r\n            _this._thumbnailsDiv.removeChild(objThumbControl.GetEL());\r\n        }\r\n        for (var i = index; i < _this.aryThumbnailControls.length; i++) {\r\n            var objThumbControl = _this.aryThumbnailControls[i];\r\n            objThumbControl.SetIndex(i);\r\n        }\r\n        _this.__reInitThumbnailControlPosition();\r\n    }\r\n\r\n    ImageViewer.prototype.__updateCanvasInner = function (bTrueTransform) {\r\n        var _this = this;\r\n        var img = _this.aryImageControls[_this.curIndex].objImage;\r\n        var imgOW = img.naturalWidth || img.width;\r\n        var imgOH = img.naturalHeight || img.height;\r\n        var process = _this.stack[_this.curStep];\r\n        var crop = process.crop;\r\n        var tsf = process.transform;\r\n        var ctx = _this.ctx;\r\n        var cvs = _this._canvas;\r\n\r\n        var sWidth = cvs.fullQualityWidth = Math.round(imgOW * crop.width) || 1,\r\n            sHeight = cvs.fullQualityHeight = Math.round(imgOH * crop.height) || 1;\r\n        if (0 != tsf.a * tsf.d && 0 == tsf.b * tsf.c) {\r\n            cvs.fullQualityWidth = sWidth;\r\n            cvs.fullQualityHeight = sHeight;\r\n        } else {\r\n            cvs.fullQualityWidth = sHeight;\r\n            cvs.fullQualityHeight = sWidth;\r\n            if (bTrueTransform) {\r\n                _this.isSwitchedWH = true;\r\n            }\r\n        }\r\n        $(cvs).setTransform(new kUtil.Matrix(1, 0, 0, 1, 0, 0));\r\n        cvs.hasCompressed = false;\r\n        if (bTrueTransform) {\r\n            var cvsW, cvsH;\r\n            if (_this.isSwitchedWH) {\r\n                cvsW = sHeight;\r\n                cvsH = sWidth;\r\n            } else {\r\n                cvsW = sWidth;\r\n                cvsH = sHeight;\r\n            }\r\n            cvs.width = cvsW;\r\n            cvs.height = cvsH;\r\n            var drawE = cvsW / 2 * (1 - tsf.a - tsf.c),\r\n                drawF = cvsH / 2 * (1 - tsf.b - tsf.d);\r\n            ctx.setTransform(tsf.a, tsf.b, tsf.c, tsf.d, drawE, drawF);\r\n        } else {\r\n            cvs.width = sWidth;\r\n            cvs.height = sHeight;\r\n        }\r\n        var sx = Math.round(imgOW * crop.x),\r\n            sy = Math.round(imgOH * crop.y);\r\n        if (sx == imgOW) {\r\n            --sx;\r\n        }\r\n        if (sy == imgOH) {\r\n            --sy;\r\n        }\r\n        var dWidth, dHeight;\r\n        if (_this.isSwitchedWH && bTrueTransform) {\r\n            dWidth = cvs.height;\r\n            dHeight = cvs.width;\r\n        } else {\r\n            dWidth = cvs.width;\r\n            dHeight = cvs.height;\r\n        }\r\n        ctx.clearRect(0, 0, dWidth, dHeight);\r\n        ctx.drawImage(img, sx, sy, sWidth, sHeight, 0, 0, dWidth, dHeight);\r\n        if (bTrueTransform) {\r\n            $(cvs).setTransform(new kUtil.Matrix(1, 0, 0, 1, 0, 0));\r\n        } else {\r\n            $(cvs).setTransform(tsf);\r\n        }\r\n\r\n        _this.__setCanvasStyleFit(bTrueTransform);\r\n    };\r\n\r\n    ImageViewer.prototype.__fromToStepAsync = function (fromStep, toStep, callback) {\r\n        var _this = this;\r\n        _this.curStep = toStep;\r\n        var _crop = _this.stack[fromStep].crop;\r\n        var crop = _this.stack[_this.curStep].crop;\r\n        if (_crop.x == crop.x &&\r\n            _crop.y == crop.y &&\r\n            _crop.width == crop.width &&\r\n            _crop.bottom == crop.bottom &&\r\n            _this.stack[fromStep].srcBlob == _this.stack[_this.curStep].srcBlob\r\n        ) {\r\n            // case only do transform, don't redraw mainCvs\r\n            $(_this._canvas).setTransform(_this.stack[_this.curStep].transform.dot(_this.stack[fromStep].transform.inversion()).dot($(_this._canvas).getTransform()));\r\n            _this.__setCanvasStyleFit();\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        } else {\r\n            _this.__updateCanvasInner(false);\r\n        }\r\n    };\r\n\r\n    ImageViewer.prototype.__setCanvasStyleFit = function (bTrueTransform) {\r\n        var _this = this;\r\n        var ca = _this._canvasArea;\r\n        var tsf = _this.stack[_this.curStep].transform;\r\n        if (0 != tsf.a * tsf.d && 0 == tsf.b * tsf.c) {\r\n            _this.isSwitchedWH = false;\r\n        } else {\r\n            _this.isSwitchedWH = true;\r\n        }\r\n\r\n        if (_this.isSwitchedWH && !bTrueTransform) {\r\n            var imageAspectRatio = _this._canvas.height / _this._canvas.width;\r\n        } else {\r\n            var imageAspectRatio = _this._canvas.width / _this._canvas.height;\r\n        }\r\n\r\n        var imgsDivAspectRatio = _this._imgsDivW / _this._imgsDivH;\r\n\r\n        if (imgsDivAspectRatio > imageAspectRatio) {\r\n            ca.height = _this._imgsDivH;\r\n            ca.width = imageAspectRatio * _this._imgsDivH;\r\n        } else {\r\n            ca.width = _this._imgsDivW;\r\n            ca.height = ca.width / imageAspectRatio;\r\n        }\r\n\r\n        if (_this.isSwitchedWH && !bTrueTransform) {\r\n            var tempW = ca.width;\r\n            ca.width = ca.height;\r\n            ca.height = tempW;\r\n        }\r\n\r\n        ca.left = Math.floor((_this._imgsDivW - ca.width) / 2);\r\n        ca.top = Math.floor((_this._imgsDivH - ca.height) / 2);\r\n\r\n        _this._canvas.style.left = ca.left + 'px';\r\n        _this._canvas.style.top = ca.top + 'px';\r\n        _this._canvas.style.width = ca.width + 'px';\r\n        _this._canvas.style.height = ca.height + 'px';\r\n\r\n        _this.ImageAreaSelector.ShowCropRect();\r\n    }\r\n\r\n    ImageViewer.prototype.__addImgToContainer = function (objImg) {\r\n        var _this = this;\r\n\r\n        _this._imgsDiv.appendChild(objImg);\r\n\r\n        _this.__reInitImageControlPosition();\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.__addImgToThumbnail = function (objThumb) {\r\n        var _this = this;\r\n\r\n        _this._thumbnailsDiv.appendChild(objThumb);\r\n\r\n        _this.__reInitThumbnailControlPosition();\r\n\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.__resetSelection = function () {\r\n        var _this = this,\r\n            i = 0;\r\n\r\n        // 更新 thumbnail 的选择状态\r\n        for (i = 0; i < _this.aryThumbnailControls.length; i++) {\r\n            var thumbControl = _this.aryThumbnailControls[i];\r\n            if (thumbControl.bVisible) {\r\n                if (thumbControl.cIndex != _this.curIndex)\r\n                    thumbControl.SetSelect(false);\r\n                else if (thumbControl.cIndex == _this.curIndex)\r\n                    thumbControl.SetSelect(true);\r\n            }\r\n        }\r\n    };\r\n\r\n    ImageViewer.prototype.__reInitImageControlPosition = function () {\r\n        var _this = this;\r\n\r\n        var _aryImgs = _this.aryImageControls,\r\n            _curIndex = _this.curIndex,\r\n            _pIndex = (_curIndex - 1) < 0 ? (_aryImgs.length - 1) : (_curIndex - 1),\r\n            _nIndex = (_curIndex + 1) > (_aryImgs.length - 1) ? 0 : (_curIndex + 1);\r\n\r\n        for (var i = 0; i < _aryImgs.length; i++) {\r\n            if (i == _curIndex) {\r\n                _aryImgs[_curIndex].SetVisible(true);\r\n                _aryImgs[_curIndex].SetLocation();\r\n            } else if (i == _pIndex) {\r\n                _aryImgs[_pIndex].SetLocation(-_this._imgContainerW);\r\n            } else if (i == _nIndex) {\r\n                _aryImgs[_nIndex].SetLocation(_this._imgContainerW);\r\n            } else {\r\n                _aryImgs[i].SetLocation(_this._imgContainerW);\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.__reInitThumbnailControlPosition = function () {\r\n        var _this = this,\r\n            l, t, i;\r\n\r\n        _this.__initThumbnailControlsSize();\r\n\r\n        l = _this.ThumbnailImageMargin;\r\n        t = _this.ThumbnailImageMargin;\r\n\r\n        for (i = 0; i < _this.aryThumbnailControls.length; i++) {\r\n            var thumbnailControl = _this.aryThumbnailControls[i],\r\n                bindIndex = thumbnailControl.cIndex;\r\n\r\n            // 避免不必要的操作\r\n            if (thumbnailControl._width != _this.ThumbnailControlW || thumbnailControl._height != _this.ThumbnailControlH) {\r\n                thumbnailControl.ChangeControlSize(_this.ThumbnailControlW, _this.ThumbnailControlH);\r\n            }\r\n\r\n            thumbnailControl.SetLocation(l, t);\r\n\r\n            // 重新计算 thumbnailContainer 的宽度\r\n            _this._thumbnailsDiv.style.height = (t + thumbnailControl.GetControlHeight()) + 'px';\r\n            _this._thumbnailContainer.scrollTop = _this._thumbnailContainer.scrollHeight;\r\n\r\n            t = thumbnailControl.Top + _this.ThumbnailControlH + _this.ThumbnailImageMargin;\r\n            l = _this.ThumbnailImageMargin;\r\n\r\n            // 检查 index 是否有效\r\n            if (bindIndex < 0 || bindIndex >= _this.aryThumbnailControls.length) {\r\n                thumbnailControl.ClearControl();\r\n                continue;\r\n            }\r\n        }\r\n    };\r\n\r\n    ImageViewer.prototype.__initThumbnailControlsSize = function () {\r\n        //计算 Thumbnail 控件的 _this.ThumbnailControlW;  _this.ThumbnailControlH; \r\n        var _this = this,\r\n            iTotalWidth, iTotalHeight;\r\n\r\n        iTotalWidth = _this._thumbnailContainerW - _this.ThumbnailImageMargin;\r\n        iTotalHeight = _this._thumbnailContainerH - _this.ThumbnailImageMargin;\r\n\r\n        if (_this.aryThumbnailControls.length > _this.thumbnailImagesPerRow) {\r\n            _this.ThumbnailControlW = iTotalWidth - _this.ThumbnailImageMargin - 15;\r\n            _this.ThumbnailControlH = iTotalHeight / _this.thumbnailImagesPerRow - _this.ThumbnailImageMargin;\r\n        } else {\r\n            _this.ThumbnailControlW = iTotalWidth - _this.ThumbnailImageMargin;\r\n            _this.ThumbnailControlH = iTotalHeight / _this.thumbnailImagesPerRow - _this.ThumbnailImageMargin;\r\n        }\r\n    };\r\n\r\n    ImageViewer.prototype.__setCanvasVisible = function (v) {\r\n        var _this = this;\r\n        if (v) {\r\n            _this._canvas.style.display = '';\r\n        } else {\r\n            _this._canvas.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    ImageViewer.prototype.__pushStack = function (funName) {\r\n        var _this = this;\r\n        var _curStack = {\r\n            fun: funName,\r\n            crop: _this.__getFinalCropArea()[0],\r\n            draw: _this.__getFinalCropArea()[1],\r\n            transform: $(_this._canvas).getTransform(),\r\n            srcBlob: _this.aryImageControls[_this.curIndex].imageUrl\r\n        };\r\n\r\n        _this.stack.push(_curStack);\r\n        _this.curStep++;\r\n        return true;\r\n    }\r\n\r\n    ImageViewer.prototype.__getFinalCropArea = function () {\r\n        var _this = this,\r\n            img = _this.aryImageControls[_this.curIndex].objImage,\r\n            imgOW = img.naturalWidth || img.width,\r\n            imgOH = img.naturalHeight || img.height,\r\n            curStack = _this.stack[_this.curStep],\r\n            curCrop = curStack.crop,\r\n            curTsf = curStack.transform,\r\n            newCrop = _this.ImageAreaSelector.__getCropArea(),\r\n            finalCrop = {\r\n                x: curCrop.x,\r\n                y: curCrop.y,\r\n                width: curCrop.width,\r\n                height: curCrop.height\r\n            };\r\n\r\n        if (0 != curTsf.a * curTsf.d && 0 == curTsf.b * curTsf.c) {\r\n            if (newCrop) {\r\n                if (1 == curTsf.a) {\r\n                    finalCrop.x += newCrop.x * curCrop.width;\r\n                } else {\r\n                    finalCrop.x += (1 - newCrop.x - newCrop.width) * curCrop.width;\r\n                }\r\n                if (1 == curTsf.d) {\r\n                    finalCrop.y += newCrop.y * curCrop.height;\r\n                } else {\r\n                    finalCrop.y += (1 - newCrop.y - newCrop.height) * curCrop.height;\r\n                }\r\n                finalCrop.width *= newCrop.width;\r\n                finalCrop.height *= newCrop.height;\r\n            }\r\n        } else {\r\n            if (newCrop) {\r\n                if (1 == curTsf.b) {\r\n                    finalCrop.x += newCrop.y * curCrop.width;\r\n                } else {\r\n                    finalCrop.x += (1 - newCrop.y - newCrop.height) * curCrop.width;\r\n                }\r\n                if (1 == curTsf.c) {\r\n                    finalCrop.y += newCrop.x * curCrop.height;\r\n                } else {\r\n                    finalCrop.y += (1 - newCrop.x - newCrop.width) * curCrop.height;\r\n                }\r\n                finalCrop.width *= newCrop.height;\r\n                finalCrop.height *= newCrop.width;\r\n            }\r\n        }\r\n        // set proper accuracy\r\n        var img = _this.aryImageControls[_this.curIndex];\r\n        var accuracy = Math.pow(10, Math.ceil(Math.max(img._origImageWidth, img._origImageHeight)).toString().length + 2);\r\n        finalCrop.x = Math.round(finalCrop.x * accuracy) / accuracy;\r\n        finalCrop.y = Math.round(finalCrop.y * accuracy) / accuracy;\r\n        finalCrop.width = Math.round(finalCrop.width * accuracy) / accuracy;\r\n        finalCrop.height = Math.round(finalCrop.height * accuracy) / accuracy;\r\n\r\n        var finalDraw = {\r\n            x: finalCrop.x * imgOW,\r\n            y: finalCrop.y * imgOH,\r\n            width: finalCrop.width * imgOW,\r\n            height: finalCrop.height * imgOH\r\n        }\r\n\r\n        return [finalCrop, finalDraw];\r\n    }\r\n\r\n    ImageViewer.prototype.onNumChange = null;\r\n    ImageViewer.prototype._updateNumUI = function () {\r\n        lib.doCallbackNoBreak(this.onNumChange, [this.curIndex, this.aryImageControls.length]);\r\n    }\r\n\r\n    MBC.ImageViewer = ImageViewer;\r\n\r\n})(Alvin.MBC.Lib, Alvin.MBC);\r\n\r\nfunction createImageViewer(cfg){\r\n    var imageViewer = new Alvin.MBC.ImageViewer(cfg);\r\n    return imageViewer;\r\n}\r\n\r\nexport default createImageViewer;\r\n","/* globals __webpack_amd_options__ */\nmodule.exports = __webpack_amd_options__;\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"main\"}},[_c('a',{attrs:{\"href\":\"javascript:void(0)\"},on:{\"click\":_vm.fuc_LoadImage}},[_vm._v(\"LoadImage\")]),_c('div',{attrs:{\"id\":\"imageViewer\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"main\">\r\n    <a href=\"javascript:void(0)\" @click=\"fuc_LoadImage\">LoadImage</a>\r\n    <div id=\"imageViewer\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport createImageViewer from \"alvin-imageviewer\";\r\nexport default {\r\n  name: \"ImageViewer\",\r\n  data() {\r\n    return {\r\n      imageViewer: \"\",\r\n    };\r\n  },\r\n  mounted() {\r\n    var cfg = {\r\n      ContainerId: \"imageViewer\",\r\n      Width: \"1000px\",\r\n      Height: \"1000px\",\r\n    };\r\n    this.imageViewer = createImageViewer(cfg);\r\n  },\r\n  methods: {\r\n    fuc_LoadImage() {\r\n      if (!this.imageViewer) {\r\n        return false;\r\n      }\r\n\r\n      this.imageViewer.LoadImageEx();\r\n    },\r\n  },\r\n};\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=976cfc82&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}